<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CALCULS DIVERS - Série de normes NF EN 62305 </title>
    <style>
        .body {
            
  
            display:flex;
            margin: 0;
            padding:0;
            font-family: Arial, sans-serif;
            overflow: hidden;



        }

        .main-container {
            
            display: flex;
            flex-direction: row;
            flex: 1;
            overflow: hidden;

        }
        
        .left-container {
            background-color: #e8e8e8;
            padding: 10px;
            border-right: 1px solid #ccc;
            display: flex;
            width: 25%;
            height:98vh;

            flex-direction: column;
            border: 1px solid #ccc;
            box-sizing: border-box;
            font-family: Arial, sans-serif;

        }

        .left-top-container {
            flex: 0 1 auto;
            background-color: #e8e8e8;
            padding: 10px;
            border-bottom: 1px solid #ccc;
            display: flex;
            height: 20%;

        }

        .left-bottom-container {
            flex: 0 1 auto;
            background-color: #e8e8e8;
            padding:10px;
            border: 1px solid #ccc;
            display: flex;
            flex-direction: column;
            margin-top:10px;
   
            box-sizing: border-box;

        }

        .nom_projet_container {
            flex: 0 1 auto;
            background-color: #e8e8e8;
            padding:10px;
            border: 1px solid #ccc;
            display: flex;
            flex-direction: line;
            margin-top:5px;
            justify-content: center; /* Centre horizontalement */
            align-items: center; /* Centre verticalement */
            box-sizing: border-box;

        }

        



 
 
        .center-container {
            flex: 1;
            background-color: #e8e8e8;
            padding: 10px;
            height: 98vh;
            box-sizing: border-box;
            font-family: Arial, sans-serif;
            border: 1px solid #ccc;
            box-sizing: border-box;


        }

        .right-container {

            width: 33%;

            background-color: #e8e8e8;
            padding: 10px;
            border: 1px solid #ccc;
            box-sizing: border-box;
            height:98vh;

        }

        .chart-container {
            flex: 1 1 auto;
            margin-bottom: 20px;
            display: flex;
            height:49%;
            justify-content: center;
            align-items: center;
            border: 1px solid #ccc;
            box-sizing: border-box;

        }

        .chart-container:last-child {
            margin-bottom: 0;
        }

 
 
        

        .button {
            padding: 10px;
            margin-bottom: 10px;
            background-color: #8f9dac;
            color: rgb(0, 0, 0);
            font-weight: bold; /* Mettre le texte en gras */
            border: none;
            border-radius: 25px; /* Make the buttons rounded */
            cursor: pointer;
        }


        .button:hover {
            background-color: #d5d82f;
        }

 
        canvas {
            max-width: 100%; /* Ensure canvas does not exceed container width */
        }

 
    .clicked {
        background-color: #d5d82f; /* Change the border color */
    }



.titre_label {

    margin: 10px;
    font-weight: bold;
    font-size:13px;


}

.line_container {

    display:none;
    max-height: 100%;
    margin: 0 auto; /* Center the container */
    flex-direction: column;
    border: 1px solid #ccc;
    padding: 10px;
    box-sizing: border-box; /* Ensure padding is included in the width */
    margin-top: 10px;
    overflow-y: auto;
    

}




.line_container_input_data {

display:flex;
flex-direction: column;
margin: 10px;
border: 1px solid #ccc;
padding: 10px;
margin-top: 10px;
margin-bottom: 10px;
box-sizing: border-box; /* Ensure padding is included in the width */

}


.longueur_ligne_container {

display:flex;
flex-direction: column;
margin: 10px;
border: 1px solid #ccc;
padding: 10px;
margin-top: 10px;
margin-bottom: 10px;
box-sizing: border-box; /* Ensure padding is included in the width */



}

.longueur_ligne_container_items {

display:flex;
flex-direction: column;
margin: 10px;
border: 1px solid #ccc;
padding: 10px;
margin-top: 10px;
margin-bottom: 10px;
box-sizing: border-box; /* Ensure padding is included in the width */
align-items: center;


}

.select_field {

background-color: cornsilk;
color:blue;
width:250px;
border: 1px solid #ccc; /* Thin border */

}

.select_field_o {

background-color: rgba(226, 237, 227, 0.774);
color:blue;
width:250px;
border: 1px solid #ccc; /* Thin border */

}


.input_select_lines {

background-color: cornsilk;
color:blue;
width:50px;
border: none; /* Remove default border */
border: 1px solid #ccc; /* Thin border */

}

.label_input_field {
font-size:14px

}


    .show {
        display: block;
    }

  
    .custom-button-save {
            background-image: url("photos/save.jpg");
            background-size: cover;
            background-position: center;
            width: 40px;
            height: 40px;
            padding:20px;
            
            border: 1px solid #989898;
            cursor: pointer;
    }

    .custom-button-save-as {
        background-image: url("photos/save_as.jpg");
            background-size: cover;
            background-position: center;
            width: 40px;
            height: 40px;
            padding:20px;
            
            border: 1px solid #989898;
            cursor: pointer;
    }

    .custom-button-open {
            background-image: url("photos/open_file_arf.jpg");
            background-size: cover;
            background-position: center;
            width: 40px;
            height: 40px;
            padding:20px;
            
            border: 1px solid #989898;
            cursor: pointer;
    }

    .custom-button-print {
            background-image: url("photos/print_definitions.jpg");
            background-size: cover;
            background-position: center;
            padding:20px;
            width: 40px;
            height: 40px;
            
            border: 1px solid #989898;
            cursor: pointer;
    }


    .custom-button-newfile {
            background-image: url("photos/nouveau_fichier.jpg");
            background-size: cover;
            background-position: center;
            padding:20px;
            width: 40px;
            height: 40px;
            
            border: 1px solid #989898;
            cursor: pointer;
    }


    @media print {
            @page {
                margin-left: 1cm;
                margin-right: 1cm;
                margin-top: 1cm;
                margin-bottom: 1cm;
            }
            body {
                margin: 0;
            }
            .page-number:after {
                content: counter(page);
            }
            .page-number {
                position: fixed;
                bottom: 0;
                width: 100%;
                text-align: center;
            }
        }

    .spaced-lines {
        line-height: 1.0; /* Adjust this value to increase or decrease spacing */
    }
    .spaced-lines br {
        display: block;
        margin-top: 0px; /* Adjust this value to increase or decrease spacing */
        margin-bottom: 0px; /* Adjust this value to increase or decrease spacing */
    }

    .disabled-label {
        color: rgb(150, 150, 150);

    }

    .exclamation {
            position: relative;
            right: 0px;
            top: 50%;

            color: red; /* Color of the exclamation icon */
        }

    .tooltip {
            position: absolute;
            background-color: #ffffff;
            color: rgb(255, 0, 0);
            padding: 5px;
            border-radius: 5px;
            display: none; /* Initially hidden */
            font-size: 14px; /* Set the size of the tooltip text */
    }

    #tooltipKTA2206 {
    position: absolute;
    top: 880px; /* Ajuste selon la position souhaitée */
    left: 500px; /* Ajuste selon la position souhaitée */
    display: none; /* Cache par défaut */
    background-color: #f0f0f0;
    padding: 10px;
    border: 1px solid #ccc;
    z-index: 1000; /* Pour qu'il soit toujours au-dessus */
}


    .custom-button_item-add {
            background-image: url("photos/add_item.jpg");
            height: 20px; /* Set a fixed height */
            width:20px;
            padding: 5px;
            cursor: pointer;
            margin-left:1px;
            margin-right:1px;
            margin-top:1px;
            margin-bottom: 1px;

            border: none;
            background-size: cover; /* Ensure the image covers the button */


        }

        .custom-button_item-remove {
            background-image: url("photos/remove_divers.jpg");
            height: 20px; /* Set a fixed height */
            width:20px;
            padding: 10px;
            cursor: pointer;
            margin-left:1px;
            margin-right:1px;
            margin-top:1px;
            margin-bottom: 1px;

            border: black;
            background-size: cover; /* Ensure the image covers the button */


        }

        .custom-button_item-rename {
            background-image: url("photos/rename_divers.jpg");
            height: 20px; /* Set a fixed height */
            width:20px;
            padding: 5px;
            cursor: pointer;
            margin-left:1px;
            margin-right:1px;
            margin-top:1px;
            margin-bottom: 1px;

            border: none;
            background-size: cover; /* Ensure the image covers the button */


        }

        .dropdow_menu_line {

            display:flex;
            height: 35px;
            flex-direction: row;
            margin: 0 auto; /* Center the container */
            border: 1px solid #afafaf;
            padding: 5px;
            box-sizing: border-box; /* Ensure padding is included in the width */
            margin-top: 1px;
            margin-bottom: 1px;

        }
        

        .plot-container {
            margin-top: 10px;
            margin-bottom: 10px;
            width: 100%;
            height: 430px; /* Adjust height as needed */
            border-radius: 20px; /* Round the corners */
            border: 1px solid #727272;
            background-color: #ffffff;
            overflow: hidden; /* Important: Ensures content doesn't overflow the rounded corners */

            
        }


        #heidlerPlot, #fftPlot {
            width: 100%;
            height: 100%; /* Adjust height as needed */
            
        }



        #plot-container {

            flex-direction: column;

        }


                /* Loader (sablier) */
        .loader {
            border: 16px solid #f3f3f3;
            border-top: 16px solid #3498db;
            border-radius: 50%;
            width: 60px;
            height: 60px;
            animation: spin 2s linear infinite;
            position: fixed;
            top: 40%;
            left: 50%;
            transform: translate(-50%, -50%);
            display: none; /* Masquer par défaut */
            text-align: center;
            line-height: 120px; /* Aligne le texte verticalement */
            font-size: 20px;
            color: #3498db;
            font-weight: bold;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }


   

    </style>

<script src="https://cdn.plot.ly/plotly-latest.min.js"></script>

</head>
<body>

    <div id="loader" class="loader">
        <span id="loader-text"></span>
    </div>


<div class="main-container">
 
    <div class="left-container">

        <div class="nom_projet_container">

            <button class="custom-button custom-button-newfile" title="Nouveau Fichier" onclick="new_file()"></button>
            <button class="custom-button custom-button-save" title="Enregistrer" onclick="save()"></button>
            <button class="custom-button custom-button-save-as" title="Enregistrer sous" onclick="save_as()"></button>
            <button class="custom-button custom-button-open" title="Ouvrir" id="ouvrir"></button>
            <button class="custom-button custom-button-print" title="Afficher/Imprimer les résultats" id="print"></button>

        </div>
     
            
        <div class="left-bottom-container">
            <button class="button" id="elevation_temperature">Elévation de température</button>
            <button class="button" id="section_conducteurs">Section des conducteurs du SPF</button>
            <button class="button" id="profondeur_fusion">Profondeur de fusion</button>
            <button class="button" id="section_electrodes_terre">Section des électrodes de terre (NF C 13-200)</button>
            <button class="button" id="section_liaisons_terre">Section des liaisons de mise à la terre</button>
            <button class="button" id="section_cables_parafoudres">Section des câbles de raccordement du parafoudre</button>
            <button class="button" id="calibre_deconnecteurs">Calibre du déconnecteur du parafoudre</button>
            <button class="button" id="angle_protection">Rayon de protection/Angle de protection</button>
            <button class="button" id="rayon_protection_sf">Rayon de protection/Sphère fictive</button>
            <button class="button" id="rayon_protection_PDA">Rayon de protection/PDA</button>
            <button class="button" id="profondeur_sf">Profondeur de pénétration/Sphère fictive</button>
            <button class="button" id="calcul_champ_magnetique_direct_zpf1">Champ magnétique/Impact sur la structure</button>
            <button class="button" id="calcul_champ_magnetique_indirect_zpf1">Champ magnétique/Impact près de la structure</button>
            <button class="button" id="calcul_section_blindage">Dimensionnement/Ecran de câble</button>
            <button class="button" id="calcul_surtensions_KTA2206">Surtensions induites selon la norme KTA2206</button>
            <button class="button" id="forces electrodynamiques">Forces électrodynamiques entre conducteurs du SPF</button>
            <button class="button" id="courant_iimp_par_module">Répartition du courant impulsionnel de foudre</button>
            <button class="button" id="spectre_frequentiel">Spectre fréquentiel du choc de foudre</button>
        </div>

     
    </div>
        
    <div class="center-container" id="center-container-id">
        
    
    
        <div class="line_container" id="elevation-temperature">


            <div class="longueur_ligne_container">

                <div>
                    <label id="materiau" class="label_input_field">Matériau</label>
                </div>

                <div>
                
                    <select class="select_field" id="materiau-conducteur" onclick="">

                        <option value="1">Cuivre</option>
                        <option value="2">Aluminium</option>
                        <option value="3">Acier doux</option>
                        <option value="4">Acier Inoxydable</option>
                
                    </select>

                </div>

            </div>

            <div class="longueur_ligne_container">
    
                <div>
                    <label id="niveau-protection-elevation-label" class="label_input_field">Niveau de protection</label>
                </div>
    
                <div>
                
                    <select class="select_field" id="niveau-protection-elevation" onclick="">
    
                            <option value="1">Niveau I</option>
                            <option value="2">Niveau II</option>
                            <option value="3">Niveau III</option>
                            <option value="4">Niveau IV</option>
                            <option value="AUTRE">AUTRE</option>
    
                    
                        </select>
    
                           
                
                    </select>
    
                </div>
    
    
            </div>

            <div class="longueur_ligne_container">

                <div>
                    <label for="courant-impulsionnel-elevation" class="label_input_field">Courant impulsionnel de foudre Iimp (10/350 &micro;s) (kA)</label>
                </div>

                <div>

                    <input type="number" readonly class="select_field_o" id="courant-impulsionnel-elevation" style="color: blue;" value="200.00">
        
                </div>

            </div>

            <div class="longueur_ligne_container">

                <div>
                    <label for="coef-repartition" class="label_input_field">Coefficient de répartition du courant de foudre Kc</label>
                </div>

                <div>

                    <input type="number" class="select_field" id="coef-repartition" style="color: blue;" value="1.00">
        
                </div>

            </div>


            
            <div class="longueur_ligne_container">

                <div>
                    <label for="resistance-ohmique" class="label_input_field">Résistance ohmique spécifique du conducteur à la température ambiante &rho; (&ohm;.m)</label>
                </div>

                <div>

                    <input type="number" readonly class="select_field_o" id="resistance-ohmique" style="color: blue;" value="1.78E-8">
        
                </div>

            </div>

            <div class="longueur_ligne_container">

                <div>
                    <label for="coefficient-temperature" class="label_input_field">Coefficient de température de la résistance &alpha; (1/K)</label>
                </div>

                <div>

                    <input type="number" readonly class="select_field_o" id="coefficient-temperature" style="color: blue;" value="3.92E-3">
        
                </div>

            </div>

            <div class="longueur_ligne_container">

                <div>
                    <label for="densite-materiau" class="label_input_field">Densité du matériau &gamma; (kg/m<sup>3</sup>)</label>
                </div>

                <div>

                    <input type="number" readonly class="select_field_o" id="densite-materiau" style="color: blue;" value="8920">
        
                </div>

            </div>

            <div class="longueur_ligne_container">

                <div>
                    <label for="capacite-thermique" class="label_input_field">Capacité thermique Cw (J/kg.K)</label>
                </div>

                <div>

                    <input type="number" readonly class="select_field_o" id="capacite-thermique" style="color: blue;" value="385">
        
                </div>

            </div>

            <div class="longueur_ligne_container">

                <div>
                    <label for="temperature-fusion" class="label_input_field">Température de fusion &theta;s (°C)</label>
                </div>

                <div>

                    <input type="number" readonly class="select_field_o" id="temperature-fusion" style="color: blue;" value="1080">
        
                </div>

            </div>

        
            <div class="longueur_ligne_container">

                <div>
                    <label for="section-conducteur" class="label_input_field">Section du conducteur s (mm<sup>2</sup>)</label>
                </div>

                <div>

                    <input type="number" class="select_field_o" id="section-conducteur" style="color: blue;" value="50">
        
                </div>

            </div>

            <div class="longueur_ligne_container">

                <div>
                    <label for="delta-theta" class="label_input_field">
                        <strong>Elévation de température &Delta;&theta; (°C)</strong>
                    </label>
                </div>

                <div>

                    <input type="number" readonly class="select_field_o" id="delta-theta" style="color: blue; font-weight: bold;" value="21.6">
                    <span class="exclamation" id="exclamationIcon1" style="display: none;">!</span>
                    <div class="tooltip" id="tooltip1"></div>
        
                </div>


            </div>

 
    </div>



    

    <div class="line_container" id="profondeur-fusion">


        <div class="longueur_ligne_container">

            <div>
                <label id="materiau" class="label_input_field">Matériau</label>
            </div>

            <div>
            
                <select class="select_field" id="materiau-conducteur-profondeur" onclick="">

                    <option value="1">Cuivre</option>
                    <option value="2">Aluminium</option>
                    <option value="3">Acier doux</option>
                    <option value="4">Acier Inoxydable</option>
            
                </select>

            </div>

        </div>


        <div class="longueur_ligne_container">
    
            <div>
                <label id="niveau-protection-profondeur-label" class="label_input_field">Niveau de protection</label>
            </div>

            <div>
            
                <select class="select_field" id="niveau-protection-profondeur" onclick="">

                        <option value="1">Niveau I</option>
                        <option value="2">Niveau II</option>
                        <option value="3">Niveau III</option>
                        <option value="4">Niveau IV</option>
                        <option value="AUTRE">AUTRE</option>

                
                    </select>

                       
            
                </select>

            </div>


        </div>

        <div class="longueur_ligne_container">

            <div>
                <label for="courant-impulsionnel-profondeur" class="label_input_field">Courant impulsionnel de foudre Iimp (10/350 &micro;s) (kA)</label>
            </div>

            <div>

                <input type="number" readonly class="select_field_o" id="courant-impulsionnel-profondeur" style="color: blue;" value="200.00">
    
            </div>

        </div>

        <div class="longueur_ligne_container">

            <div>
                <label for="chute-tension-profondeur" class="label_input_field">Chute de tension anode-cathode ua,c (V)</label>
            </div>

            <div>

                <input type="number" readonly class="select_field_o" id="chute-tension-profondeur" style="color: blue;" value="10.00">
    
            </div>

        </div>

 
        <div class="longueur_ligne_container">

            <div>
                <label for="densite-materiau-profondeur" class="label_input_field">Densité du matériau &gamma; (kg/m<sup>3</sup>)</label>
            </div>

            <div>

                <input type="number" readonly class="select_field_o" id="densite-materiau-profondeur" style="color: blue;" value="8920">
    
            </div>

        </div>

        <div class="longueur_ligne_container">

            <div>
                <label for="chaleur-specifique-profondeur" class="label_input_field_o">Chaleur spécifique de fusion Cs (J/kg)</label>
            </div>

            <div>

                <input type="number" readonly class="select_field_o" id="chaleur-specifique-profondeur" style="color: blue;" value="397E3">
    
            </div>

        </div>

        <div class="longueur_ligne_container">

            <div>
                <label for="capacite-thermique-profondeur" class="label_input_field">Capacité thermique Cw (J/kg.K)</label>
            </div>

            <div>

                <input type="number" readonly class="select_field_o" id="capacite-thermique-profondeur" style="color: blue;" value="385">
    
            </div>

        </div>

        <div class="longueur_ligne_container">

            <div>
                <label for="temperature-fusion-profondeur" class="label_input_field">Température de fusion &theta;s (°C)</label>
            </div>

            <div>

                <input type="number" readonly class="select_field_o" id="temperature-fusion-profondeur" style="color: blue;" value="1080">
    
            </div>

        </div>

        <div class="longueur_ligne_container">

            <div>
                <label for="temperature-ambiante-profondeur" class="label_input_field">Température ambiante &theta;u (°C)</label>
            </div>

            <div>

                <input type="number" class="select_field" id="temperature-ambiante-profondeur" style="color: blue;" value="25">
    
            </div>

        </div>

    
        <div class="longueur_ligne_container">

            <div>
                <label for="epaisseur-conducteur-profondeur" class="label_input_field">Epaisseur du conducteur e (mm)</label>
            </div>

            <div>

                <input type="number" class="select_field" id="epaisseur-conducteur-profondeur" style="color: blue;" value="5.0">
    
            </div>

        </div>

        <div class="longueur_ligne_container">

            <div>
                <label for="profondeur-fusion-conducteur" class="label_input_field">
                    <strong>Profondeur de fusion pf (mm)</strong>
                </label>
            </div>

            <div>

                <input type="number" readonly class="select_field_o" id="profondeur-fusion-conducteur" style="color: blue; font-weight: bold;" value="4.4">
                <span class="exclamation" id="exclamationIcon2" style="display: none;">!</span>
                <div class="tooltip" id="tooltip2"></div>
    
            </div>


        </div>


    </div>



    <div class="line_container" id="section-conducteurs-spf">


        <div class="longueur_ligne_container">

            <div>
                <label id="materiau" class="label_input_field">Matériau</label>
            </div>

            <div>
            
                <select class="select_field" id="materiau-conducteur-spf" onclick="">

                    <option value="1">Cuivre</option>
                    <option value="2">Aluminium</option>
                    <option value="3">Acier doux</option>
                    <option value="4">Acier Inoxydable</option>
            
                </select>

            </div>

        </div>

        <div class="longueur_ligne_container">
    
            <div>
                <label id="niveau-protection-spf-label" class="label_input_field">Niveau de protection</label>
            </div>

            <div>
            
                <select class="select_field" id="niveau-protection-spf" onclick="">

                        <option value="1">Niveau I</option>
                        <option value="2">Niveau II</option>
                        <option value="3">Niveau III</option>
                        <option value="4">Niveau IV</option>
                        <option value="AUTRE">AUTRE</option>

                
                    </select>

                       
            
                </select>

            </div>


        </div>




        <div class="longueur_ligne_container">

            <div>
                <label for="courant-impulsionnel-spf" class="label_input_field">Courant impulsionnel de foudre Iimp (10/350 &micro;s) (kA)</label>
            </div>

            <div>

                <input type="number" readonly class="select_field_o" id="courant-impulsionnel-spf" style="color: blue;" value="200.00">
    
            </div>

        </div>

        <div class="longueur_ligne_container">

            <div>
                <label for="coef-repartition-spf" class="label_input_field">Coefficient de répartition du courant de foudre Kc</label>
            </div>

            <div>

                <input type="number" class="select_field_o" id="coef-repartition-spf" style="color: blue;" value="1.00">
    
            </div>

        </div>


        
        <div class="longueur_ligne_container">

            <div>
                <label for="resistance-ohmique-spf" class="label_input_field_o">Résistance ohmique spécifique du conducteur à la température ambiante &rho; (&ohm;.m)</label>
            </div>

            <div>

                <input type="number" readonly class="select_field_o" id="resistance-ohmique-spf" style="color: blue;" value="1.78E-8">
    
            </div>

        </div>

        <div class="longueur_ligne_container">

            <div>
                <label for="coefficient-temperature-spf" class="label_input_field">Coefficient de température de la résistance &alpha; (1/K)</label>
            </div>

            <div>

                <input type="number" readonly class="select_field_o" id="coefficient-temperature-spf" style="color: blue;" value="3.92E-3">
    
            </div>

        </div>

        <div class="longueur_ligne_container">

            <div>
                <label for="densite-materiau-spf" class="label_input_field">Densité du matériau &gamma; (kg/m<sup>3</sup>)</label>
            </div>

            <div>

                <input type="number" readonly class="select_field_o" id="densite-materiau-spf" style="color: blue;" value="8920">
    
            </div>

        </div>

        <div class="longueur_ligne_container">

            <div>
                <label for="capacite-thermique-spf" class="label_input_field">Capacité thermique Cw (J/kg.K)</label>
            </div>

            <div>

                <input type="number" readonly class="select_field_o" id="capacite-thermique-spf" style="color: blue;" value="385">
    
            </div>

        </div>

        <div class="longueur_ligne_container">

            <div>
                <label for="temperature-fusion-spf" class="label_input_field_o">Température de fusion &theta;s (°C)</label>
            </div>

            <div>

                <input type="number" readonly class="select_field_o" id="temperature-fusion-spf" style="color: blue;" value="1080">
    
            </div>

        </div>

        <div class="longueur_ligne_container">

            <div>
                <label for="temperature-ambiante-spf" class="label_input_field">Température ambiante &theta;0 (°C)</label>
            </div>

            <div>

                <input type="number" class="select_field" id="temperature-ambiante-spf" style="color: blue;" value="25">
    
            </div>

        </div>

         <div class="longueur_ligne_container">

            <div>
                <label for="section-minimale" class="label_input_field">
                    <strong>Section minimale requise s (mm<sup>2</sup>)</strong>
                </label>
            </div>

            <div>

                <input type="number" readonly class="select_field_o" id="section-minimale" style="color: blue; font-weight: bold;" value="50.0">

    
            </div>

            
        </div>


    </div>








    <div class="line_container" id="section-electrodes-terre">


            <div class="longueur_ligne_container">
    
                <div>
                    <label id="materiau" class="label_input_field">Matériau</label>
                </div>
    
                <div>
                
                    <select class="select_field" id="materiau-conducteur-terre" onclick="">
    
                        <option value="1">Cuivre</option>
                        <option value="2">Aluminium</option>
                        <option value="3">Acier</option>

                
                    </select>
    
                </div>
    
            </div>
    
 
            <div class="longueur_ligne_container">
    
                <div>
                    <label for="courant-court-circuit" class="label_input_field">Courant de court-circuit présumé Ik (kA eff)</label>
                </div>
    
                <div>
    
                    <input type="number" class="select_field" id="courant-court-circuit" style="color: blue;" value="12.50">
        
                </div>
    
            </div>

            <div class="longueur_ligne_container">
    
                <div>
                    <label for="duree-court-circuit" class="label_input_field">Durée du courant de court-circuit présumé t (s)</label>
                </div>
    
                <div>
    
                    <input type="number" class="select_field" id="duree-court-circuit" style="color: blue;" value="1.00">
        
                </div>
    
            </div>

   
    
            
            <div class="longueur_ligne_container">
    
                <div>
                    <label for="Qc" class="label_input_field">Capacité volumétrique de chaleur du conducteur 20°C Qc (J/°C.mm<sup>3</sup>)</label>
                </div>
    
                <div>
    
                    <input type="number" readonly class="select_field_o" id="Qc" style="color: blue;" value="3.45E-3">
        
                </div>
    
            </div>


           <div class="longueur_ligne_container">
    
                <div>
                    <label for="Beta" class="label_input_field">Inverse du coefficient de température de la résistivité à 0°C du conducteur &beta; (°C)</label>
                </div>
    
                <div>
    
                    <input type="number" readonly class="select_field_o" id="Beta" style="color: blue;" value="234.5">
        
                </div>
    
            </div>

            <div class="longueur_ligne_container">
    
                <div>
                    <label for="rho20" class="label_input_field"> Résistivité du conducteur à 20 °C &rho;20 (&ohm;.m)</label>
                </div>
    
                <div>
    
                    <input type="number" readonly class="select_field_o" id="rho20" style="color: blue;" value="17.241E-6">
        
                </div>
    
            </div>

    
            <div class="longueur_ligne_container">
    
                <div>
                    <label for="temperature-initiale" class="label_input_field">Température initiale &theta;i (°C)</label>
                </div>
    
                <div>
    
                    <input type="number" class="select_field" id="temperature-initiale" style="color: blue;" value="30">
        
                </div>
    
            </div>
    
            <div class="longueur_ligne_container">
    
                <div>
                    <label for="temperature-finale" class="label_input_field">Température finale &theta;f (°C)</label>
                </div>
    
                <div>
    
                    <input type="number" class="select_field" id="temperature-finale" style="color: blue;" value="1080">
        
                </div>
    
            </div>
    
             <div class="longueur_ligne_container">
    
                <div>
                    <label for="section-minimale-terre" class="label_input_field">
                        <strong>Section minimale requise s (mm<sup>2</sup>)</strong>
                    </label>
                </div>
    
                <div>
    
                    <input type="number" readonly class="select_field_o" id="section-minimale-terre" style="color: blue; font-weight: bold;" value="50.0">
    
        
                </div>
    
                
            </div>
    
    





        </div>


        <div class="line_container" id="section-conducteurs-liaisons">


            <div class="longueur_ligne_container">
    
                <div>
                    <label id="materiau" class="label_input_field">Matériau</label>
                </div>
    
                <div>
                
                    <select class="select_field" id="materiau-conducteur-liaisons" onclick="">
    
                        <option value="1">Cuivre</option>
                        <option value="2">Aluminium</option>
                        <option value="3">Acier doux</option>
                        <option value="4">Acier Inoxydable</option>
                
                    </select>
    
                </div>
    
            </div>

            <div class="longueur_ligne_container">
    
                <div>
                    <label id="niveau-protection-liaisons-label" class="label_input_field">Niveau de protection</label>
                </div>
    
                <div>
                
                    <select class="select_field" id="niveau-protection-liaisons" onclick="">
    
                            <option value="1">Niveau I</option>
                            <option value="2">Niveau II</option>
                            <option value="3">Niveau III</option>
                            <option value="4">Niveau IV</option>
                            <option value="AUTRE">AUTRE</option>
    
                    
                        </select>
    
                           
                
                    </select>
    
                </div>
    
    
            </div>
    
    
    
            <div class="longueur_ligne_container">
    
                <div>
                    <label for="courant-impulsionnel-liaisons" class="label_input_field">Courant impulsionnel de foudre Iimp (10/350 &micro;s) (kA)</label>
                </div>
    
                <div>
    
                    <input type="number" reaonly class="select_field_o" id="courant-impulsionnel-liaisons" style="color: blue;" value="200.00">
        
                </div>
    
            </div>
    
            <div class="longueur_ligne_container">
    
                <div>
                    <label for="coef-repartition-liaisons" class="label_input_field">Coefficient de répartition du courant de foudre Kc</label>
                </div>
    
                <div>
    
                    <input type="number" class="select_field" id="coef-repartition-liaisons" style="color: blue;" value="1.00">
        
                </div>
    
            </div>
    
    
            
            <div class="longueur_ligne_container">
    
                <div>
                    <label for="resistance-ohmique-liaisons" class="label_input_field">Résistance ohmique spécifique du conducteur à la température ambiante &rho; (&ohm;.m)</label>
                </div>
    
                <div>
    
                    <input type="number" readonly class="select_field_o" id="resistance-ohmique-liaisons" style="color: blue;" value="1.78E-8">
        
                </div>
    
            </div>
    
            <div class="longueur_ligne_container">
    
                <div>
                    <label for="coefficient-temperature-liaisons" class="label_input_field">Coefficient de température de la résistance &alpha; (1/K)</label>
                </div>
    
                <div>
    
                    <input type="number" readonly class="select_field_o" id="coefficient-temperature-liaisons" style="color: blue;" value="3.92E-3">
        
                </div>
    
            </div>
    
            <div class="longueur_ligne_container">
    
                <div>
                    <label for="densite-materiau-liaisons" class="label_input_field">Densité du matériau &gamma; (kg/m<sup>3</sup>)</label>
                </div>
    
                <div>
    
                    <input type="number" readonly class="select_field_o" id="densite-materiau-liaisons" style="color: blue;" value="8920">
        
                </div>
    
            </div>
    
            <div class="longueur_ligne_container">
    
                <div>
                    <label for="capacite-thermique-liaisons" class="label_input_field">Capacité thermique Cw (J/kg.K)</label>
                </div>
    
                <div>
    
                    <input type="number" readonly class="select_field_o" id="capacite-thermique-liaisons" style="color: blue;" value="385">
        
                </div>
    
            </div>
    
            <div class="longueur_ligne_container">
    
                <div>
                    <label for="temperature-fusion-liaisons" class="label_input_field">Température de fusion &theta;s (°C)</label>
                </div>
    
                <div>
    
                    <input type="number" readonly class="select_field_o" id="temperature-fusion-liaisons" style="color: blue;" value="1080">
        
                </div>
    
            </div>
    
            <div class="longueur_ligne_container">
    
                <div>
                    <label for="temperature-ambiante-liaisons" class="label_input_field">Température ambiante &theta;0 (°C)</label>
                </div>
    
                <div>
    
                    <input type="number" class="select_field" id="temperature-ambiante-liaisons" style="color: blue;" value="25">
        
                </div>
    
            </div>
    
             <div class="longueur_ligne_container">
    
                <div>
                    <label for="section-minimale-liaisons" class="label_input_field">
                        <strong>Section minimale requise "s" (mm<sup>2</sup>)</strong>
                    </label>
                </div>
    
                <div>
    
                    <input type="number" readonly class="select_field_o" id="section-minimale-liaisons" style="color: blue; font-weight: bold;" value="11.16">
    
        
                </div>
    
                
            </div>
    
    
        </div>


        <div class="line_container" id="section-conducteurs-raccordement">


            <div class="longueur_ligne_container">
    
                <div>
                    <label id="calibre" class="label_input_field">Calibre de la protection amont</label>
                </div>
    
                <div>
                
                    <select class="select_field" id="calibre-protection" onclick="">
    
                        <option value="1">2 A</option>
                        <option value="2">4 A</option>
                        <option value="3">6 A</option>
                        <option value="4">10 A</option>
                        <option value="5">16 A</option>
                        <option value="6">20 A</option>
                        <option value="7">25 A </option>
                        <option value="8">32 A</option>
                        <option value="9">40 A</option>
                        <option value="10">50 A</option>
                        <option value="11">63 A</option>
                        <option value="12">80 A</option>
                        <option value="13">100 A</option>
                        <option value="14">125 A</option>
                        <option value="15">160 A</option>
                        <option value="16">200 A</option>
                        <option value="17">250 A</option>
                        <option value="18">315 A</option>
                        <option value="19">400 A</option>
                        <option value="20">500 A</option>
                        <option value="21">630 A</option>
                        <option value="22">800 A</option>
                        <option value="23">1000 A</option>
                        <option value="24">1250 A</option>
                        
                
                    </select>
    
                </div>
    
            </div>

            <div class="longueur_ligne_container">
    
                <div>
                    <label id="classe" class="label_input_field">Classe du parafoudre</label>
                </div>
    
                <div>
                
                    <select class="select_field" id="classe-parafoudre" onclick="">
    
                        <option value="1">Type 1</option>
                        <option value="2">Type 2</option>
                        <option value="3">Type 3</option>
                
                    </select>
    
                </div>
    
            </div>
    
     
             <div class="longueur_ligne_container">
    
                <div>
                    <label for="section-minimale-raccordement-s1" class="label_input_field">
                        <strong>Section minimale requise des conducteurs de phase/neutre s1 (mm<sup>2</sup>)</strong>
                    </label>
                </div>
    
                <div>
    
                    <input type="number" readonly class="select_field_o" id="section-minimale-raccordement-s1" style="color: blue; font-weight: bold;" value="10">
    
        
                </div>
    
                
            </div>

            <div class="longueur_ligne_container">
    
                <div>
                    <label for="section-minimale-raccordement-s2" class="label_input_field">
                        <strong>Section minimale requise du conducteur de terre s2 (mm<sup>2</sup>)</strong>
                    </label>
                </div>
    
                <div>
    
                    <input type="number" readonly class="select_field_o" id="section-minimale-raccordement-s2" style="color: blue; font-weight: bold;" value="16">
    
        
                </div>
    
                
            </div>
    
    
        </div>


        
        <div class="line_container" id="calcul-section-blindage-container">


            <div class="longueur_ligne_container">

                <div>
                    <label id="materiau-blindage-label" class="label_input_field">Type de matériau de l'écran</label>
                </div>

                <div>
                
                    <select class="select_field" id="materiau-conducteur-blindage" onclick="">

                        <option value="1">Cuivre</option>
                        <option value="2">Aluminium</option>
                        <option value="3">Acier</option>
                
                    </select>

                </div>

            </div>

            

            <div class="longueur_ligne_container">

                <div>
                    <label for="courant-impulsionnel-blindage" class="label_input_field">Courant impulsionnel de foudre Iimp (10/350 &micro;s) s'écoulant dans l'écran (kA)</label>
                </div>

                <div>

                    <input type="number" class="select_field" id="courant-impulsionnel-blindage" style="color: blue;" value="50.00">
        
                </div>

            </div>

            
            <div class="longueur_ligne_container">

                <div>
                    <label for="resistivite-blindage" class="label_input_field">Résistivité de l'écran &rho; (&ohm;.m)</label>
                </div>

                <div>

                    <input type="number" readonly class="select_field_o" id="resistivite-blindage" style="color: blue;" value="1.68E-8">
        
                </div>

            </div>


            <div class="longueur_ligne_container">

                <div>
                    <label for="tenue-chocs-equipements-blindage" class="label_input_field">Tenue aux chocs de foudre du réseau de puissance/communication alimenté par le câble (kV)</label>
                </div>

                <div>

                    <input type="number"class="select_field" id="tenue-chocs-equipements-blindage" style="color: blue;" value="1.50">
        
                </div>

            </div>


            <div class="longueur_ligne_container">

                <div>
                    <label for="diametre-moyen-ecran" class="label_input_field">Diamètre moyen de l'écran &Oslash; (mm)</label>
                </div>

                <div>

                    <input type="number" class="select_field" id="diametre-moyen-ecran" style="color: blue;" value="20.00">
        
                </div>

            </div>

            <div class="longueur_ligne_container">

                <div>
                    <label for="resistivite-sol-blindage" class="label_input_field">Résistivité moyenne du sol (&ohm;.m)</label>
                </div>

                <div>

                    <input type="number" class="select_field" id="resistivite-sol-blindage" style="color: blue;" value="500.00">
        
                </div>

            </div>


            <div class="longueur_ligne_container">

                <div>
                    <label id="etat-ecran-blindage-label" class="label_input_field">Etat de l'écran du câble</label>
                </div>

                <div>
                
                    <select class="select_field" id="etat-ecran-blindage" onclick="">

                        <option value="1">En contact avec le sol</option>
                        <option value="2">Isolé du sol</option>

                
                    </select>

                </div>

            </div>

            <div class="longueur_ligne_container">

                <div>
                    <label for="longueur-cable-blindage" class="label_input_field">Longueur du câble entre le point de mise à la terre le plus proche et la structure (m)</label>
                </div>

                <div>

                    <input type="number" class="select_field" id="longueur-cable-blindage" style="color: blue;" value="100.00">
        
                </div>

            </div>

            <div class="longueur_ligne_container">

                <div>
                    <label for="temperature-ambiante-blindage" class="label_input_field">Temperature ambiante (°)</label>
                </div>

                <div>

                    <input type="number" class="select_field" id="temperature-ambiante-blindage" style="color: blue;" value="25">
        
                </div>

            </div>

            <div class="longueur_ligne_container">

                <div>
                    <label for="temperature-maximale-isolant-cable-blindage" class="label_input_field">Temperature maximale admissible de l'isolant du câble (°)</label>
                </div>

                <div>

                    <input type="number" class="select_field" id="temperature-maximale-isolant-cable-blindage" style="color: blue;" value="250.00">
        
                </div>

            </div>

            
            <div class="longueur_ligne_container">

                <div>
                    <label for="section-conducteur-ecran-blindage" class="label_input_field">
                    <strong>Section minimale requise de l'écran s (mm<sup>2</sup>)</strong>
                </div>

                <div>

                    <input type="number" readonly class="select_field_o" id="section-ecran-blindage" style="color: blue;font-weight: bold;" value="">
        
                </div>

            </div>

            <div class="longueur_ligne_container">

                <div>
                    <label for="epaisseur-ecran-blindage" class="label_input_field">
                        <strong>Epaisseur minimale requise de l'écran (mm)</strong>
                    </label>
                </div>

                <div>

                    <input type="number" readonly class="select_field_o" id="epaisseur-ecran-blindage" style="color: blue; font-weight: bold;" value="">

        
                </div>


            </div>

 
        </div>




        <div class="line_container" id="calcul-surtensions-KTA2206-container">

            <div class="longueur_ligne_container">
    
                <div>
                    <label id="niveau-protection-label-kta2206" class="label_input_field">Niveau de protection</label>
                </div>
    
                <div>
                
                    <select class="select_field" id="niveau-protection-kta2206" onclick="">

                            <option value="1">Niveau I</option>
                            <option value="2">Niveau II</option>
                            <option value="3">Niveau III</option>
                            <option value="4">Niveau IV</option>
                            <option value="AUTRE">AUTRE</option>
                           
                
                    </select>
    
                </div>

    
            </div>


            <div class="longueur_ligne_container">
    
                <div>
                    <label id="type-choc-foudre-label-kta2206" class="label_input_field">Type de choc de foudre</label>
                </div>
    
                <div>
                
                    <select class="select_field" id="type-choc-foudre-kta2206" onclick="">

                            <option value="1">Premier choc positif</option>
                            <option value="2">Premier choc négatif</option>
                            <option value="3">Choc négatif subséquent</option>
                           
                
                    </select>
    
                </div>

    
            </div>



            <div class="longueur_ligne_container">
    
                <div>
                    <label for="courant-max-kta2206" class="label_input_field">Courant maximal impulsionnel de foudre (kA)</label>
                </div>
    
                <div>
    
                    <input type="number" readonly class="select_field_o" id="courant-max-kta2206" style="color: blue;" value="200.00">
        
                </div>
    
            </div>


            <div class="longueur_ligne_container">
    
                <div>
                    <label for="resistivite-sol-kta2206" class="label_input_field">Résistivité moyenne du sol (&ohm;.m)</label>
                </div>
    
                <div>
    
                    <input type="number" class="select_field" id="resistivite-sol-kta2206" style="color: blue;" value="500.00">
        
                </div>
    
            </div>


            <div class="longueur_ligne_container">
    
                <div>
                    <label for="courant-prise-terre-kta2206" class="label_input_field">Part du courant écoulée à travers la prise de terre du bâtiment (kA)</label>
                </div>
    
                <div>
    
                    <input type="number" readonly class="select_field_o" id="courant-prise-terre-kta2206" style="color: blue;" value="66.67">
        
                </div>
    
            </div>

            <div class="longueur_ligne_container">
    
                <div>
                    <label for="facteur-foudre-k-kta2206" class="label_input_field">Facteur de foudre K (&Omega;/m)<sup>-1/2</label>
                </div>
    
                <div>
    
                    <input type="number" readonly class="select_field_o" id="facteur-foudre-k-kta2206" style="color: blue;" value="3">
        
                </div>
    
            </div>

            <div class="longueur_ligne_container">

                <div>
                    <label for="impedance-couplage-kta2206" class="label_input_field">Impédance de couplage dans les galeries Z'M (V/kA.m)</label>
                </div>
    
                <div>
    
                    <input type="number" readonly class="select_field_o" id="impedance-couplage-kta2206" style="color: blue;" value="0.08">
        
                </div>                    
    

            </div>

             
            <div class="longueur_ligne_container">

                <div>
                    <label id="cheminement-hors-galeries-label-kta2206" class="label_input_field" style="color: rgb(134, 134, 134);">HORS GALERIES</label>
                </div>

    
                <div class="dropdow_menu_line" id="dropdow-menu-conducteur-kta2206">

                    <button class="custom-button_item-add" id="add-conducteur-kta2206-btn" title="Ajouter un élément conducteur" ></button>

                    <label for="dropdown-menu-conducteur-kta2206"></label>
                    <select class="select_field" id="dropdown-menu-conducteur-kta2206">

                        <option>Elément Conducteur N°1</option>

                    <!-- Initial options will be added dynamically -->
                    </select>

                    <button class="custom-button_item-remove" id="delete-conducteur-kta2206-btn" title="Supprimer l'élément conducteur sélectionné" onclick="removeConducteurkta2206()" ></button>
                    <button class="custom-button_item-rename" id="rename-conducteur-kta2206-btn" title="Renommer l'élément conducteur sélectionné" onclick="renameConducteurkta2206()" ></button>

                </div>


                <div class="longueur_ligne_container">
    
                    <div>
                        <label id="type-cable-label-kta2206" class="label_input_field">Type d'élément conducteur</label>
                    </div>
        
                    <div>
                    
                        <select class="select_field" id="type-cable-kta2206" onclick="">
    
                                <option value="1">Câble de contrôle commande</option>
                                <option value="2">Conduit de câbles enterré contenant 2 à 10 câbles de contrôle commande </option>
                                <option value="3">Conduit de câbles enterré contenant plus de 10 câbles de contrôle commande</option>
                                <option value="4">Conducteur en contact avec le sol ou isolé (Diamètre inférieur à 0,1 m)</option>
                                <option value="5">Tuyau métallique en contact avec le sol ou isolé (Diamètre entre 0,1 m et 1 m)</option>
                                <option value="6">Tuyau métallique en contact avec le sol ou isolé (Diamètre supérieur à 1 m)</option>                              
                    
                        </select>
        
                    </div>
    
        
                </div>

      

                <div class="longueur_ligne_container">

                    <div>
                        <label for="coefficient-ponderation-conducteur-kta2206" class="label_input_field">Coefficient de pondération pour le courant de foudre</label>
                    </div>
        
                    <div>
        
                        <input type="number" readonly class="select_field_o" id="coefficient-ponderation-conducteur-kta2206" style="color: blue;" value="1">
            
                    </div>                    
        

                </div>

    
                
            </div>




            <div class="longueur_ligne_container">

                <div>
                    <label id="cheminement-galeries-label-kta2206" class="label_input_field" style="color: rgb(134, 134, 134);">GALERIES</label>
                </div>

    
                <div class="dropdow_menu_line" id="dropdow-menu-buse-kta2206">

                    <button class="custom-button_item-add" id="add-buse-kta2206-btn" title="Ajouter une buse" ></button>

                    <label for="dropdown-menu-buse-kta2206"></label>
                    <select class="select_field" id="dropdown-menu-buse-kta2206">

                        <option>Galerie N°1</option>

                    <!-- Initial options will be added dynamically -->
                    </select>

                    <button class="custom-button_item-remove" id="delete-buse-kta2206-btn" title="Supprimer la buse sélectionnée" onclick="removeGaleriekta2206()" ></button>
                    <button class="custom-button_item-rename" id="rename-buse-kta2206-btn" title="Renommer la buse sélectionnée" onclick="renameGaleriekta2206()" ></button>

                </div>


                <div class="longueur_ligne_container">
    
                    <div>
                        <label id="type-buse-label-kta2206" class="label_input_field">Type de galerie</label>
                    </div>
        
                    <div>
                    
                        <select class="select_field" id="type-buse-kta2206" onclick="">
    
                                <option value="1">Galerie simple d'environ 2 m x 2 m </option>
                                <option value="2">Galerie d'environ 2 m x 2 m à 3 ou 4 compartiments</option>
                               
                    
                        </select>
        
                    </div>
    
        
                </div>


                <div class="longueur_ligne_container">

                    <div>
                        <label for="longueur-galerie-kta2206" class="label_input_field">Longueur de la galerie</label>
                    </div>
        
                    <div>
        
                        <input type="number" class="select_field" id="longueur-galerie-kta2206" style="color: blue;" value="50">
            
                    </div>                    
        

                </div>


                <div class="longueur_ligne_container">
    
                    <div>
                        <label id="nombre-liaisons-jd-label-kta2206" class="label_input_field">Nombre de jonctions/joint de dilatation</label>
                    </div>
        
                    <div>
                    
                        <select class="select_field" id="nombre-liaisons-jd-kta2206" onclick="">
    
                                <option value="1">2</option>
                                <option value="2">4</option>
                                <option value="3">8</option>
                                <option value="4">16</option>
                              
                    
                        </select>
        
                    </div>
    
        
                </div>


                <div class="longueur_ligne_container">

                    <div>
                        <label for="nombre-jd-galerie-kta2206" class="label_input_field">Le nombre de joints de dilatation le long de la galerie</label>
                    </div>
        
                    <div>
        
                        <input type="number" class="select_field" id="nombre-jd-galerie-kta2206" style="color: blue;" value="2" step="1" min="1">
            
                    </div>                    
        

                </div>


                 <div class="longueur_ligne_container">

                    <div>
                        <label for="tenue-equipements-kta2206" class="label_input_field">Tenue au choc de foudre des équipements internes (kV)</label>
                    </div>
        
                    <div>
        
                        <input type="number" class="select_field" id="tenue-equipements-kta2206" style="color: blue;" value="1.5">
            
                    </div>                    

                </div>

                <div class="longueur_ligne_container">

                    <div>
                        <label for="coefficient-ponderation-galerie-kta2206" class="label_input_field">Coefficient de pondération pour le courant de foudre</label>
                    </div>
        
                    <div>
        
                        <input type="number" readonly class="select_field_o" id="coefficient-ponderation-galerie-kta2206" style="color: blue;" value="3">
            
                    </div>                    
        

                </div>


                <div class="longueur_ligne_container">

                    <div>
                        <label for="extension-fictive-kta2206" class="label_input_field">Extension fictive LDF/joint de dilatation (m)</label>
                    </div>
        
                    <div>
        
                        <input type="number" readonly class="select_field_o" id="extension-fictive-kta2206" style="color: blue;" value="30">
            
                    </div>                          

                </div>
                

                <div class="longueur_ligne_container">

                    <div>
                        <label for="courant-partiel-galerie-kta2206" class="label_input_field">Part du courant écoulée à travers la galerie (kA)</label>
                    </div>
        
                    <div>
        
                        <input type="number" readonly class="select_field_o" id="courant-partiel-galerie-kta2206" style="color: blue;" value="100">
            
                    </div>                    
        

                </div>


                <div class="longueur_ligne_container">


                    <div>
                        <label for="tension-induite-kta2206" class="label_input_field">
                            <strong>Tension axiale induite entre les 2 extrémités de la galerie UL (V)</strong>
                        </label>
                    </div>
        
                    <div>
        
                        <input type="number" readonly class="select_field_o" id="tension-induite-kta2206" style="color: blue;font-weight: bold" value="880">
                        <span class="exclamation" id="exclamationIconKTA2206" style="display: none;">!</span>
                        <div class="tooltip" id="tooltipKTA2206"></div>
            
                    </div>                    
        

                </div>
             
                


    
                
            </div>

    

 
        </div>



        <div class="line_container" id="calibre-deconnecteur">


            <div class="longueur_ligne_container">
    
                <div>
                    <label id="current-label" class="label_input_field"></label>
                </div>
    
                <div>
                
                    <select class="select_field" id="courant-foudre-iimp-in" onclick="">
    
                           
                
                    </select>
    
                </div>
    
            </div>

            <div class="longueur_ligne_container">
    
                <div>
                    <label id="classe" class="label_input_field">Classe du parafoudre</label>
                </div>
    
                <div>
                
                    <select class="select_field" id="classe-parafoudre-calibre" onclick="">
    
                        <option value="1">Type 1</option>
                        <option value="2">Type 2</option>
                
                    </select>
    
                </div>
    
            </div>
    
     
             <div class="longueur_ligne_container">
    
                <div>
                    <label for="calibre-deconnecteur-parafoudre" class="label_input_field">
                        <strong>Calibre du déconnecteur "D" de type fusible du parafoudre (A gG) [Norme IEC 61643-12]</strong>
                    </label>
                </div>
    
                <div>
    
                    <input type="number" readonly class="select_field_o" id="calibre-deconnecteur-parafoudre" style="color: blue; font-weight: bold;" value="10">
    
        
                </div>
    
                
            </div>

    
    
    
        </div>


        <div class="line_container" id="rayon-angle-protection">


            <div class="longueur_ligne_container">
    
                <div>
                    <label id="niveau-protection-label" class="label_input_field">Niveau de protection</label>
                </div>
    
                <div>
                
                    <select class="select_field" id="niveau-protection-option" onclick="">

                            <option value="1">Niveau I</option>
                            <option value="2">Niveau II</option>
                            <option value="3">Niveau III</option>
                            <option value="4">Niveau IV</option>
                            <option value="AUTRE">AUTRE</option>

                    
                        </select>
    
                           
                
                    </select>
    
                </div>

    
            </div>


            <div class="longueur_ligne_container">

                <div>
                    <label for="courant-impulsionnel-angle-protection" class="label_input_field">Courant impulsionnel de foudre Iimp (10/350 &micro;s) (kA)</label>
                </div>
    
                <div>
    
                    <input type="number" readonly class="select_field_o" id="courant-impulsionnel-angle-protection" style="color: blue;" value="3">
        
                </div>
    
            </div>


            <div class="longueur_ligne_container">
    
                <div>
                    <label for="surelevation-protection" class="label_input_field">Surélévation de la structure de protection &Delta;H (m)</label>
                </div>
    
                <div>
    
                    <input type="number" class="select_field" id="surelevation-protection" style="color: blue;" value="2.0">
        
                </div>
    
            </div>


            <div class="longueur_ligne_container">
    
                <div>
                    <label for="rayon-sphere-fictive-angle-protection" class="label_input_field">Rayon de la sphère fictive R (m)</label>
                </div>
    
                <div>
    
                    <input type="number" readonly class="select_field_o" id="rayon-sphere-fictive-angle-protection" style="color: blue;" value="20.0">
        
                </div>
    
            </div>


            <div class="longueur_ligne_container">
    
                <div>
                    <label for="angle-protection" class="label_input_field">Angle de protection &alpha; (°)</label>
                </div>
    
                <div>
    
                    <input type="number" readonly class="select_field_o" id="angle-protection" style="color: blue;" value="70.6">
        
                </div>
    
            </div>
  
     
             <div class="longueur_ligne_container">
    
                <div>
                    <label for="rayon-protection-angle-protection" class="label_input_field">
                        <strong>Rayon de protection Rp (m) </strong>
                    </label>
                </div>
    
                <div>
    
                    <input type="number" readonly class="select_field_o" id="rayon-protection-angle-protection" style="color: blue; font-weight: bold;" value="5.7">
    
        
                </div>
    
                
            </div>

    
    
    
        </div>


        <div class="line_container" id="rayon-sphere-fictive-sff">


            <div class="longueur_ligne_container">
    
                <div>
                    <label id="niveau-protection-label-sf" class="label_input_field">Niveau de protection</label>
                </div>
    
                <div>
                
                    <select class="select_field" id="niveau-protection-option-sf" onclick="">

                            <option value="1">Niveau I</option>
                            <option value="2">Niveau II</option>
                            <option value="3">Niveau III</option>
                            <option value="4">Niveau IV</option>
                            <option value="AUTRE">AUTRE</option>

                    
                        </select>
    
                           
                
                    </select>
    
                </div>

    
            </div>

            <div class="longueur_ligne_container">

                <div>
                    <label for="courant-impulsionnel-sphere-fictive" class="label_input_field">Courant impulsionnel de foudre Iimp (10/350 &micro;s) (kA)</label>
                </div>
    
                <div>
    
                    <input type="number" readonly class="select_field_o" id="courant-impulsionnel-sphere-fictive" style="color: blue;" value="3">
        
                </div>
    
            </div>


            <div class="longueur_ligne_container">
    
                <div>
                    <label for="surelevation-protection-sf" class="label_input_field">Surélévation de la structure de protection &Delta;H (m)</label>
                </div>
    
                <div>
    
                    <input type="number" class="select_field" id="surelevation-protection-sf" style="color: blue;" value="2.0">
        
                </div>
    
            </div>


            <div class="longueur_ligne_container">
    
                <div>
                    <label for="rayon-sphere-fictive-sphere-fictive" class="label_input_field">Rayon de la sphère fictive R (m)</label>
                </div>
    
                <div>
    
                    <input type="number" readonly class="select_field_o" id="rayon-sphere-fictive-sphere-fictive" style="color: blue;" value="20.0">
        
                </div>
    
            </div>

            
             <div class="longueur_ligne_container">
    
                <div>
                    <label for="rayon-protection-sphere-fictive" class="label_input_field">
                        <strong>Rayon de protection Rp (m) </strong>
                    </label>
                </div>
    
                <div>
    
                    <input type="number" readonly class="select_field_o" id="rayon-protection-sphere-fictive" style="color: blue; font-weight: bold;" value="8.7">
    
        
                </div>
    
                
            </div>

    
    
    
        </div>


        <div class="line_container" id="rayon-pda">


            <div class="longueur_ligne_container">
    
                <div>
                    <label id="niveau-protection-label-option-pda" class="label_input_field">Niveau de protection</label>
                </div>
    
                <div>
                
                    <select class="select_field" id="niveau-protection-option-pda" onclick="">

                            <option value="1">Niveau I</option>
                            <option value="2">Niveau II</option>
                            <option value="3">Niveau III</option>
                            <option value="4">Niveau IV</option>

                    
                        </select>
    
                           
                
                    </select>
    
                </div>

    
            </div>


            <div class="longueur_ligne_container">
    
                <div>
                    <label id="icpe-label" class="label_input_field">Installation ICPE (OUI/NON)</label>
                </div>
    
                <div>
                
                    <select class="select_field" id="icpe" onclick="">

                            <option value="oui">OUI</option>
                            <option value="non">NON</option>
                    
               
                    </select>
    
                </div>

    
            </div>




            <div class="longueur_ligne_container">
    
                <div>
                    <label for="surelevation-protection-pda" class="label_input_field">Surélévation de la structure de protection &Delta;H (m)</label>
                </div>
    
                <div>
    
                    <input type="number" class="select_field" id="surelevation-protection-pda" style="color: blue;" value="5.0">
        
                </div>
    
            </div>

            <div class="longueur_ligne_container">
    
                <div>
                    <label for="deltaT-pda" class="label_input_field">Temps d'avance à l'amorçage du PDA &Delta;T (&micro;s)</label>
                </div>
    
                <div>
    
                    <input type="number" class="select_field" id="deltaT-pda" style="color: blue;" value="60">
        
                </div>
    
            </div>



            <div class="longueur_ligne_container">
    
                <div>
                    <label for="rayon-sphere-fictive-pda" class="label_input_field">Rayon de la sphère fictive R (m)</label>
                </div>
    
                <div>
    
                    <input type="number" readonly class="select_field_o" id="rayon-sphere-fictive-pda" style="color: blue;" value="20">
        
                </div>
    
            </div>

            
             <div class="longueur_ligne_container">
    
                <div>
                    <label for="rayon-protection-pda" class="label_input_field">
                        <strong>Rayon de protection Rp (m) </strong>
                    </label>
                </div>
    
                <div>
    
                    <input type="number" readonly class="select_field_o" id="rayon-protection-pda" style="color: blue; font-weight: bold;" value="47.1">
    
        
                </div>
    
                
            </div>

    
    
    
        </div>


        <div class="line_container" id="profondeur-penetration">


            <div class="longueur_ligne_container">
    
                <div>
                    <label id="niveau-protection-label-p" class="label_input_field">Niveau de protection</label>
                </div>
    
                <div>
                
                    <select class="select_field" id="niveau-protection-p" onclick="">

                            <option value="1">Niveau I</option>
                            <option value="2">Niveau II</option>
                            <option value="3">Niveau III</option>
                            <option value="4">Niveau IV</option>
                            <option value="AUTRE">AUTRE</option>
                           
                
                    </select>
    
                </div>

    
            </div>

            <div class="longueur_ligne_container">

                <div>
                    <label for="courant-impulsionnel-p" class="label_input_field">Courant impulsionnel de foudre Iimp (10/350 &micro;s) (kA)</label>
                </div>
    
                <div>
    
                    <input type="number" readonly class="select_field_o" id="courant-impulsionnel-p" style="color: blue;" value="3">
        
                </div>
    
            </div>

 
            <div class="longueur_ligne_container">
    
                <div>
                    <label for="surelevation-pointe-1" class="label_input_field">Surélévation de la pointe 1 &Delta;H1 (m)</label>
                </div>
    
                <div>
    
                    <input type="number" class="select_field" id="surelevation-pointe-1" style="color: blue;" value="5.0">
        
                </div>
    
            </div>


            <div class="longueur_ligne_container">
    
                <div>
                    <label for="surelevation-pointe-2" class="label_input_field">Surélévation de la pointe 2 &Delta;H2 (m)</label>
                </div>
    
                <div>
    
                    <input type="number" class="select_field" id="surelevation-pointe-2" style="color: blue;" value="5.0">
        
                </div>
    
            </div>
            
            <div class="longueur_ligne_container">
    
                <div>
                    <label for="distance-pointes-1-2" class="label_input_field">Distance entre les pointes 1 et 2 D (m)</label>
                </div>
    
                <div>
    
                    <input type="number" class="select_field" id="distance-pointes-1-2" style="color: blue;" value="5.0">
        
                </div>
    
            </div>

            
            <div class="longueur_ligne_container">
    
                <div>
                    <label for="rayon-sphere-fictive-p" class="label_input_field">Rayon de la sphère fictive R (m)</label>
                </div>
    
                <div>
    
                    <input type="number" readonly class="select_field_o" id="rayon-sphere-fictive-p" style="color: blue;" value="20.0">
        
                </div>
    
            </div>

            <div class="longueur_ligne_container">
    
                <div>
                    <label for="centre-x0-sphere" class="label_input_field">Centre X0 de la sphère fictive/Pointe 1 (m)</label>
                </div>
    
                <div>
    
                    <input type="text" readonly class="select_field_o" id="centre-x0-sphere" style="color: blue;" value="2.5">
        
                </div>
    
            </div>

            <div class="longueur_ligne_container">
    
                <div>
                    <label for="centre-y0-sphere" class="label_input_field">Centre Y0 de la sphère fictive/niveau de la surface à protéger (m)</label>
                </div>
    
                <div>
    
                    <input type="number" readonly class="select_field_o" id="centre-y0-sphere" style="color: blue;" value="24.8">
        
                </div>
    
            </div>


            
             <div class="longueur_ligne_container">
    
                <div>
                    <label for="profondeur-penetration-petitepointe" class="label_input_field">
                        <strong>Profondeur de pénétration de la sphère fictive/petite pointe p (m) </strong>
                    </label>
                </div>
    
                <div>
    
                    <input type="number" readonly class="select_field_o" id="profondeur-penetration-petitepointe" style="color: blue; font-weight: bold;" value="0.2">
                    <span class="exclamation" id="exclamationIcon3" style="display: none;">!</span>
                    <div class="tooltip" id="tooltip3"></div>
    
        
                </div>
    
                
            </div>

    
    
    
        </div>




        <div class="line_container" id="iimp-cheminement">

            
            <div class="longueur_ligne_container">
    
                <div>
                    <label id="niveau-protection-label-cheminement" class="label_input_field">Niveau de protection</label>
                </div>
    
                <div>
                
                    <select class="select_field" id="niveau-protection-cheminement" onclick="">

                            <option value="1">Niveau I</option>
                            <option value="2">Niveau II</option>
                            <option value="3">Niveau III</option>
                            <option value="4">Niveau IV</option>
                            <option value="AUTRE">AUTRE</option>
                           
                
                    </select>
    
                </div>

    
            </div>

            <div class="longueur_ligne_container">
    
                <div>
                    <label for="courant-total-cheminement" class="label_input_field">Courant de foudre total (kA) </label>

                </div>
    
                <div>
    
                    <input type="number" readonly class="select_field_o" id="courant-total-cheminement" style="color: blue; "  value="200.00">
        
                </div>
    
            </div>

  
            <div class="longueur_ligne_container">
    
                <div>
                    <label for="impedance-prise-terre" class="label_input_field">Impédance de la prise de terre du SPF Z (&ohm;)</label>
                </div>
    
                <div>
    
                    <input type="number" class="select_field" id="impedance-prise-terre" style="color: blue;" value="10.0">
        
                </div>
    
            </div>

            <div class="longueur_ligne_container">
    
                <div>
                    <label for="courant-prise-terre" class="label_input_field">
                    <strong>Courant injecté dans la prise de terre du SPF I(kA)</strong>
                </div>
    
                <div>
    
                    <input type="number" readonly class="select_field_o" id="courant-prise-terre" style="color: blue; font-weight: bold;"  value="100.00">
        
                </div>
    
            </div>

             
            <div class="longueur_ligne_container">

    
                <div class="dropdow_menu_line" id="dropdow-menu-cheminement">

                    <button class="custom-button_item-add" id="add-cheminement-btn" title="Ajouter un cheminement" ></button>

                    <label for="dropdown-menu-cheminement"></label>
                    <select class="select_field" id="dropdown-menu-cheminement">

                        <option>Cheminement N°1</option>

                    <!-- Initial options will be added dynamically -->
                    </select>

                    <button class="custom-button_item-remove" id="delete-cheminement-btn" title="Supprimer le cheminement" onclick="removeCheminement()" ></button>
                    <button class="custom-button_item-rename" id="rename-cheminement-btn" title="Renommer le cheminement" onclick="renameCheminement()" ></button>

                </div>

                
                <div style="margin-top: 20px;">
                    <label for="nombre-conducteurs" class="label_input_field">Nombre de conducteurs du cheminement sélectionné n </label>

                </div>
    
                <div>
    
                    <input type="number" class="select_field" id="nombre-conducteurs" style="color: blue;"  value="1">
        
                </div>

                <div style="margin-top: 20px;">
                    <label for="impedance-cheminement" class="label_input_field">Impédance du cheminement sélectionné Zc (&ohm;)</label>

                </div>
    
                <div>
    
                    <input type="number" class="select_field" id="impedance-cheminement" style="color: blue;"  value="10.0">
        
                </div>


                <div style="margin-top: 20px;">
                    <label for="coefficient-repartition" class="label_input_field">
                    <strong>Coefficient de répartition du courant impulsionnel de foudre</strong>
                </div>
    
                <div>
    
                    <input type="number" readonly class="select_field_o" id="coefficient-repartition" style="color: blue; font-weight: bold;"  value="0.50">
        
                </div>


                <div style="margin-top: 20px;">
                    <label for="courant-iimp-cheminement-selectionne" class="label_input_field">
                    <strong>Courant impulsionnel Iimp/conducteur du cheminement sélectionné (kA)</strong>
                </div>
    
                <div>
    
                    <input type="number" readonly class="select_field_o" id="courant-iimp-cheminement-selectionne" style="color: blue; font-weight: bold;"  value="100.00">
        
                </div>
    


    
                
            </div>

    
    
    
        </div>



        <div class="line_container" id="calculs-electrodynamiques-container">

            
            <div class="longueur_ligne_container">
    
                <div>
                    <label id="niveau-protection-label-force" class="label_input_field">Niveau de protection</label>
                </div>
    
                <div>
                
                    <select class="select_field" id="niveau-protection-force" onclick="">

                            <option value="1">Niveau I</option>
                            <option value="2">Niveau II</option>
                            <option value="3">Niveau III</option>
                            <option value="4">Niveau IV</option>
                            <option value="AUTRE">AUTRE</option>
                           
                
                    </select>
    
                </div>

    
            </div>

            <div class="longueur_ligne_container">
    
                <div>
                    <label for="courant-max-force" class="label_input_field">Courant maximal impulsionnel de foudre (kA)</label>
                </div>
    
                <div>
    
                    <input type="number" readonly class="select_field_o" id="courant-max-force" style="color: blue;" value="200.00">
        
                </div>
    
            </div>
 
             
            <div class="longueur_ligne_container">

    
                <div class="dropdow_menu_line" id="dropdow-menu-force">

                    <button class="custom-button_item-add" id="add-force-btn" title="Ajouter un conducteur" ></button>

                    <label for="dropdown-menu-force"></label>
                    <select class="select_field" id="dropdown-menu-force">

                        <option>Conducteur parallèle N°1</option>

                    <!-- Initial options will be added dynamically -->
                    </select>

                    <button class="custom-button_item-remove" id="delete-force-btn" title="Supprimer le conducteur sélectionné" onclick="removeConducteur()" ></button>
                    <button class="custom-button_item-rename" id="rename-force-btn" title="Renommer le conducteur sélectionné" onclick="renameConducteur()" ></button>

                </div>

                
                <div class="longueur_ligne_container">
        
                    <div>
                        <label for="distance-entre-fixations" class="label_input_field">Distance entre fixations du conducteur sélectionné (m)</label>
                    </div>
        
                    <div>
        
                        <input type="number" class="select_field" id="distance-entre-fixations" style="color: blue;" value="0.5">
            
                    </div>
        
                </div>
                
                <div class="longueur_ligne_container">
        
                    <div>
                        <label for="position-conducteur-x0" class="label_input_field">Position X0 du conducteur sélectionné (m)</label>
                    </div>
        
                    <div>
        
                        <input type="number" class="select_field" id="position-conducteur-x0" style="color: blue;" value="0.0"">
            
                    </div>
        
                </div>


                <div class="longueur_ligne_container">
        
                    <div>
                        <label for="position-conducteur-y0" class="label_input_field">Position Y0 du conducteur sélectionné (m)</label>
                    </div>
        
                    <div>
        
                        <input type="number" class="select_field" id="position-conducteur-y0" style="color: blue;" value="0.0"">
            
                    </div>
        
                </div>


                <div class="longueur_ligne_container">
        
                    <div>
                        <label for="angle-inclinaison-mur" class="label_input_field">Angle d'inclinaison du mur support du conducteur sélectionné (°)</label>
                    </div>
        
                    <div>
        
                        <input type="number" class="select_field" id="angle-inclinaison-mur" style="color: blue;" value="0.0"">
            
                    </div>
        
                </div>

                <div class="longueur_ligne_container">
        
                    <div>
                        <label for="coefficient-repartition-force" class="label_input_field">Coefficient de répartition du courant de foudre au niveau du conducteur sélectionné</label>
                    </div>
        
                    <div>
        
                        <input type="number" class="select_field" id="coefficient-repartition-force" style="color: blue;" value="0.1"">
            
                    </div>
        
                </div>


                <div class="longueur_ligne_container">
        
                    <div>
                        <label for="force-resultante-traction" class="label_input_field">
                        <strong>Force de Laplace résultante exercée sur le conducteur sélectionné (Traction) (daN)</strong>
                    </div>
        
                    <div>
        
                        <input type="number" class="select_field_o" id="force-resultante-traction" style="color: blue; font-weight: bold;" value="0.0"">
            
                    </div>
        
                </div>

                <div class="longueur_ligne_container">
        
                    <div>
                        <label for="force-resultante-cisaillement" class="label_input_field">
                        <strong>Force de Laplace résultante exercée sur le conducteur sélectionné (Cisaillement) (daN)</strong>
                    </div>
        
                    <div>
        
                        <input type="number" class="select_field_o" id="force-resultante-cisaillement" style="color: blue; font-weight: bold;" value="0.0"">
            
                    </div>
        
                </div>

       


    
                
            </div>

    
    
    
        </div>




        <div class="line_container" id="transformee-fourrier">


            
            <div class="longueur_ligne_container">
    
                <div>
                    <label for="exposant-echantillonnage-fourrier" class="label_input_field">Période d'échantionnage (ns)</label>
                </div>
    
                <div>
    
                    <input type="number" class="select_field" id="exposant-echantillonnage-fourrier" style="color: blue;" value="500">
        
                </div>
    
            </div>


            <div class="longueur_ligne_container">
    
                <div>
                    <label for="duree-fourrier" class="label_input_field">Durée étudiée de l'onde (&micro;s)</label>
                </div>
    
                <div>
    
                    <input type="number" class="select_field" id="duree-fourrier" style="color: blue;" value="500.00">
        
                </div>
    
            </div>

            
            <div class="longueur_ligne_container">
    
                <div>
                    <label id="niveau-protection-label-fourrier" class="label_input_field">Niveau de protection</label>
                </div>
    
                <div>
                
                    <select class="select_field" id="niveau-protection-fourrier" onclick="">

                            <option value="1">Niveau I</option>
                            <option value="2">Niveau II</option>
                            <option value="3">Niveau III</option>
                            <option value="4">Niveau IV</option>
                           
                
                    </select>
    
                </div>

    
            </div>

            <div class="longueur_ligne_container">
    
                <div>
                    <label id="type-choc-label-fourrier" class="label_input_field">Type de choc de foudre</label>
                </div>
    
                <div>


                
                    <select class="select_field" id="type-choc-fourrier" onclick="">

                            <option value="1">Premier choc positif</option>
                            <option value="2">Premier choc négatif</option>
                            <option value="3">Choc négatif subséquent</option>
                          
                
                    </select>
    
                </div>

    
            </div>


  
            <div class="longueur_ligne_container">
    
                <div>
                    <label for="courant-max-fourrier" class="label_input_field">Courant maximal I(kA)</label>
                </div>
    
                <div>
    
                    <input type="number" readonly class="select_field" id="courant-max-fourrier" style="color: blue;" value="200.0">
        
                </div>
    
            </div>


            <div class="longueur_ligne_container">
    
                <div>
                    <label for="coefficient-k-fourrier" class="label_input_field">Coefficient k </label>
                </div>
    
                <div>
    
                    <input type="number" readonly class="select_field" id="coefficient-k-fourrier" style="color: blue;" value="0.93">
        
                </div>
    
            </div>

            <div class="longueur_ligne_container">
    
                <div>
                    <label for="constante-temps-to1-fourrier" class="label_input_field">Constante de temps &tau;1 (&micro;s) </label>
                </div>
    
                <div>
    
                    <input type="number" readonly class="select_field" id="constante-temps-to1-fourrier" style="color: blue;" value="19.00">
        
                </div>
    
            </div>

            <div class="longueur_ligne_container">
    
                <div>
                    <label for="constante-temps-to2-fourrier" class="label_input_field">Constante de temps &tau;2 (&micro;s) </label>
                </div>
    
                <div>
    
                    <input type="number" readonly class="select_field" id="constante-temps-to2-fourrier" style="color: blue;" value="485.00">
        
                </div>
    
            </div>





            <div class="longueur_ligne_container">

                <img id="formule-onde-foudre" alt="Formule onde de foudre" />
   
      
            </div>
 
    
    
    
        </div>




        <div class="line_container" id="champ-magnetique-container-direct-zpf1">


            <div class="longueur_ligne_container">
    
                <div>
                    <label id="niveau-protection-label-champ-direct-zpf1" class="label_input_field">Niveau de protection</label>
                </div>
    
                <div>
                
                    <select class="select_field" id="niveau-protection-champ-direct-zpf1" onclick="">

                            <option value="1">Niveau I</option>
                            <option value="2">Niveau II</option>
                            <option value="3">Niveau III</option>
                            <option value="4">Niveau IV</option>
                            <option value="AUTRE">AUTRE</option>
                           
                
                    </select>
    
                </div>

    
            </div>

            <div class="longueur_ligne_container">
    
                <div>
                    <label id="type-choc-label-champ-direct-zpf1" class="label_input_field">Type de choc de foudre</label>
                </div>
    
                <div>


                
                    <select class="select_field" id="type-choc-champ-direct-zpf1" onclick="">

                            <option value="1">Premier choc positif</option>
                            <option value="2">Premier choc négatif</option>
                            <option value="3">Choc négatif subséquent</option>
                          
                
                    </select>
    
                </div>

    
            </div>

            
            <div class="longueur_ligne_container">
    
                <div>
                    <label for="distance-point-mur-direct-zpf1" class="label_input_field">Distance du point considéré du mur du bâtiment dw (m)</label>
                </div>
    
                <div>
    
                    <input type="number" class="select_field" id="distance-point-mur-direct-zpf1" style="color: blue;" value="10.0">
        
                </div>
    
            </div>


            <div class="longueur_ligne_container">
    
                <div>
                    <label for="distance-point-toit-direct-zpf1" class="label_input_field">Distance du point considéré du toit du bâtiment dr (m)</label>
                </div>
    
                <div>
    
                    <input type="number" class="select_field" id="distance-point-toit-direct-zpf1" style="color: blue;" value="10.0">
        
                </div>
    
            </div>


            <div class="longueur_ligne_container">
    
                <div>
                    <label for="courant-max-champ-direct-zpf1" class="label_input_field">Courant maximal impulsionnel de foudre (kA)</label>
                </div>
    
                <div>
    
                    <input type="number" readonly class="select_field_o" id="courant-max-champ-direct-zpf1" style="color: blue;" value="200.00">
        
                </div>
    
            </div>

 
            <div class="longueur_ligne_container">
    
                <div>
                    <label id="reseau-equipotentialite-direct-label" class="label_input_field">Réseau d'équipotentialité conçu selon recommandations de la norme NF EN 62305-4 [§5.2] (OUI/NON)</label>
                </div>
    
                <div>

                
                    <select class="select_field" id="reseau-equipotentialite-direct" onclick="">

                            <option value="1">Oui</option>
                            <option value="2">Non</option>                         
                
                    </select>
    
                </div>


    
            </div>

 
             
            <div class="longueur_ligne_container">

    
                <div class="dropdow_menu_line" id="dropdow-menu-zpf-direct">

                    <button class="custom-button_item-add" id="add-zpf-direct-btn" title="Ajouter une zone ZPF" ></button>

                    <label for="dropdown-menu-zpf-direct"></label>
                    <select class="select_field" id="dropdown-menu-zpf-direct" title="L'écran de la première zone (ZPF 1) représente l'écran du bâtiment!">

                        <option>Zone ZPF N°1</option>

                    <!-- Initial options will be added dynamically -->
                    </select>

                    <button class="custom-button_item-remove" id="delete-zpf-direct-btn" title="Supprimer la zone ZPF sélectionnée" onclick="removeZPFDIRECT()" ></button>
                    <button class="custom-button_item-rename" id="rename-zpf-direct-btn" title="Renommer la zone ZPF sélectionnée" onclick="renameZPFDIRECT()" ></button>

                </div>

                
                <div class="longueur_ligne_container">
        
                    <div>
                        <label for="taille-mailles-batiment-direct-zpf1" class="label_input_field">Taille des mailles de l'écran de la zone ZPF sélectionnée (m)</label>
                    </div>
        
                    <div>
        
                        <input type="number" class="select_field" id="taille-mailles-batiment-direct-zpf1" style="color: blue;" value="5">
            
                    </div>
        
                </div>


                
                <div class="longueur_ligne_container">
        
                    <div>
                        <label for="diametre-conducteurs-ecran-batiment-direct-zpf1" class="label_input_field">Diamètre des conducteurs de l'écran de la zone ZPF sélectionnée (mm)</label>
                    </div>
        
                    <div>
        
                        <input type="number" class="select_field" id="diametre-conducteurs-ecran-batiment-direct-zpf1" style="color: blue;" value="4.0"">
            
                    </div>
        
                </div>

                <div class="longueur_ligne_container">
    
                    <div>
                        <label id="type-materiau-champ-direct-zpf1-label" class="label_input_field">Type de matériau des conducteurs de l'écran de la zone ZPF sélectionnée</label>
                    </div>
        
                    <div>
    
                    
                        <select class="select_field" id="type-materiau-champ-direct-zpf1" onclick="">
    
                                <option value="1">Cuivre</option>
                                <option value="2">Aluminium</option>
                                <option value="3">Acier</option>
                              
                    
                        </select>
        
                    </div>


        
                </div>

                
            <div class="longueur_ligne_container">
    
                <div>
                    <label for="facteur-ecran-direct-zpf1" class="label_input_field">
                        <strong>Facteur d'attenuation de l'écran de la zone ZPF sélectionnée (dB) </strong>
                    </label>
                </div>
    
                <div>
    
                    <input type="number" readonly class="select_field_o" id="facteur-ecran-direct-zpf1" style="color: blue; font-weight: bold;" value="">

    
        
                </div>
    
                
            </div>

            <div class="longueur_ligne_container">
    
                <div>
                    <label for="distance-securite-direct-zpf1" class="label_input_field" title="Le point considéré doit être situé à une distance des parois internes de l'écran supérieure à la distance de sécurité pour avoir une efficacité de l'écran">
                        <strong>Distance de sécurité de l'écran de la zone sélectionnée</strong>
                    </label>
                </div>
    
                <div>
    
                    <input type="number" readonly class="select_field_o" id="distance-securite-direct-zpf1" style="color: blue; font-weight: bold;" value="">

    
        
                </div>
    
                
            </div>
    

    
                
            </div>


 

            <div class="longueur_ligne_container">
    
                <div>
                    <label for="champ-magnetrique-avec-ecran-direct-zpf1" class="label_input_field">
                        <strong>Champ magnétique calculé en présence d'écran(s) (A/m) </strong>
                    </label>
                </div>
    
                <div>
    
                    <input type="number" readonly class="select_field_o" id="champ-magnetrique-avec-ecran-direct-zpf1" style="color: blue; font-weight: bold;" value="">

    
        
                </div>
    
                
            </div>

            <div class="longueur_ligne_container">
    
                <div>
                    <label for="facteur-global-ecran-direct-zpf1" class="label_input_field">
                        <strong>Facteur global d'attenuation de l'écran (dB) </strong>
                    </label>
                </div>
    
                <div>
    
                    <input type="number" readonly class="select_field_o" id="facteur-global-ecran-direct-zpf1" style="color: blue; font-weight: bold;" value="">

    
        
                </div>
    
                
            </div>




   
    
        </div>






        <div class="line_container" id="champ-magnetique-container-indirect-zpf1">


            <div class="longueur_ligne_container">
    
                <div>
                    <label id="niveau-protection-label-champ-indirect-zpf1" class="label_input_field">Niveau de protection</label>
                </div>
    
                <div>
                
                    <select class="select_field" id="niveau-protection-champ-indirect-zpf1" onclick="">

                            <option value="1">Niveau I</option>
                            <option value="2">Niveau II</option>
                            <option value="3">Niveau III</option>
                            <option value="4">Niveau IV</option>
                            <option value="AUTRE">AUTRE</option>
                           
                
                    </select>
    
                </div>

    
            </div>

            <div class="longueur_ligne_container">
    
                <div>
                    <label id="type-choc-label-champ-indirect-zpf1" class="label_input_field">Type de choc de foudre</label>
                </div>
    
                <div>


                
                    <select class="select_field" id="type-choc-champ-indirect-zpf1" onclick="">

                            <option value="1">Premier choc positif</option>
                            <option value="2">Premier choc négatif</option>
                            <option value="3">Choc négatif subséquent</option>
                          
                
                    </select>
    
                </div>

    
            </div>

            
            <div class="longueur_ligne_container">
    
                <div>
                    <label for="hauteur-batiment-champ-indirect-zpf1" class="label_input_field">Hauteur du bâtiment H(m)</label>
                </div>
    
                <div>
    
                    <input type="number" class="select_field" id="hauteur-batiment-champ-indirect-zpf1" style="color: blue;" value="10.0">
        
                </div>
    
            </div>


            <div class="longueur_ligne_container">
    
                <div>
                    <label for="longueur-batiment-champ-indirect-zpf1" class="label_input_field" title="Prenez la valeur minimale entre la longueur et la largeur">Taille du bâtiment W(m)</label>
                </div>
    
                <div>
    
                    <input type="number" class="select_field" id="longueur-batiment-champ-indirect-zpf1" style="color: blue;" value="20.0">
        
                </div>
    
            </div>


            <div class="longueur_ligne_container">
    
                <div>
                    <label for="courant-max-champ-indirect-zpf1" class="label_input_field">Courant maximal impulsionnel de foudre (kA)</label>
                </div>
    
                <div>
    
                    <input type="number" readonly class="select_field_o" id="courant-max-champ-indirect-zpf1" style="color: blue;" value="200">
        
                </div>
    
            </div>

 
            <div class="longueur_ligne_container">
    
                <div>
                    <label for="distance-indirect-zpf1" class="label_input_field">Distance de l'impact du point considéré Sa (m)</label>
                </div>
    
                <div>
    
                    <input type="number" readonly class="select_field_o" id="distance-indirect-zpf1" style="color: blue;" value="">
        
                </div>
    
            </div>

            <div class="longueur_ligne_container">
    
                <div>
                    <label for="rayon-sf-indirect-zpf1" class="label_input_field">Rayon de la sphère fictive (m)</label>
                </div>
    
                <div>
    
                    <input type="number" readonly class="select_field_o" id="rayon-sf-indirect-zpf1" style="color: blue;" value="">
        
                </div>
    
            </div>

 
            <div class="longueur_ligne_container">
    
                <div>
                    <label id="reseau-equipotentialite-indirect-label" class="label_input_field">Réseau d'équipotentialité conçu selon recommandations de la norme NF EN 62305-4 [§5.2] (OUI/NON)</label>
                </div>
    
                <div>

                
                    <select class="select_field" id="reseau-equipotentialite-indirect" onclick="">

                            <option value="1">Oui</option>
                            <option value="2">Non</option>                         
                
                    </select>
    
                </div>


    
            </div>

 
             
            <div class="longueur_ligne_container">

    
                <div class="dropdow_menu_line" id="dropdow-menu-zpf">

                    <button class="custom-button_item-add" id="add-zpf-btn" title="Ajouter une zone ZPF" ></button>

                    <label for="dropdown-menu-zpf"></label>
                    <select class="select_field" id="dropdown-menu-zpf" title="L'écran de la première zone (ZPF 1) représente l'écran du bâtiment!">

                        <option>Zone ZPF N°1</option>

                    <!-- Initial options will be added dynamically -->
                    </select>

                    <button class="custom-button_item-remove" id="delete-zpf-btn" title="Supprimer la zone ZPF sélectionnée" onclick="removeZPF()" ></button>
                    <button class="custom-button_item-rename" id="rename-zpf-btn" title="Renommer la zone ZPF sélectionnée" onclick="renameZPF()" ></button>

                </div>

                
                <div class="longueur_ligne_container">
        
                    <div>
                        <label for="taille-mailles-batiment-indirect-zpf1" class="label_input_field">Taille des mailles de l'écran de la zone ZPF sélectionnée (m)</label>
                    </div>
        
                    <div>
        
                        <input type="number" class="select_field" id="taille-mailles-batiment-indirect-zpf1" style="color: blue;" value="5">
            
                    </div>
        
                </div>


                
                <div class="longueur_ligne_container">
        
                    <div>
                        <label for="diametre-conducteurs-ecran-batiment-indirect-zpf1" class="label_input_field">Diamètre des conducteurs de l'écran de la zone ZPF sélectionnée (mm)</label>
                    </div>
        
                    <div>
        
                        <input type="number" class="select_field" id="diametre-conducteurs-ecran-batiment-indirect-zpf1" style="color: blue;" value="4.0"">
            
                    </div>
        
                </div>

                <div class="longueur_ligne_container">
    
                    <div>
                        <label id="type-materiau-champ-indirect-zpf1-label" class="label_input_field">Type de matériau des conducteurs de l'écran de la zone ZPF sélectionnée</label>
                    </div>
        
                    <div>
    
                    
                        <select class="select_field" id="type-materiau-champ-indirect-zpf1" onclick="">
    
                                <option value="1">Cuivre</option>
                                <option value="2">Aluminium</option>
                                <option value="3">Acier</option>
                              
                    
                        </select>
        
                    </div>


        
                </div>

                
            <div class="longueur_ligne_container">
    
                <div>
                    <label for="facteur-ecran-indirect-zpf1" class="label_input_field">
                        <strong>Facteur d'attenuation de l'écran de la zone ZPF sélectionnée (dB) </strong>
                    </label>
                </div>
    
                <div>
    
                    <input type="number" readonly class="select_field_o" id="facteur-ecran-indirect-zpf1" style="color: blue; font-weight: bold;" value="">

    
        
                </div>
    
                
            </div>

            <div class="longueur_ligne_container">
    
                <div>
                    <label for="distance-securite-indirect-zpf1" class="label_input_field" title="Le point considéré doit être situé à une distance des parois internes de l'écran supérieure à la distance de sécurité pour avoir une efficacité de l'écran">
                        <strong>Distance de sécurité de l'écran de la zone sélectionnée</strong>
                    </label>
                </div>
    
                <div>
    
                    <input type="number" readonly class="select_field_o" id="distance-securite-indirect-zpf1" style="color: blue; font-weight: bold;" value="">

    
        
                </div>
    
                
            </div>
    

    
                
            </div>


            <div class="longueur_ligne_container">
    
                <div>
                    <label for="champ-magnetrique-sans-ecran-indirect-zpf1" class="label_input_field">
                        <strong>Champ magnétique calculé en absence d'écran(s) (A/m) </strong>
                    </label>
                </div>
    
                <div>
    
                    <input type="number" readonly class="select_field_o" id="champ-magnetrique-sans-ecran-indirect-zpf1" style="color: blue; font-weight: bold;" value="">
 
        
                </div>
    
                
            </div>


            <div class="longueur_ligne_container">
    
                <div>
                    <label for="champ-magnetrique-avec-ecran-indirect-zpf1" class="label_input_field">
                        <strong>Champ magnétique calculé en présence d'écran(s) (A/m) </strong>
                    </label>
                </div>
    
                <div>
    
                    <input type="number" readonly class="select_field_o" id="champ-magnetrique-avec-ecran-indirect-zpf1" style="color: blue; font-weight: bold;" value="">

    
        
                </div>
    
                
            </div>

            <div class="longueur_ligne_container">
    
                <div>
                    <label for="facteur-global-ecran-indirect-zpf1" class="label_input_field">
                        <strong>Facteur global d'attenuation de l'écran (dB) </strong>
                    </label>
                </div>
    
                <div>
    
                    <input type="number" readonly class="select_field_o" id="facteur-global-ecran-indirect-zpf1" style="color: blue; font-weight: bold;" value="">

    
        
                </div>
    
                
            </div>




   
    
        </div>



</div>
        
<div class="right-container">

    <!-- Image avec style pour occuper tout l'espace de son conteneur -->
    <img id="dynamic-image" src="photos/elevation_temperature.jpg"
        alt="Élévation de température"
        style="width: 100%; height: auto; border-radius: 10px; border: 0.5px solid black;">

    <div id="plot-container">

    <div id="heidlerPlot" class="plot-container"></div>

    <div id="fftPlot" class="plot-container"></div>

    </div>

    
</div>

<script>


const materials = {
        1: {

            resistanceOhmique: "1.78E-8",
            coefficientTemperature: "3.92E-3",
            chaleurspecifique:"209E3",
            densiteMateriau: "8920",
            capaciteThermique: "385",
            temperatureFusion: "1080",
            section:"6",
            uac:"10"
        },
        2: {
            resistanceOhmique: "2.90E-8",
            coefficientTemperature: "4.00E-3",
            chaleurspecifique:"397E3",
            densiteMateriau: "2700",
            capaciteThermique: "908",
            temperatureFusion: "658",
            section:"10",
            uac:"10"
        },

        3: {
            resistanceOhmique: "1.20E-7",
            coefficientTemperature: "6.50E-3",
            chaleurspecifique:"272E3",
            densiteMateriau: "7700",
            capaciteThermique: "469",
            temperatureFusion: "1530",
            section:"16",
            uac:"10"
        },

        4: {
            resistanceOhmique: "7.00E-7",
            coefficientTemperature: "8.00E-4",
            chaleurspecifique:"272E3",
            densiteMateriau: "8000",
            capaciteThermique: "500",
            temperatureFusion: "1500",
            section:"16",
            uac:"10"
        }

  

    }


    const materials_13_200 = {
        1: {

            Qc: "3.45E-3",
            Beta: "234.5",
            rho20: "17.241E-6",
            temperature_finale:"1080"
    
        },

        2: {
            Qc: "2.5E-3",
            Beta: "228.0",
            rho20: "28.264E-6",
            temperature_finale:"658"
  
        },

        3: {
            Qc: "3.8E-3",
            Beta: "202.0",
            rho20: "138.000E-6",
            temperature_finale:"1530"

        },

  

    }

  


      // Fonction pour mettre à jour les données des champs en fonction du matériau sélectionné
    function updateMaterialProperties() {
        const selectedMaterial = document.getElementById('materiau-conducteur').value;
        const properties = materials[selectedMaterial];

        document.getElementById('resistance-ohmique').value = properties.resistanceOhmique;
        document.getElementById('coefficient-temperature').value = properties.coefficientTemperature;
        document.getElementById('densite-materiau').value = properties.densiteMateriau;
        document.getElementById('capacite-thermique').value = properties.capaciteThermique;
        document.getElementById('temperature-fusion').value = properties.temperatureFusion;

        // Recalculer Δθ après avoir mis à jour les propriétés
        calculateDeltaTheta();
    }

    function updatesectionconducteursparafoudre() {

        const selectedcalibre= document.getElementById('calibre-protection').value;
        const selectedparafoudre= document.getElementById('classe-parafoudre').value;

        if (selectedparafoudre==='1') {

            document.getElementById('section-minimale-raccordement-s1').value=section_conducteurs_pf_1[selectedcalibre].s1;
            document.getElementById('section-minimale-raccordement-s2').value=section_conducteurs_pf_1[selectedcalibre].s2;

        } else if (selectedparafoudre==='2') {

            document.getElementById('section-minimale-raccordement-s1').value=section_conducteurs_pf_2[selectedcalibre].s1;
            document.getElementById('section-minimale-raccordement-s2').value=section_conducteurs_pf_2[selectedcalibre].s2;

        } else if (selectedparafoudre==='3') {

            document.getElementById('section-minimale-raccordement-s1').value=section_conducteurs_pf_3[selectedcalibre].s1;
            document.getElementById('section-minimale-raccordement-s2').value=section_conducteurs_pf_3[selectedcalibre].s2;

        }

    }

    function updateMaterialPropertiesProfondeur() {
        const selectedMaterial = document.getElementById('materiau-conducteur-profondeur').value;
        const properties = materials[selectedMaterial];

        document.getElementById('densite-materiau-profondeur').value = properties.densiteMateriau;
        document.getElementById('capacite-thermique-profondeur').value = properties.capaciteThermique;
        document.getElementById('chaleur-specifique-profondeur').value = properties.chaleurspecifique;
        document.getElementById('temperature-fusion-profondeur').value = properties.temperatureFusion;

        calculateProfondeurFusion();
    }

    function updateMaterialPropertiesLiaisons() {
        const selectedMaterial = document.getElementById('materiau-conducteur-liaisons').value;
        const properties = materials[selectedMaterial];

        document.getElementById('resistance-ohmique-liaisons').value = properties.resistanceOhmique;
        document.getElementById('coefficient-temperature-liaisons').value = properties.coefficientTemperature;
        document.getElementById('densite-materiau-liaisons').value = properties.densiteMateriau;
        document.getElementById('capacite-thermique-liaisons').value = properties.capaciteThermique;
        document.getElementById('temperature-fusion-liaisons').value = properties.temperatureFusion;

        // Recalculer Δθ après avoir mis à jour les propriétés
        calculateSectionConducteursLiaisons();
    }

    function updateMaterialPropertiesSpf() {
        const selectedMaterial = document.getElementById('materiau-conducteur-spf').value;
        const properties = materials[selectedMaterial];

        document.getElementById('resistance-ohmique-spf').value = properties.resistanceOhmique;
        document.getElementById('coefficient-temperature-spf').value = properties.coefficientTemperature;
        document.getElementById('densite-materiau-spf').value = properties.densiteMateriau;
        document.getElementById('capacite-thermique-spf').value = properties.capaciteThermique;
        document.getElementById('temperature-fusion-spf').value = properties.temperatureFusion;

        // Recalculer Δθ après avoir mis à jour les propriétés
        calculateSectionConducteurs();
    }

    function updateMaterialPropertiesTerre() {
        const selectedMaterial = document.getElementById('materiau-conducteur-terre').value;
        const properties = materials_13_200[selectedMaterial];

        document.getElementById('Qc').value = properties.Qc;
        document.getElementById('Beta').value = properties.Beta;
        document.getElementById('rho20').value = properties.rho20;
        document.getElementById('temperature-finale').value = properties.temperature_finale;


        // Recalculer Δθ après avoir mis à jour les propriétés
        calculateSectionConducteursTerre();
        
    }

    document.getElementById('materiau-conducteur').addEventListener('change', updateMaterialProperties);
    document.getElementById('materiau-conducteur-profondeur').addEventListener('change', updateMaterialPropertiesProfondeur);
    document.getElementById('materiau-conducteur-spf').addEventListener('change', updateMaterialPropertiesSpf);
    document.getElementById('materiau-conducteur-terre').addEventListener('change', updateMaterialPropertiesTerre);
    document.getElementById('materiau-conducteur-liaisons').addEventListener('change', updateMaterialPropertiesLiaisons);
    document.getElementById('calibre-protection').addEventListener('change', updatesectionconducteursparafoudre);
    document.getElementById('classe-parafoudre').addEventListener('change', updatesectionconducteursparafoudre);



document.addEventListener('DOMContentLoaded', (event) => {
    document.getElementById('elevation_temperature').click();
});



async function calculateDeltaTheta(event) {

        // Récupération des valeurs des champs d'entrée
        var courantImpulsionnel = parseFloat(document.getElementById('courant-impulsionnel-elevation').value);
        var coefRepartition = parseFloat(document.getElementById('coef-repartition').value);
        const resistanceOhmique = parseFloat(document.getElementById('resistance-ohmique').value);
        const coefficientTemperature = parseFloat(document.getElementById('coefficient-temperature').value);
        const densiteMateriau = parseFloat(document.getElementById('densite-materiau').value);
        const capaciteThermique = parseFloat(document.getElementById('capacite-thermique').value);
        const temperatureFusion = parseFloat(document.getElementById('temperature-fusion').value);
        var sectionConducteur = parseFloat(document.getElementById('section-conducteur').value);



        if (courantImpulsionnel<=0 || courantImpulsionnel>600 || isNaN(courantImpulsionnel)) {


            courantImpulsionnel=200.00;
            document.getElementById('courant-impulsionnel').value='200.00';

        }

        if (sectionConducteur<=0 || isNaN(sectionConducteur)) {


            sectionConducteur=50.00;
            document.getElementById('section-conducteur').value='50.00';

        }

        if (coefRepartition>1 || coefRepartition<=0 || isNaN(coefRepartition)) {


            coefRepartition=1.00;
            document.getElementById('coef-repartition').value='1.00';

        }


        // Envoie une requête POST au serveur Node.js
        const response = await fetch('/calculateDeltaTheta', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ courantImpulsionnel, coefficientTemperature, resistanceOhmique, coefRepartition,sectionConducteur,densiteMateriau, capaciteThermique})
            });

            // Attend la réponse du serveur
            const result = await response.json();

            // Affiche le résultat dans la page
            //document.getElementById('result').textContent = `La somme est : ${result.sum}`;

            const Energie = result.Energie;

            const deltaTheta = result.deltaTheta;

          // Mise à jour de la valeur de Δθ
        document.getElementById('delta-theta').value = deltaTheta.toFixed(1);

        if (deltaTheta>=temperatureFusion) {

            document.getElementById('delta-theta').style.color = 'red';
            exclamationIcon1.style.display = 'inline'; // Display the exclamation icon
            exclamationIcon1.addEventListener('mouseover', function() {
            tooltip1.style.display = 'block'; // Show the tooltip
            tooltip1.textContent="L'élévation de température obtenue dépasse la température de fusion du conducteur"
            });

            // Hide tooltip message when mouse leaves the exclamation mark
            exclamationIcon1.addEventListener('mouseout', function() {
            tooltip1.style.display = 'none'; // Hide the tooltip
            });
        
        } else {

            //niveau_protection_2.classList.remove('invalid');
            document.getElementById('delta-theta').style.color = 'blue';
            exclamationIcon1.style.display = 'none'; // Hide the exclamation icon


        }
    }


async function  calculateProfondeurFusion(event) {
        // Récupération des valeurs des champs d'entrée
        var courantImpulsionnel = parseFloat(document.getElementById('courant-impulsionnel-profondeur').value);
        const densiteMateriau = parseFloat(document.getElementById('densite-materiau-profondeur').value);
        const capaciteThermique = parseFloat(document.getElementById('capacite-thermique-profondeur').value);
        const chaleurspecifique = parseFloat(document.getElementById('chaleur-specifique-profondeur').value);
        const temperatureFusion = parseFloat(document.getElementById('temperature-fusion-profondeur').value);
        const uac=parseFloat(document.getElementById('chute-tension-profondeur').value);
        var temperatureambiante = parseFloat(document.getElementById('temperature-ambiante-profondeur').value);
        var epaisseurconducteurprofondeur = parseFloat(document.getElementById('epaisseur-conducteur-profondeur').value);

        if (courantImpulsionnel<=0 || courantImpulsionnel>600 || isNaN(courantImpulsionnel)) {

            courantImpulsionnel=200.00;
            document.getElementById('courant-impulsionnel-profondeur').value='200.00';

        }

        if (epaisseurconducteurprofondeur<=0 || isNaN(epaisseurconducteurprofondeur)) {


            epaisseurconducteurprofondeur=2.00;
            document.getElementById('epaisseur-conducteur-profondeur').value='2.00';

        }

        if (temperatureambiante>60 || temperatureambiante<=0 || isNaN(temperatureambiante)) {


            temperatureambiante=25.00;
            document.getElementById('temperature-ambiante-profondeur').value='25.00';

        }

               // Envoie une requête POST au serveur Node.js
               const response = await fetch('/calculateProfondeurFusion', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ courantImpulsionnel,uac,densiteMateriau,capaciteThermique,temperatureFusion, temperatureambiante,chaleurspecifique})
            });

            // Attend la réponse du serveur
            const result = await response.json();

            const profondeurfusion = result.profondeurfusion;

            document.getElementById('profondeur-fusion-conducteur').value = profondeurfusion.toFixed(1);

        if (profondeurfusion>=epaisseurconducteurprofondeur) {

            document.getElementById('profondeur-fusion-conducteur').style.color = 'red';
            exclamationIcon2.style.display = 'inline'; // Display the exclamation icon
            exclamationIcon2.addEventListener('mouseover', function() {
            tooltip2.style.display = 'block'; // Show the tooltip
            tooltip2.textContent="La profondeur de fusion obtenue dépasse l'épaisseur du conducteur"
            });

            // Hide tooltip message when mouse leaves the exclamation mark
            exclamationIcon2.addEventListener('mouseout', function() {
            tooltip2.style.display = 'none'; // Hide the tooltip
            });
        
        } else {

            //niveau_protection_2.classList.remove('invalid');
            document.getElementById('profondeur-fusion-conducteur').style.color = 'blue';
            exclamationIcon2.style.display = 'none'; // Hide the exclamation icon


        }
    }

    async function calculateSectionConducteurs(event) {

        // Récupération des valeurs des champs d'entrée
        let courantImpulsionnel = parseFloat(document.getElementById('courant-impulsionnel-spf').value);
        let coefRepartition = parseFloat(document.getElementById('coef-repartition-spf').value);
        const resistanceOhmique = parseFloat(document.getElementById('resistance-ohmique-spf').value);
        const coefficientTemperature = parseFloat(document.getElementById('coefficient-temperature-spf').value);
        const densiteMateriau = parseFloat(document.getElementById('densite-materiau-spf').value);
        const capaciteThermique = parseFloat(document.getElementById('capacite-thermique-spf').value);
        const temperatureFusion = parseFloat(document.getElementById('temperature-fusion-spf').value);
        let temperatureambiante = parseFloat(document.getElementById('temperature-ambiante-spf').value);

        if (courantImpulsionnel<=0 || courantImpulsionnel>600 || isNaN(courantImpulsionnel)) {


            courantImpulsionnel=200.00;
            document.getElementById('courant-impulsionnel-spf').value='200.00';

        }


        if (coefRepartition>1 || coefRepartition<=0 || isNaN(coefRepartition)) {


            coefRepartition=1.00;
            document.getElementById('coef-repartition-spf').value='1.00';

        }

        if (temperatureambiante>60 || temperatureambiante<=0 || isNaN(temperatureambiante)) {


            temperatureambiante=25.00;
            document.getElementById('temperature-ambiante-spf').value='25.00';

        }


        // Envoie une requête POST au serveur Node.js
        const response = await fetch('/calculateSectionConducteurs', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ courantImpulsionnel,coefficientTemperature,resistanceOhmique,coefRepartition,densiteMateriau,capaciteThermique,temperatureFusion,temperatureambiante})
            });

            // Attend la réponse du serveur
            const result = await response.json();

            let sectionConducteurs = result.sectionConducteurs;
 
        if (sectionConducteurs<50) {

            sectionConducteurs=50.00;
        }


        document.getElementById('section-minimale').value = sectionConducteurs.toFixed(2);

    }

    async function calculateSectionConducteursTerre(event) {
        // Récupération des valeurs des champs d'entrée
        var courantcourtcircuit = parseFloat(document.getElementById('courant-court-circuit').value);
        var dureecourtcircuit = parseFloat(document.getElementById('duree-court-circuit').value);
        const Qc = parseFloat(document.getElementById('Qc').value);
        const Beta = parseFloat(document.getElementById('Beta').value);
        const rho20 = parseFloat(document.getElementById('rho20').value);
        var temperatureinitiale = parseFloat(document.getElementById('temperature-initiale').value);
        var temperaturefinale = parseFloat(document.getElementById('temperature-finale').value);

        const selectedMaterial = document.getElementById('materiau-conducteur-terre').value;
        const properties = materials_13_200[selectedMaterial];
        const temperature_maximale = properties.temperature_finale;
  
        if (courantcourtcircuit<=0 || courantcourtcircuit>100 ||isNaN(courantcourtcircuit)) {

            courantcourtcircuit=12.50;
            document.getElementById('courant-court-circuit').value='12.50';

        }


        if (dureecourtcircuit<=0|| isNaN(dureecourtcircuit)) {

            dureecourtcircuit=1.00;
            document.getElementById('duree-court-circuit').value='1.00';

        }

        if (temperatureinitiale<=0|| temperatureinitiale>60 || isNaN(temperatureinitiale) || temperatureinitiale>=temperaturefinale) {

            temperatureinitiale=30.00;
            document.getElementById('temperature-initiale').value='30.00';

        }

        if (temperaturefinale<=0|| temperaturefinale>temperature_maximale ||isNaN(temperaturefinale) || temperatureinitiale>=temperaturefinale) {

            temperaturefinale=250.00;
            document.getElementById('temperature-finale').value='250.00';

        }

            // Envoie une requête POST au serveur Node.js
            const response = await fetch('/calculateSectionConducteursTerre', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({courantcourtcircuit,dureecourtcircuit,Qc,Beta,rho20,temperatureinitiale,temperaturefinale})
            });

            // Attend la réponse du serveur
            const result = await response.json();

            let sectionConducteurs = result.sectionConducteurs;

        if (sectionConducteurs<50) {

            sectionConducteurs=50.00;
        }

        document.getElementById('section-minimale-terre').value = sectionConducteurs.toFixed(2);
 
    }

    async function calculateSectionConducteursLiaisons(event) {

        // Récupération des valeurs des champs d'entrée
        var courantImpulsionnel = parseFloat(document.getElementById('courant-impulsionnel-liaisons').value);
        var coefRepartition = parseFloat(document.getElementById('coef-repartition-liaisons').value);
        const resistanceOhmique = parseFloat(document.getElementById('resistance-ohmique-liaisons').value);
        const coefficientTemperature = parseFloat(document.getElementById('coefficient-temperature-liaisons').value);
        const densiteMateriau = parseFloat(document.getElementById('densite-materiau-liaisons').value);
        const capaciteThermique = parseFloat(document.getElementById('capacite-thermique-liaisons').value);
        const temperatureFusion = parseFloat(document.getElementById('temperature-fusion-liaisons').value);
        var temperatureambiante = parseFloat(document.getElementById('temperature-ambiante-liaisons').value);

        const selectedMaterial = document.getElementById('materiau-conducteur-liaisons').value;
        const properties = materials[selectedMaterial];
        const section_minimale = properties.section;
        const section_minimale_float = parseFloat(properties.section);

        if (courantImpulsionnel<=0 || courantImpulsionnel>600 || isNaN(courantImpulsionnel)) {

            courantImpulsionnel=200.00;
            document.getElementById('courant-impulsionnel-liaisons').value='200.00';

        }

        if (coefRepartition>1 || coefRepartition<=0 || isNaN(coefRepartition)) {

            coefRepartition=1.00;
            document.getElementById('coef-repartition-liaisons').value='1.00';

        }

        if (temperatureambiante>60 || temperatureambiante<=0 || isNaN(temperatureambiante)) {


            temperatureambiante=25.00;
            document.getElementById('temperature-ambiante-liaisons').value='25.00';

        }

                   // Envoie une requête POST au serveur Node.js
            const response = await fetch('/calculateSectionConducteursLiaisons', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({courantImpulsionnel,coefficientTemperature,resistanceOhmique,coefRepartition,densiteMateriau,capaciteThermique,temperatureFusion,temperatureambiante})
            });

            // Attend la réponse du serveur
            const result = await response.json();

            let sectionConducteurs = result.sectionConducteurs;

     
        if (sectionConducteurs<section_minimale_float) {

            sectionConducteurs=section_minimale_float;

        }

        document.getElementById('section-minimale-liaisons').value = sectionConducteurs.toFixed(2);

 
    }

    document.getElementById('courant-foudre-iimp-in').value = '0.3';

    function updateOptions() {

            const CurrentSelect = document.getElementById('courant-foudre-iimp-in');
            const parafoudreclasse = document.getElementById('classe-parafoudre-calibre').value;
            const currentlabel = document.getElementById('current-label');

            // Clear existing options
            CurrentSelect.innerHTML = '';

            // Get the selected test option
            //const selectedTest = testSelect.value;

            // Define options and label text based on the selected test option
            let options = [];
            let labelText = '';

            if (parafoudreclasse === '1') {
                options = ['0.3','0.3', '0.5','0.7','1.0','1.4','2.2','2.8','3.4','4.2','5.6','7.3','9.6','13','16','19','22','28','35','45','60'];
                labelText = 'Courant impulsionnel de foudre Iimp (10/350) (kA)';

            } else {
                options = ['1.2','1.5','2.1','3.1','4.6','6.4','9.9','12.5','15','19','25','33','42','57','72','83','96','123','157','200','267'];
                labelText = 'Courant nominal de décharge In (8/20) (kA)';

            }


        

            // Update the label text
            currentlabel.textContent = labelText;

            // Populate the result select element with new options
            options.forEach(option => {
                const newOption = document.createElement('option');
                newOption.value = option;
                newOption.textContent = option;
                CurrentSelect.appendChild(newOption);
            });

            calculcalibredeconnecteur();
    }

        // Initialize the result options and label text on page load
        window.onload = updateOptions;


    function  calculcalibredeconnecteur () {

        CurrentSelectindex = document.getElementById('courant-foudre-iimp-in').selectedIndex;

        document.getElementById('calibre-deconnecteur-parafoudre').value=calibre_deconnecteur[CurrentSelectindex+1].d;



    }

    async function calculangleprotection (event) {


        var deletaH=parseFloat(document.getElementById('surelevation-protection').value);
        const niveauprotection=document.getElementById('niveau-protection-option').value;
        var courantImpulsionnel=parseFloat(document.getElementById('courant-impulsionnel-angle-protection').value);

        if (niveauprotection == 'AUTRE') {

            document.getElementById('rayon-sphere-fictive-angle-protection').value = (10*Math.pow(courantImpulsionnel,0.65)).toFixed(0);

        }

        

        var deletaHMax;


        if (courantImpulsionnel<=0 || courantImpulsionnel>600 || isNaN(courantImpulsionnel)) {

            courantImpulsionnel=3.00;
            deletaHMax=20;
            document.getElementById('courant-impulsionnel-angle-protection').value='3';
            document.getElementById('rayon-sphere-fictive-angle-protection').value = '20';

        } 
       
        const Rayonspherefictive=parseFloat(document.getElementById('rayon-sphere-fictive-angle-protection').value);
        deletaHMax = Rayonspherefictive;
       
        if (deletaH<=0 || deletaH>deletaHMax ||isNaN(deletaH)) {


            deletaH=2.0;
            document.getElementById('surelevation-protection').value='2.0';

        }

            // Envoie une requête POST au serveur Node.js
            const response = await fetch('/calculangleprotection', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({Rayonspherefictive,deletaH})
            });

            // Attend la réponse du serveur
            const result = await response.json();
            
            const rayonangleprotection = result.rayonangleprotection;
            const angleprotection = result.angleprotection;

        document.getElementById('rayon-protection-angle-protection').value=rayonangleprotection.toFixed(1);

        document.getElementById('angle-protection').value=angleprotection.toFixed(1);
        

    }


        async function calculspherefictive (event) {


        var deletaH=parseFloat(document.getElementById('surelevation-protection-sf').value);
        var courantImpulsionnel = parseFloat(document.getElementById('courant-impulsionnel-sphere-fictive').value);
        const niveauprotection=document.getElementById('niveau-protection-option-sf').value;
        var deletaHMax;
        var angleprotection;


        if (niveauprotection == 'AUTRE') {

            document.getElementById('rayon-sphere-fictive-sphere-fictive').value = (10*Math.pow(courantImpulsionnel,0.65)).toFixed(0);

        }


        if (courantImpulsionnel<=0 || courantImpulsionnel>600 || isNaN(courantImpulsionnel)) {

            courantImpulsionnel=3.00;
            deletaHMax=20;
            document.getElementById('courant-impulsionnel-sphere-fictive').value='3';
            document.getElementById('rayon-sphere-fictive-sphere-fictive').value = '20';

        } 
       
 
        if (deletaH<=0 || isNaN(deletaH)) {


            deletaH=2.0;
            document.getElementById('surelevation-protection-sf').value='2.0';


        }

        const Rayonspherefictive=parseFloat(document.getElementById('rayon-sphere-fictive-sphere-fictive').value);
        deletaHMax = Rayonspherefictive;

                   // Envoie une requête POST au serveur Node.js
                   const response = await fetch('/calculspherefictive', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({Rayonspherefictive,deletaH})
            });

            // Attend la réponse du serveur
            const result = await response.json();
            const rayonprotectionsf = result.rayonprotectionsf;

            document.getElementById('rayon-protection-sphere-fictive').value=rayonprotectionsf.toFixed(1);
       

    }

        async function calculpda (event) {


        var deletaH=parseFloat(document.getElementById('surelevation-protection-pda').value);
        var deltaT=parseFloat(document.getElementById('deltaT-pda').value);
        var deltaL=deltaT;
        //var rayonprotectionpda;
        var coefficient_icpe=0.6;

        const icpe=document.getElementById('icpe').value;

        if (icpe =='oui') {

            coefficient_icpe=0.6;

        } else {

            coefficient_icpe=1.0;
        
        }
 
        const niveauprotection=document.getElementById('niveau-protection-option-pda').value;


        if (niveauprotection =='1') {

            document.getElementById('rayon-sphere-fictive-pda').value='20';


        }  else if (niveauprotection =='2') {

            document.getElementById('rayon-sphere-fictive-pda').value='30';


        } else if (niveauprotection =='3') {

            document.getElementById('rayon-sphere-fictive-pda').value='45';


        } else if (niveauprotection =='4') {

            document.getElementById('rayon-sphere-fictive-pda').value='60';


        } 

        if (deletaH<=0 ||  isNaN(deletaH)) {


            deletaH=5.0;
            document.getElementById('surelevation-protection-pda').value='5.0';


        }


        if (deltaT<=0 || deltaT>60 || isNaN(deltaT)) {


            deltaT=60.0;
            deltaL=60.0;
            document.getElementById('deltaT-pda').value='60.0';

        }

        if (deltaT<=10.0) {

            deltaL=10.0;
            deltaT=10.0;
            document.getElementById('deltaT-pda').value='10.0';

        }

        const Rayonspherefictive=parseFloat(document.getElementById('rayon-sphere-fictive-pda').value);
        
        //var rayonprotectionpda = Math.sqrt(Math.pow(Rayonspherefictive,2)-Math.pow(deletaH-Rayonspherefictive,2));

        // Envoie une requête POST au serveur Node.js
        const response = await fetch('/calculpda', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({Rayonspherefictive,deletaH,deltaL,coefficient_icpe})
        });

        // Attend la réponse du serveur
        const result = await response.json();
        const rayonprotectionpda = result.rayonprotectionpda;

        document.getElementById('rayon-protection-pda').value=rayonprotectionpda.toFixed(1);

        

    }




    async function calculprofondeurpenetrationsf (event) {

       
        const niveauprotection=document.getElementById('niveau-protection-p').value;
        var courantImpulsionnel = parseFloat(document.getElementById('courant-impulsionnel-p').value);
        var deletaH1=parseFloat(document.getElementById('surelevation-pointe-1').value);
        var deletaH2=parseFloat(document.getElementById('surelevation-pointe-2').value);
        var distance=parseFloat(document.getElementById('distance-pointes-1-2').value);

        var deletaHMax;
        var distanceMax;
        var RayonProtection;
        var p;
        var deltaH12;

        if (niveauprotection == 'AUTRE') {

            document.getElementById('rayon-sphere-fictive-p').value = (10*Math.pow(courantImpulsionnel,0.65)).toFixed(0);

        }

        if (courantImpulsionnel<=0 || courantImpulsionnel>600 || isNaN(courantImpulsionnel)) {

            courantImpulsionnel=3.00;
            deletaHMax=20;
            document.getElementById('courant-impulsionnel-p').value='3';
            document.getElementById('rayon-sphere-fictive-p').value = '20';

        } 

        const Rayonspherefictive=parseFloat(document.getElementById('rayon-sphere-fictive-p').value);
        
        distanceMax = Rayonspherefictive;

        if (deletaH1>=deletaH2) {

            deltaH12=deletaH2;

        } else {

            deltaH12=deletaH1;

        }
        

        if (deletaH1<=0 || isNaN(deletaH1)) {

            deletaH1=2.0;
            document.getElementById('surelevation-pointe-1').value='2.0';

        }

        if (deletaH2<=0 || isNaN(deletaH2)) {

            deletaH2=2.0;
            document.getElementById('surelevation-pointe-2').value='2.0';

        }

        if (distance<=0 || isNaN(distance)) {

            distance=10.0;
            document.getElementById('distance-pointes-1-2').value='10.0';

        }

        if (deletaH1===deletaH2) {

            p=Rayonspherefictive-Math.sqrt(Math.pow(Rayonspherefictive,2)-Math.pow(distance/2,2));

            if (isNaN(p) || p>=deletaH1) {

                p=deletaH1;
                document.getElementById('centre-x0-sphere').value='Plusieurs points';
                document.getElementById('centre-y0-sphere').value=Rayonspherefictive.toFixed(1);
            } else {

                document.getElementById('centre-x0-sphere').value=(distance/2).toFixed(1);
                document.getElementById('centre-y0-sphere').value=(deletaH1-p+Rayonspherefictive).toFixed(1);

            }

        } else {


            // Envoie une requête POST au serveur Node.js
            const response = await fetch('/calculprofondeurpenetrationsf', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({deletaH1,deletaH2,distance,Rayonspherefictive})
            });

            // Attend la réponse du serveur
            const result = await response.json();
            const A = result.A;
            const B = result.B;
            const C= result.C;
            const a= result.a;
            const b= result.b;
            const c= result.c;
            const delta= result.delta;


        if (delta<0) {

            p=deltaH12;
            document.getElementById('centre-x0-sphere').value='Plusieurs points';
            document.getElementById('centre-y0-sphere').value=Rayonspherefictive.toFixed(0);

            
        } else {

            var x0;

            if (deletaH1>deletaH2) {

                x0=x0=(-b+Math.sqrt(delta))/(2*a);

            } else {

                x0=x0=(-b-Math.sqrt(delta))/(2*a);

            }

            const y0=deletaH1+Math.sqrt(Math.pow(Rayonspherefictive,2)-Math.pow(x0,2));
            const y=y0-Math.sqrt(Math.pow(Rayonspherefictive,2));
            document.getElementById('centre-x0-sphere').value=x0.toFixed(1);
            document.getElementById('centre-y0-sphere').value=y0.toFixed(1);

            p=deltaH12-y;

            if (p>=deltaH12) {

                p=deltaH12;

            }

            if (p<0 || (x0<0 || x0>distance)) {  

                p=0.;
            }


        }

        }

        document.getElementById('profondeur-penetration-petitepointe').value=p.toFixed(1);

        if (p===deltaH12) {

            document.getElementById('profondeur-penetration-petitepointe').style.color = 'red';
            exclamationIcon3.style.display = 'inline'; // Display the exclamation icon
            exclamationIcon3.addEventListener('mouseover', function() {
            tooltip3.style.display = 'block'; // Show the tooltip
            tooltip3.textContent="La sphère fictive touche la surface à protéger"
            });

            // Hide tooltip message when mouse leaves the exclamation mark
            exclamationIcon3.addEventListener('mouseout', function() {
            tooltip3.style.display = 'none'; // Hide the tooltip
            });
        
        } else {

            //niveau_protection_2.classList.remove('invalid');
            document.getElementById('profondeur-penetration-petitepointe').style.color = 'blue';
            exclamationIcon3.style.display = 'none'; // Hide the exclamation icon

        }



    }

    var CheminementData={};
    var CheminementCounter=2;



    document.addEventListener('DOMContentLoaded', function() {

        const niveauprotection=document.getElementById('niveau-protection-cheminement').value;
        const dropdownMenuCheminement = document.getElementById('dropdown-menu-cheminement');
        const addCheminementButton = document.getElementById('add-cheminement-btn');
        const selectedCheminement = dropdownMenuCheminement.selectedIndex;
        const impedancepriseterre = parseFloat(document.getElementById('add-cheminement-btn').value);

        const iimp = parseFloat(document.getElementById('courant-total-cheminement').value);


        CheminementData[selectedCheminement] = {
        "ke": "0.50",
        "iimp":"100.00",
        "nc":"1",
        "Z":"10.0",
        "zonename": "Cheminement N° 1"

        }

        document.getElementById('impedance-cheminement').value =CheminementData[selectedCheminement]["Z"];
        document.getElementById('coefficient-repartition').value =CheminementData[selectedCheminement]["ke"];
        document.getElementById('courant-iimp-cheminement-selectionne').value =CheminementData[selectedCheminement]["iimp"];
        document.getElementById('nombre-conducteurs').value =CheminementData[selectedCheminement]["nc"];

        addCheminementButton.addEventListener('click', function() {

        const newCheminement = `Cheminement N° ${CheminementCounter}`;


        const option_cheminement = document.createElement('option');
        option_cheminement.value = newCheminement;
        option_cheminement.textContent = newCheminement;
        dropdownMenuCheminement.appendChild(option_cheminement);
        dropdownMenuCheminement.value= dropdownMenuCheminement.options[dropdownMenuCheminement.options.length - 1].value;

        const selectedCheminement = dropdownMenuCheminement.options.length-1;
   
        CheminementData[selectedCheminement] = {

        "ke": "0.50",
        "iimp":"100.00",
        "nc":"1",
        "Z":"10.0",
        "zonename": ""

        }

        CheminementData[selectedCheminement]["zonename"] = newCheminement;

        updateResults();


        CheminementCounter++;

        });

        dropdownMenuCheminement.addEventListener('change', function() {

            const selectedCheminement = dropdownMenuCheminement.selectedIndex;

            document.getElementById('impedance-cheminement').value =CheminementData[selectedCheminement]["Z"];
            document.getElementById('coefficient-repartition').value =CheminementData[selectedCheminement]["ke"];
            document.getElementById('nombre-conducteurs').value =CheminementData[selectedCheminement]["nc"];
            document.getElementById('courant-iimp-cheminement-selectionne').value =CheminementData[selectedCheminement]["iimp"];

        });



        document.getElementById('impedance-prise-terre').addEventListener('change', function() {

            var zc = parseFloat(document.getElementById('impedance-prise-terre').value);

            if (zc<=0 || isNaN(zc)) {

                zc = 10;
                document.getElementById('impedance-prise-terre').value ='10.0';


            }
            
            updateResults();
        
        
        });

        document.getElementById('impedance-cheminement').addEventListener('change', function() {

            const dropdownMenuCheminement = document.getElementById('dropdown-menu-cheminement');

            const selectedCheminement = dropdownMenuCheminement.selectedIndex;

            var zc = parseFloat(document.getElementById('impedance-cheminement').value);

            if (zc<=0 || isNaN(zc)) {

                zc = 10;
                document.getElementById('impedance-cheminement').value ='10.0';


            }

            CheminementData[selectedCheminement]["Z"] = document.getElementById('impedance-cheminement').value;

                        
            updateResults();
        
        
        });


        document.getElementById('nombre-conducteurs').addEventListener('change', function() {

            const dropdownMenuCheminement = document.getElementById('dropdown-menu-cheminement');

            const selectedCheminement = dropdownMenuCheminement.selectedIndex;

            var nc = parseFloat(document.getElementById('nombre-conducteurs').value);

            if (nc<=0 || isNaN(nc)) {

                nc = 1;
                document.getElementById('nombre-conducteurs').value ='1';


            } else if (!Number.isInteger(nc)) {

                const value = parseFloat(document.getElementById('nombre-conducteurs').value);
                document.getElementById('nombre-conducteurs').value =Math.floor(value);

            }


            CheminementData[selectedCheminement]["nc"] = document.getElementById('nombre-conducteurs').value;
            
            updateResults();
        
        
        });


        document.getElementById('niveau-protection-cheminement').addEventListener('change', function () {

            const niveauprotection=document.getElementById('niveau-protection-cheminement').value;

            if (niveauprotection =='1') {


                document.getElementById('courant-total-cheminement').value = '200';


            }  else if (niveauprotection =='2') {

                document.getElementById('courant-total-cheminement').value = '150';


            } else if (niveauprotection =='3') {

                document.getElementById('courant-total-cheminement').value = '100';


            } else if (niveauprotection =='4') {

                document.getElementById('courant-total-cheminement').value = '100';


            } else {

                document.getElementById('courant-total-cheminement').value = '200';
            }

            if (niveauprotection == 'AUTRE') {

                document.getElementById('courant-total-cheminement').readOnly = false;
                document.getElementById('courant-total-cheminement').className = 'select_field';


            } else {

                document.getElementById('courant-total-cheminement').readOnly = true;
                document.getElementById('courant-total-cheminement').className = 'select_field_o';

            }




            updateResults();




        });


        document.getElementById('courant-total-cheminement').addEventListener('change', function () {

            const courantImpulsionnel = parseFloat(document.getElementById('courant-total-cheminement').value);

            if (courantImpulsionnel <=0 || courantImpulsionnel >600 || isNaN(courantImpulsionnel)) {

                document.getElementById('courant-total-cheminement').value = '200';

            }

            updateResults();


        })



    });

    async function updateResults (event) {

        var admittance =0.;
        const dropdownMenuCheminement = document.getElementById('dropdown-menu-cheminement');
        const iimp = parseFloat(document.getElementById('courant-total-cheminement').value);

        const selectedCheminement = dropdownMenuCheminement.selectedIndex;

        const options = dropdownMenuCheminement.options;  
       
        for (let i = 0; i < options.length; i++) {

            const cheminement = i;
            const admittanceCheminement = 1/parseFloat(CheminementData[cheminement]["Z"]);
            admittance = admittance + admittanceCheminement;

        }

        for (let i = 0; i < options.length; i++) {

            const selectedCheminement = i;
            const nc = CheminementData[selectedCheminement]["nc"];
            const zt = parseFloat(document.getElementById('impedance-prise-terre').value);
            const yt =1/zt;
            const z=CheminementData[selectedCheminement]["Z"];

            // Envoie une requête POST au serveur Node.js
            const response = await fetch('/updateResults', {
            method: 'POST',
            headers: {
            'Content-Type': 'application/json'
            },
            body: JSON.stringify({admittance,yt,iimp,z})
            });

            // Attend la réponse du serveur
            const result = await response.json();
            const impedance = result.impedance;
            const courant = result.courant;

            CheminementData[selectedCheminement]["ke"]=(impedance/z/nc).toFixed(2);
            CheminementData[selectedCheminement]["iimp"]=(courant/nc).toFixed(2);

        }

        const zt = parseFloat(document.getElementById('impedance-prise-terre').value);
        const yt =1/zt;
        const impedance = 1/(admittance+yt);
        const courantz = impedance*iimp/zt;

        document.getElementById('courant-prise-terre').value=courantz.toFixed(2);
        document.getElementById('impedance-cheminement').value =CheminementData[selectedCheminement]["Z"];
        document.getElementById('coefficient-repartition').value =CheminementData[selectedCheminement]["ke"];
        document.getElementById('courant-iimp-cheminement-selectionne').value =CheminementData[selectedCheminement]["iimp"];
        document.getElementById('nombre-conducteurs').value =CheminementData[selectedCheminement]["nc"];

    }

    function removeCheminement() {

        const dropdownMenuCheminement = document.getElementById('dropdown-menu-cheminement');
        const selectedOption = dropdownMenuCheminement.options[dropdownMenuCheminement.selectedIndex];
        var selectedCheminement = dropdownMenuCheminement.selectedIndex;
        const selectedCheminement0 = dropdownMenuCheminement.selectedIndex;

        if (dropdownMenuCheminement.options.length <=1) {

            alert("Opération invalide");

        } else {

     

        dropdownMenuCheminement.remove(dropdownMenuCheminement.selectedIndex);
        CheminementCounter=CheminementCounter-1;

        delete CheminementData[selectedCheminement];

        const newCheminementData = {};
        let newIndex = 0;

        for (let key in CheminementData) {
            newCheminementData[newIndex] = CheminementData[key];
            newIndex++;
        }

        // Replace the old ZPFData with the new reindexed one
        CheminementData = newCheminementData;
            

        //dropdownmenuzpf.selectedIndex = dropdownmenuzpf.options.length-1;

        var newselectedCheminement = selectedCheminement0;

        if (newselectedCheminement>0) {

            newselectedCheminement = selectedCheminement0-1;

        } else {

            newselectedCheminement = selectedCheminement0;
        }

        dropdownMenuCheminement.value = dropdownMenuCheminement.options[newselectedCheminement].value;

        document.getElementById('impedance-cheminement').value =CheminementData[newselectedCheminement]["Z"];
        document.getElementById('coefficient-repartition').value =CheminementData[newselectedCheminement]["ke"];
        document.getElementById('nombre-conducteurs').value =CheminementData[newselectedCheminement]["nc"];
        document.getElementById('courant-iimp-cheminement-selectionne').value =CheminementData[newselectedCheminement]["iimp"];

        updateResults();

        }
      

    }


    function renameCheminement() {

        const dropdownMenuCheminement = document.getElementById('dropdown-menu-cheminement');
        const selectedOption = dropdownMenuCheminement.options[dropdownMenuCheminement.selectedIndex];
        var selectedCheminement = dropdownMenuCheminement.selectedIndex;

        const newName = prompt("Saisir un nouveau nom du cheminement:");

        // Check if a new name was provided and it's not an empty string
        if (newName !== null && newName.trim() !== "") {
            const newNameTrimmed = newName.trim();
            CheminementData[selectedCheminement]["zonename"] = newNameTrimmed;

            selectedOption.text = newNameTrimmed;
          
        }

        updateResults();


    }

        var ConducteurData ={};

        var ConducteurCounter =2;

        document.addEventListener('DOMContentLoaded', function() {

        const niveauprotection=document.getElementById('niveau-protection-force').value;
        const dropdownMenuForce = document.getElementById('dropdown-menu-force');
        const addForceButton = document.getElementById('add-force-btn');
        const selectedConducteur = dropdownMenuForce.selectedIndex;
        //const courantimpusionnelmax = document.getElementById('courant-max-force');

        const impedancepriseterre = parseFloat(document.getElementById('add-cheminement-btn').value);

 
        ConducteurData[selectedConducteur] = {
        "angle_inclinaison": "0.0",
        "distance_fixations":"1.00",
        "X0":"0.0",
        "Y0":"0.0",
        "coefficient_repartition":"0.3",
        "forcelaplacetraction": "0.0",
        "forcelaplacecisaillement": "0.0",
        "zonename":"Conducteur parallèle N° 1"

        }

        document.getElementById('angle-inclinaison-mur').value =ConducteurData[selectedConducteur]["angle_inclinaison"];
        document.getElementById('distance-entre-fixations').value =ConducteurData[selectedConducteur]["distance_fixations"];
        document.getElementById('position-conducteur-x0').value =ConducteurData[selectedConducteur]["X0"];
        document.getElementById('position-conducteur-y0').value =ConducteurData[selectedConducteur]["Y0"];
        document.getElementById('coefficient-repartition-force').value =ConducteurData[selectedConducteur]["coefficient_repartition"];

        addForceButton.addEventListener('click', function() {

        const newConducteur = `Conducteur parallèle N° ${ConducteurCounter}`;


        const option_conducteur = document.createElement('option');
        option_conducteur.value = newConducteur;
        option_conducteur.textContent = newConducteur;
        dropdownMenuForce.appendChild(option_conducteur);
        dropdownMenuForce.value= dropdownMenuForce.options[dropdownMenuForce.options.length - 1].value;
        const selectedConducteur = dropdownMenuForce.options.length-1;
   
        ConducteurData[selectedConducteur] = {

        "angle_inclinaison": "0.0",
        "distance_fixations":"1.00",
        "X0":"0.0",
        "Y0":"0.0",
        "coefficient_repartition":"0.3",
        "forcelaplacetraction": "0.0",
        "forcelaplacecisaillement": "0.0",
        "zonename":""

        }

        ConducteurData[selectedConducteur]["zonename"] = newConducteur;

        updateResultsForce();





        ConducteurCounter++;

        });

        dropdownMenuForce.addEventListener('change', function() {

            const selectedConducteur = dropdownMenuForce.selectedIndex;

            document.getElementById('angle-inclinaison-mur').value =ConducteurData[selectedConducteur]["angle_inclinaison"];
            document.getElementById('distance-entre-fixations').value =ConducteurData[selectedConducteur]["distance_fixations"];
            document.getElementById('position-conducteur-x0').value =ConducteurData[selectedConducteur]["X0"];
            document.getElementById('position-conducteur-y0').value =ConducteurData[selectedConducteur]["Y0"];
            document.getElementById('coefficient-repartition-force').value =ConducteurData[selectedConducteur]["coefficient_repartition"];
            document.getElementById('force-resultante-traction').value =ConducteurData[selectedConducteur]["forcelaplacetraction"];
            document.getElementById('force-resultante-cisaillement').value =ConducteurData[selectedConducteur]["forcelaplacecisaillement"];

        });


        document.getElementById('angle-inclinaison-mur').addEventListener('change', function() {

            const dropdownMenuForce = document.getElementById('dropdown-menu-force');

            const selectedConducteur = dropdownMenuForce.selectedIndex;

            const angleinclinaison = parseFloat(document.getElementById('angle-inclinaison-mur').value);

            if (isNaN(angleinclinaison)) {


                document.getElementById('angle-inclinaison-mur').value ='0.0';


            }

            ConducteurData[selectedConducteur]["angle_inclinaison"] = document.getElementById('angle-inclinaison-mur').value;

            
            updateResultsForce();
        
        
        });


        document.getElementById('distance-entre-fixations').addEventListener('change', function() {

            const dropdownMenuForce = document.getElementById('dropdown-menu-force');

            const selectedConducteur = dropdownMenuForce.selectedIndex;

            const distance_fixations = parseFloat(document.getElementById('distance-entre-fixations').value);

            if (distance_fixations <=0 || isNaN(distance_fixations)) {
                

                document.getElementById('distance-entre-fixations').value ='0.5';


            }

            ConducteurData[selectedConducteur]["distance_fixations"] = document.getElementById('distance-entre-fixations').value;

            
            updateResultsForce();
        
        
        });

        document.getElementById('position-conducteur-x0').addEventListener('change', function() {

            const dropdownMenuForce = document.getElementById('dropdown-menu-force');

            const selectedConducteur = dropdownMenuForce.selectedIndex;

            const position_x0 = parseFloat(document.getElementById('position-conducteur-x0').value);

            if (isNaN(position_x0)) {
                

                document.getElementById('position-conducteur-x0').value ='0.0';


            }

            ConducteurData[selectedConducteur]["X0"] = document.getElementById('position-conducteur-x0').value;

            
            updateResultsForce();
        
        
        });


         document.getElementById('position-conducteur-y0').addEventListener('change', function() {

            const dropdownMenuForce = document.getElementById('dropdown-menu-force');

            const selectedConducteur = dropdownMenuForce.selectedIndex;

            const position_y0 = parseFloat(document.getElementById('position-conducteur-y0').value);

            if (isNaN(position_y0)) {
                

                document.getElementById('position-conducteur-y0').value ='0.0';


            }

            ConducteurData[selectedConducteur]["Y0"] = document.getElementById('position-conducteur-y0').value;

            
            updateResultsForce();
        
        
        });


        document.getElementById('coefficient-repartition-force').addEventListener('change', function() {

            const dropdownMenuForce = document.getElementById('dropdown-menu-force');

            const selectedConducteur = dropdownMenuForce.selectedIndex;

            const coefficient_repartition = parseFloat(document.getElementById('coefficient-repartition-force').value);

            if (coefficient_repartition <=0 || coefficient_repartition >1 || isNaN(coefficient_repartition)) {
                

                document.getElementById('coefficient-repartition-force').value ='0.1';


            }

            ConducteurData[selectedConducteur]["coefficient_repartition"] = document.getElementById('coefficient-repartition-force').value;

            
            updateResultsForce();
        
        
        });
 

        document.getElementById('niveau-protection-force').addEventListener('change', function () {

            const niveauprotection=document.getElementById('niveau-protection-force').value;

            if (niveauprotection =='1') {


                document.getElementById('courant-max-force').value='200.0';


            }  else if (niveauprotection =='2') {

                document.getElementById('courant-max-force').value='150.0';


            } else if (niveauprotection =='3') {

                document.getElementById('courant-max-force').value='100.0';


            } else if (niveauprotection =='4') {

                document.getElementById('courant-max-force').value='100.0';


            } else {
                
                document.getElementById('courant-max-force').value='200.0';

            }

            if (niveauprotection == 'AUTRE') {

            document.getElementById('courant-max-force').readOnly = false;
            document.getElementById('courant-max-force').className = 'select_field';


            } else {

            document.getElementById('courant-max-force').readOnly = true;
            document.getElementById('courant-max-force').className = 'select_field_o';

            }


            updateResultsForce();


        });


        document.getElementById('courant-max-force').addEventListener('change', function () {

           
            const courantImpulsionnel = parseFloat(document.getElementById('courant-max-champ-indirect-zpf1').value);

            if (courantImpulsionnel <=0 || courantImpulsionnel >600 || isNaN(courantImpulsionnel)) {

                document.getElementById('courant-max-force').value = '200';

            }

            updateResultsForce();


        });



    });

    async function updateResultsForce (event) {

        const dropdownMenuForce = document.getElementById('dropdown-menu-force');

        const selectedConducteur = dropdownMenuForce.selectedIndex;

        const options = dropdownMenuForce.options;  

        const courantmax = parseFloat(document.getElementById('courant-max-force').value);
                
        var sommecoefficientrepartition =0.;


        for (let i = 0; i < options.length; i++) {

            

            if (options.length < 2) {

                ConducteurData[selectedConducteur]["forcelaplacecisaillement"]='0.00';
                ConducteurData[selectedConducteur]["forcelaplacetraction"]='0.00';

                continue;
            }

            var forcelaplacetraction = 0.0;
            var forcelaplacecisaillement = 0.0;

            //const selectedConducteuri = dropdownMenuForce.options[i].text;



            

            for (let j = 0; j < options.length; j++) {

                if (j===i) {

                    continue;

                }


                const distancefixationsi=parseFloat(ConducteurData[i]["distance_fixations"]);
                const angleinclinaisoni=(parseFloat(ConducteurData[i]["angle_inclinaison"]))*Math.PI/180;
                const x0i=parseFloat(ConducteurData[i]["X0"]);
                const y0i = parseFloat(ConducteurData[i]["Y0"]);
                const kei = parseFloat(ConducteurData[i]["coefficient_repartition"]);

                //const selectedConducteurj = dropdownMenuForce.options[j].text;


                const x0j=parseFloat(ConducteurData[j]["X0"]);
                const y0j = parseFloat(ConducteurData[j]["Y0"]);
                const kej = parseFloat(ConducteurData[j]["coefficient_repartition"]);

                const distanceij = Math.sqrt(Math.pow(x0j-x0i,2)+Math.pow(y0j-y0i,2));

                if (distanceij ===0) {

                    continue;
                }

                // Envoie une requête POST au serveur Node.js
                const response = await fetch('/updateResultsForce', {
                method: 'POST',
                headers: {
                'Content-Type': 'application/json'
                },
                body: JSON.stringify({courantmax,kei,kej,distancefixationsi,distanceij,y0j,y0i,x0j,x0i,angleinclinaisoni})
                });

                // Attend la réponse du serveur
                const result = await response.json();
                const forcelaplacetraction1 = result.forcelaplacetraction1;
                const forcelaplacecisaillement1 = result.forcelaplacecisaillement1;

                forcelaplacetraction +=forcelaplacetraction1;
                forcelaplacecisaillement += forcelaplacecisaillement1

            }

            ConducteurData[i]["forcelaplacetraction"] = (Math.abs(forcelaplacetraction)).toFixed(2);
            ConducteurData[i]["forcelaplacecisaillement"] = (Math.abs(forcelaplacecisaillement)).toFixed(2);

            sommecoefficientrepartition +=parseFloat(ConducteurData[i]["coefficient_repartition"]);


        }

        if (sommecoefficientrepartition>1) {

            alert("Attention! La somme des courants parcourant les conducteurs créés dépasse le courant maximal retenu. Veuillez revoir les coefficients de répartition saisis.");
        }
       
        document.getElementById('angle-inclinaison-mur').value =ConducteurData[selectedConducteur]["angle_inclinaison"];
        document.getElementById('distance-entre-fixations').value =ConducteurData[selectedConducteur]["distance_fixations"];
        document.getElementById('position-conducteur-x0').value =ConducteurData[selectedConducteur]["X0"];
        document.getElementById('position-conducteur-y0').value =ConducteurData[selectedConducteur]["Y0"];
        document.getElementById('coefficient-repartition-force').value =ConducteurData[selectedConducteur]["coefficient_repartition"];
        document.getElementById('force-resultante-traction').value =ConducteurData[selectedConducteur]["forcelaplacetraction"];
        document.getElementById('force-resultante-cisaillement').value =ConducteurData[selectedConducteur]["forcelaplacecisaillement"];


    }

    function removeConducteur() {

        const dropdownMenuForce = document.getElementById('dropdown-menu-force');
        const selectedOption = dropdownMenuForce.options[dropdownMenuForce.selectedIndex];
        var selectedConducteur = dropdownMenuForce.selectedIndex;
        const selectedConducteur0 = dropdownMenuForce.selectedIndex;

        if (dropdownMenuForce.options.length <= 1) {

            alert("Opération invalide");

        } else {


            dropdownMenuForce.remove(dropdownMenuForce.selectedIndex);
            ConducteurCounter=ConducteurCounter-1;
    
            delete ConducteurData[selectedConducteur];

            const newConducteurData = {};
            let newIndex = 0;

            for (let key in ConducteurData) {
                newConducteurData[newIndex] = ConducteurData[key];
                newIndex++;
            }

            // Replace the old ZPFData with the new reindexed one
            ConducteurData = newConducteurData;

            var newselectedConducteur = selectedConducteur0;

            if (newselectedConducteur>0) {

                newselectedConducteur = selectedConducteur0-1;

            } else {

                newselectedConducteur = selectedConducteur0;
            }

            dropdownMenuForce.value = dropdownMenuForce.options[newselectedConducteur].value;

            document.getElementById('angle-inclinaison-mur').value =ConducteurData[newselectedConducteur]["angle_inclinaison"];
            document.getElementById('distance-entre-fixations').value =ConducteurData[newselectedConducteur]["distance_fixations"];
            document.getElementById('position-conducteur-x0').value =ConducteurData[newselectedConducteur]["X0"];
            document.getElementById('position-conducteur-y0').value =ConducteurData[newselectedConducteur]["Y0"];
            document.getElementById('coefficient-repartition-force').value =ConducteurData[newselectedConducteur]["coefficient_repartition"];
            document.getElementById('force-resultante-traction').value =ConducteurData[newselectedConducteur]["forcelaplacetraction"];
            document.getElementById('force-resultante-cisaillement').value =ConducteurData[newselectedConducteur]["forcelaplacecisaillement"];

            updateResultsForce();

        }
      

    }


    function renameConducteur() {

        const dropdownMenuForce = document.getElementById('dropdown-menu-force');
        const selectedOption = dropdownMenuForce.options[dropdownMenuForce.selectedIndex];
        var selectedConducteur = dropdownMenuForce.selectedIndex;

        const newName = prompt("Saisir un nouveau nom du cheminement:");

        // Check if a new name was provided and it's not an empty string
        if (newName !== null && newName.trim() !== "") {
            const newNameTrimmed = newName.trim();
            ConducteurData[selectedConducteur]["zonename"] = newNameTrimmed;
            selectedOption.text = newNameTrimmed;
          
        }

        updateResultsForce();


    }


    

    var imax = 200.0;

    document.getElementById('niveau-protection-fourrier').addEventListener('change', function () {

        const niveauprotection=document.getElementById('niveau-protection-fourrier').value;
        const typechoc=document.getElementById('type-choc-fourrier').value;

        if (niveauprotection =='1') {

            if (typechoc =='1') {

                imax=200.0;
                document.getElementById('courant-max-fourrier').value='200.0';
                document.getElementById('coefficient-k-fourrier').value='0.93';
                document.getElementById('constante-temps-to1-fourrier').value='19.00';
                document.getElementById('constante-temps-to2-fourrier').value='485.00';



            } else if (typechoc =='2') {

                imax=100.0;
                document.getElementById('courant-max-fourrier').value='100.0';
                document.getElementById('coefficient-k-fourrier').value='0.986';
                document.getElementById('constante-temps-to1-fourrier').value='1.82';
                document.getElementById('constante-temps-to2-fourrier').value='285.00';



            } else if (typechoc =='3') {

                imax=50.0;
                document.getElementById('courant-max-fourrier').value='50.0';
                document.getElementById('coefficient-k-fourrier').value='0.993';
                document.getElementById('constante-temps-to1-fourrier').value='0.454';
                document.getElementById('constante-temps-to2-fourrier').value='143.00';


            }



        }  else if (niveauprotection =='2') {

            if (typechoc =='1') {

                imax=150.0;
                document.getElementById('courant-max-fourrier').value='150.0';
                document.getElementById('coefficient-k-fourrier').value='0.93';
                document.getElementById('constante-temps-to1-fourrier').value='19.00';
                document.getElementById('constante-temps-to2-fourrier').value='485.00';



            } else if (typechoc =='2') {

                imax=75.0;
                document.getElementById('courant-max-fourrier').value='75.0';
                document.getElementById('coefficient-k-fourrier').value='0.986';
                document.getElementById('constante-temps-to1-fourrier').value='1.82';
                document.getElementById('constante-temps-to2-fourrier').value='285.00';



            } else if (typechoc =='3') {

                imax=37.5;
                document.getElementById('courant-max-fourrier').value='37.5';
                document.getElementById('coefficient-k-fourrier').value='0.993';
                document.getElementById('constante-temps-to1-fourrier').value='0.454';
                document.getElementById('constante-temps-to2-fourrier').value='143.00';


            }

        } else if (niveauprotection =='3') {

            if (typechoc =='1') {

                imax=100.0;
                document.getElementById('courant-max-fourrier').value='100.0';
                document.getElementById('coefficient-k-fourrier').value='0.93';
                document.getElementById('constante-temps-to1-fourrier').value='19.00';
                document.getElementById('constante-temps-to2-fourrier').value='485.00';



            } else if (typechoc =='2') {

                imax=50.0;
                document.getElementById('courant-max-fourrier').value='50.0';
                document.getElementById('coefficient-k-fourrier').value='0.986';
                document.getElementById('constante-temps-to1-fourrier').value='1.82';
                document.getElementById('constante-temps-to2-fourrier').value='285.00';



            } else if (typechoc =='3') {

                imax=25.0;
                document.getElementById('courant-max-fourrier').value='25.0';
                document.getElementById('coefficient-k-fourrier').value='0.993';
                document.getElementById('constante-temps-to1-fourrier').value='0.454';
                document.getElementById('constante-temps-to2-fourrier').value='143.00';


            }



        } else if (niveauprotection =='4') {

             if (typechoc =='1') {

                imax=100.0;
                document.getElementById('courant-max-fourrier').value='100.0';
                document.getElementById('coefficient-k-fourrier').value='0.93';
                document.getElementById('constante-temps-to1-fourrier').value='19.00';
                document.getElementById('constante-temps-to2-fourrier').value='485.00';



            } else if (typechoc =='2') {

                imax=50.0;
                document.getElementById('courant-max-fourrier').value='50.0';
                document.getElementById('coefficient-k-fourrier').value='0.986';
                document.getElementById('constante-temps-to1-fourrier').value='1.82';
                document.getElementById('constante-temps-to2-fourrier').value='285.00';



            } else if (typechoc =='3') {

                imax=25.0;
                document.getElementById('courant-max-fourrier').value='25.0';
                document.getElementById('coefficient-k-fourrier').value='0.993';
                document.getElementById('constante-temps-to1-fourrier').value='0.454';
                document.getElementById('constante-temps-to2-fourrier').value='143.00';


            }


        } 

      



        computeFFT();




        });

        document.getElementById('exposant-echantillonnage-fourrier').addEventListener('change', function () {


            var periodeechantilonnage = parseFloat(document.getElementById('exposant-echantillonnage-fourrier').value);

            if (periodeechantilonnage<0 || isNaN(periodeechantilonnage)) {

                document.getElementById('exposant-echantillonnage-fourrier').value = '500.0';

            }
            
            computeFFT ();
        
        });

        document.getElementById('duree-fourrier').addEventListener('change', function () {

            var dureefourrier = parseFloat(document.getElementById('duree-fourrier').value);

            if (dureefourrier<0 || isNaN(dureefourrier)) {

                document.getElementById('duree-fourrier').value = '500.0';

            }
         
            
            
            computeFFT ();
        
        
        });



        document.getElementById('type-choc-fourrier').addEventListener('change', function () {

        const typechoc=document.getElementById('type-choc-fourrier').value;
        const niveauprotection=document.getElementById('niveau-protection-fourrier').value;




        if (typechoc =='1') {

            if (niveauprotection =='1') {


                imax=200.0;
                document.getElementById('courant-max-fourrier').value='200.0';


            }  else if (niveauprotection =='2') {

                imax=150.0;
                document.getElementById('courant-max-fourrier').value='150.0';



            } else if (niveauprotection =='3') {

                imax=100.0;
                document.getElementById('courant-max-fourrier').value='100.0';


            } else if (niveauprotection =='4') {

                imax=100.0;
                document.getElementById('courant-max-fourrier').value='100.0';


            } 

            document.getElementById('coefficient-k-fourrier').value='0.93';
            document.getElementById('constante-temps-to1-fourrier').value='19.00';
            document.getElementById('constante-temps-to2-fourrier').value='485.00';


        }  else if (typechoc =='2') {

            if (niveauprotection =='1') {


                imax=100.0;
                document.getElementById('courant-max-fourrier').value='100.0';


            }  else if (niveauprotection =='2') {

                imax=75.0;
                document.getElementById('courant-max-fourrier').value='75.0';



            } else if (niveauprotection =='3') {

                imax=50.0;
                document.getElementById('courant-max-fourrier').value='50.0';


            } else if (niveauprotection =='4') {

                imax=50.0;
                document.getElementById('courant-max-fourrier').value='50.0';


            } 

            document.getElementById('coefficient-k-fourrier').value='0.986';
            document.getElementById('constante-temps-to1-fourrier').value='1.82';
            document.getElementById('constante-temps-to2-fourrier').value='285.00';


        } else if (typechoc =='3') {

             if (niveauprotection =='1') {


                imax=50.0;
                document.getElementById('courant-max-fourrier').value='50.0';


            }  else if (niveauprotection =='2') {

                imax=37.5;
                document.getElementById('courant-max-fourrier').value='37.5';



            } else if (niveauprotection =='3') {

                imax=25.0;
                document.getElementById('courant-max-fourrier').value='25.0';


            } else if (niveauprotection =='4') {

                imax=25.0;
                document.getElementById('courant-max-fourrier').value='25.0';


            } 

            document.getElementById('coefficient-k-fourrier').value='0.993';
            document.getElementById('constante-temps-to1-fourrier').value='0.454';
            document.getElementById('constante-temps-to2-fourrier').value='143.00';


        } 

      



        computeFFT();




        });


        let signal=[];// = new Array(N).fill(0);
        let time=[];// = new Array(N).fill(0);
        let real=[];// = new Array(N).fill(0);
        let imag=[];// = new Array(N).fill(0);
        let magnitudes=[];// = new Array(N / 2).fill(0);
        let frequencies=[];// = new Array(N / 2).fill(0);
        let phases=[];// = new Array(N / 2).fill(0); // To store phase information


    async function computeFFT(event) {


        var progress=0;

        // Afficher l'animation de sablier
        const loader = document.getElementById('loader');
        const loaderText = document.getElementById('loader-text');
        loader.style.display = 'block';

       // setTimeout(() => {   



        const periode_echantillonnage=parseFloat(document.getElementById('exposant-echantillonnage-fourrier').value)*1E-9; 
        //const exposant_echantillonnage=Math.pow(2,exposant_n); 
        const duree=parseFloat(document.getElementById('duree-fourrier').value)*1E-6; 
        //const f_s = 1/(duree/exposant_echantillonnage);
        const f_s = 1/(periode_echantillonnage);
        var N = Math.floor(f_s * duree);

        if (!Number.isInteger(N/2)) {

            N=N+1;


        }

        //signal=new Array(N).fill(0);
        //time=new Array(N).fill(0);

        
        real = new Array(N).fill(0);
        imag = new Array(N).fill(0);
        magnitudes = new Array(N / 2).fill(0);
        frequencies = new Array(N / 2).fill(0);
        phases = new Array(N / 2).fill(0); // To store phase information
        
        const t_step = 1 / f_s;
        const imax = parseFloat(document.getElementById('courant-max-fourrier').value);
        const tau1 = parseFloat(document.getElementById('constante-temps-to1-fourrier').value);
        const tau2 = parseFloat(document.getElementById('constante-temps-to2-fourrier').value);
        const k = parseFloat(document.getElementById('coefficient-k-fourrier').value);
               
        // Envoie une requête POST au serveur Node.js
        const response = await fetch('/heidlerFunction', {
        method: 'POST',
        headers: {
        'Content-Type': 'application/json'
        },
        body: JSON.stringify({imax, tau1, tau2, k,N,t_step,f_s})
        });

        // Attend la réponse du serveur
        result = await response.json();
        time = result.time;
        signal = result.signal;
        frequencies = result.frequencies;
        magnitudes = result.magnitudes;


        Plotly.newPlot('heidlerPlot', [{
            x: time,
            y: signal,
            mode: 'lines',
            line: { color: 'black' },  // Set the line color to red
            name: 'Heidler Function'
        }], {
            title: 'Onde du courant impulsionnel de foudre (t)',
            xaxis: { title: 'Temps (s)',
            gridwidth: 1,
        gridcolor: '#ccc',
        minor: {
            showgrid: true  // Enable minor grid lines on log scale
        }
            },
            yaxis: { title: 'Courant (A)',
            showgrid: true,  // Force grid lines to be shown
            gridwidth: 1,
            gridcolor: '#ccc',
            minor: {
            showgrid: true  // Enable minor grid lines on log scale
            }
            }
            
        });

        Plotly.newPlot('fftPlot', [{
        x: frequencies,
        y: magnitudes,
        mode: 'lines',
        mode: 'lines',
        line: { color: 'black' },  // Set the line color to red
        name: 'FFT Magnitude'
    }], {
        title: 'FFT (Amplitude versus fréquence)',
        xaxis: {
            title: 'Fréquence (Hz)',
            type: 'log',
            showgrid: true,  // Force grid lines to be shown
            gridwidth: 1,
            gridcolor: '#ccc',
            minor: {
                showgrid: true  // Enable minor grid lines on log scale
            }
        },
        yaxis: {
            title: 'Amplitude',
            type: 'log',
            showgrid: true,  // Force grid lines to be shown
            gridwidth: 1,
            gridcolor: '#ccc',
            minor: {
                showgrid: true  // Enable minor grid lines on log scale
            }
        }
    });


       // Masquer l'animation de sablier après le second tracé
       loader.style.display = 'none';


  
        
    }


    async function calculchampmagnetiquedirectzpf1(event) {

        
        const niveauprotection=document.getElementById('niveau-protection-champ-direct-zpf1').value;
        const typechoc=document.getElementById('type-choc-champ-direct-zpf1').value;
        const reseauequipotentialite=document.getElementById('reseau-equipotentialite-direct').value;
        var sf;

        const dropdownmenuzpf = document.getElementById('dropdown-menu-zpf-direct');

        const selectedzpf = dropdownmenuzpf.selectedIndex;

        const options = dropdownmenuzpf.options;  

        const courant = parseFloat(document.getElementById('courant-max-champ-direct-zpf1').value);

        const kh = 0.01;

        var H1;
        var H0;
        var H3;


        var facteurecran = [];



        for (let i = 0; i < options.length; i++) {

            const zpf = i;
            const typemateriau=ZPFDataDirect[zpf]["Materiau"];
            
            var ds;

            const W=parseFloat(ZPFDataDirect[zpf]["W"]);
            const r0=parseFloat(ZPFDataDirect[zpf]["D0"])/2;

            // Envoie une requête POST au serveur Node.js
            const response = await fetch('/calculchampmagnetiquedirectzpf1', {
            method: 'POST',
            headers: {
            'Content-Type': 'application/json'
            },
            body: JSON.stringify({typechoc,typemateriau,W,r0,reseauequipotentialite})
            });

            // Attend la réponse du serveur
            result = await response.json();
            sf = result.sf;
            sf1 = result.sf1;
            ds = result.ds;

            ZPFDataDirect[zpf]["sf"]=sf.toFixed(2);
            ZPFDataDirect[zpf]["ds"]=ds.toFixed(2);
   
            

            if (i===0) {

                const dw = parseFloat(document.getElementById('distance-point-mur-direct-zpf1').value);
                const dr = parseFloat(document.getElementById('distance-point-toit-direct-zpf1').value);
                H1=kh*courant*1000*W/(dw*Math.sqrt(dr));
                H0=H1*(Math.pow(10,sf1/20));
                H3=H0;

            }   
            
            H1=H0/(Math.pow(10,sf/20));

            H0=H1;

        }

        document.getElementById('champ-magnetrique-avec-ecran-direct-zpf1').value = H1.toFixed(2);

        var facteur_ecran = 20*Math.log10(H3/H1);

        document.getElementById('facteur-global-ecran-direct-zpf1').value = facteur_ecran.toFixed(2);

        document.getElementById('facteur-ecran-direct-zpf1').value =ZPFDataDirect[selectedzpf]["sf"];
        document.getElementById('distance-securite-direct-zpf1').value=ZPFDataDirect[selectedzpf]["ds"];
       

    }


    async function calculchampmagnetiqueindirectzpf1(event) {

        

        const niveauprotection=document.getElementById('niveau-protection-champ-indirect-zpf1').value;
        const typechoc=document.getElementById('type-choc-champ-indirect-zpf1').value;
        const hauteurbatiment=document.getElementById('hauteur-batiment-champ-indirect-zpf1').value;
        const longueurbatiment=document.getElementById('longueur-batiment-champ-indirect-zpf1').value;
        const reseauequipotentialite=document.getElementById('reseau-equipotentialite-indirect').value;
        const courant = parseFloat(document.getElementById('courant-max-champ-indirect-zpf1').value);

        var sf;
 
        const dropdownmenuzpf = document.getElementById('dropdown-menu-zpf');

        const selectedzpf = dropdownmenuzpf.selectedIndex;

        const options = dropdownmenuzpf.options;  

        const rayonspherefictive=10*Math.pow(courant,0.65);
        
        document.getElementById('rayon-sf-indirect-zpf1').value = rayonspherefictive.toFixed(0);

        
        var sa;

        // Envoie une requête POST au serveur Node.js
        const response = await fetch('/calculchampmagnetiqueindirectzpf1sa', {
        method: 'POST',
        headers: {
        'Content-Type': 'application/json'
        },
        body: JSON.stringify({hauteurbatiment,longueurbatiment,rayonspherefictive,courant})
        });

        // Attend la réponse du serveur
        result = await response.json();
        sa = result.sa;
        var H0 = result.H0;
        
        document.getElementById('distance-indirect-zpf1').value = sa.toFixed(0);

        var H3 = H0;

        document.getElementById('champ-magnetrique-sans-ecran-indirect-zpf1').value = H0.toFixed(2);

        var H1;

        var facteurecran = [];

        

        for (let i = 0; i < options.length; i++) {

            const zpf = i;

           
            const typemateriau=ZPFData[zpf]["Materiau"];

            
            
            var ds;

            const W=parseFloat(ZPFData[zpf]["W"]);
           

            const r0=parseFloat(ZPFData[zpf]["D0"])/2;


            // Envoie une requête POST au serveur Node.js
            const response = await fetch('/calculchampmagnetiqueindirectzpf1', {
            method: 'POST',
            headers: {
            'Content-Type': 'application/json'
            },
            body: JSON.stringify({typechoc,typemateriau,W,r0,reseauequipotentialite,H0})
            });

            // Attend la réponse du serveur
            result = await response.json();
            sf = result.sf;
            ds = result.ds;
            H1 = result.H1;

            ZPFData[zpf]["sf"]=sf.toFixed(2);
            ZPFData[zpf]["ds"]=ds.toFixed(2);


            H0=H1;
            

        }

        document.getElementById('champ-magnetrique-avec-ecran-indirect-zpf1').value = H1.toFixed(2);

        var facteur_ecran = 20*Math.log10(H3/H1);

        document.getElementById('facteur-global-ecran-indirect-zpf1').value = facteur_ecran.toFixed(2);


        document.getElementById('facteur-ecran-indirect-zpf1').value =ZPFData[selectedzpf]["sf"];
        document.getElementById('distance-securite-indirect-zpf1').value=ZPFData[selectedzpf]["ds"];



       
 
    }


    //////////////////////ZPF ECRANS//////////////////
    ZPFData={};
    zpfCounter=2;

    document.addEventListener('DOMContentLoaded', function() {

        const addzpfbtn=document.getElementById('add-zpf-btn');
        const dropdownmenuzpf=document.getElementById('dropdown-menu-zpf');
        const selectedzpf=document.getElementById('dropdown-menu-zpf').value;
        const niveauprotection=document.getElementById('niveau-protection-champ-indirect-zpf1').value;
        const typechoc=document.getElementById('type-choc-champ-indirect-zpf1').value;
        const typemateriau=document.getElementById('type-materiau-champ-indirect-zpf1').value;
        const hauteurbatiment=document.getElementById('hauteur-batiment-champ-indirect-zpf1').value;
        const longueurbatiment=document.getElementById('longueur-batiment-champ-indirect-zpf1').value;
        const r0 = parseFloat(document.getElementById('diametre-conducteurs-ecran-batiment-indirect-zpf1').value)/2;
        const W = parseFloat(document.getElementById('taille-mailles-batiment-indirect-zpf1').value);
        const dropdownmenuzpfselectedindex = dropdownmenuzpf.selectedIndex;

        document.getElementById('reseau-equipotentialite-indirect').value = '2'

        var sf;
 
        ZPFData[dropdownmenuzpfselectedindex] = {
        "W": "5.0",
        "D0":"8.0",
        "Materiau":"1",
        "sf":"",
        "ds":"",
        "zonename": "Zone ZPF N° 1"

        }

        calculchampmagnetiqueindirectzpf1();

        document.getElementById('taille-mailles-batiment-indirect-zpf1').value =ZPFData[dropdownmenuzpfselectedindex]["W"];
        document.getElementById('diametre-conducteurs-ecran-batiment-indirect-zpf1').value =ZPFData[dropdownmenuzpfselectedindex]["D0"];
        document.getElementById('type-materiau-champ-indirect-zpf1').value=ZPFData[dropdownmenuzpfselectedindex]["Materiau"];
        document.getElementById('facteur-ecran-indirect-zpf1').value =ZPFData[dropdownmenuzpfselectedindex]["sf"];
        document.getElementById('distance-securite-indirect-zpf1').value=ZPFData[dropdownmenuzpfselectedindex]["ds"];


        addzpfbtn.addEventListener('click', function() {

        const newzpf = `Zone ZPF N° ${zpfCounter}`;
        const option_zpf = document.createElement('option');
        option_zpf.value = newzpf;
        option_zpf.textContent = newzpf;
        dropdownmenuzpf.appendChild(option_zpf);
        option_zpf.value=newzpf;

        dropdownmenuzpf.value= dropdownmenuzpf.options[dropdownmenuzpf.options.length - 1].value;

        const dropdownmenuzpfselectedindex = dropdownmenuzpf.options.length-1;
   
        ZPFData[dropdownmenuzpfselectedindex] = {

        "W": "1.0",
        "D0":"8.0",
        "Materiau":"1",
        "sf":"",
        "ds":"",
        "zonename": "Zone ZPF N° 1"

        }

        ZPFData[dropdownmenuzpfselectedindex]["zonename"] = `Zone ZPF N° ${zpfCounter}`;

        calculchampmagnetiqueindirectzpf1();

        document.getElementById('taille-mailles-batiment-indirect-zpf1').value =ZPFData[dropdownmenuzpfselectedindex]["W"];
        document.getElementById('diametre-conducteurs-ecran-batiment-indirect-zpf1').value =ZPFData[dropdownmenuzpfselectedindex]["D0"];
        document.getElementById('type-materiau-champ-indirect-zpf1').value=ZPFData[dropdownmenuzpfselectedindex]["Materiau"];
        document.getElementById('facteur-ecran-indirect-zpf1').value =ZPFData[dropdownmenuzpfselectedindex]["sf"];
        document.getElementById('distance-securite-indirect-zpf1').value=ZPFData[dropdownmenuzpfselectedindex]["ds"];

        


        


        zpfCounter++;

        });

        dropdownmenuzpf.addEventListener('change', function() {

            const selectedzpf = dropdownmenuzpf.selectedIndex;
            document.getElementById('taille-mailles-batiment-indirect-zpf1').value =ZPFData[selectedzpf]["W"];
            document.getElementById('diametre-conducteurs-ecran-batiment-indirect-zpf1').value =ZPFData[selectedzpf]["D0"];
            document.getElementById('type-materiau-champ-indirect-zpf1').value=ZPFData[selectedzpf]["Materiau"];
            document.getElementById('facteur-ecran-indirect-zpf1').value =ZPFData[selectedzpf]["sf"];
            document.getElementById('distance-securite-indirect-zpf1').value=ZPFData[selectedzpf]["ds"];

            calculchampmagnetiqueindirectzpf1()

        });



        document.getElementById('taille-mailles-batiment-indirect-zpf1').addEventListener('change', function() {

            const selectedzpf = dropdownmenuzpf.selectedIndex;

            //document.getElementById('taille-mailles-batiment-indirect-zpf1').value =ZPFData[selectedzpf]["W"];
            //document.getElementById('diametre-conducteurs-ecran-batiment-indirect-zpf1').value =ZPFData[selectedzpf]["D0"];
            //document.getElementById('type-materiau-champ-indirect-zpf1').value=ZPFData[selectedzpf]["Materiau"];

            var w = parseFloat(document.getElementById('taille-mailles-batiment-indirect-zpf1').value);

            if (w<=0 || isNaN(w)) {

                document.getElementById('taille-mailles-batiment-indirect-zpf1').value ='5.0';

            }

            ZPFData[selectedzpf]["W"]=document.getElementById('taille-mailles-batiment-indirect-zpf1').value;
            
            calculchampmagnetiqueindirectzpf1();

                    
        
        });

        document.getElementById('diametre-conducteurs-ecran-batiment-indirect-zpf1').addEventListener('change', function() {

            const selectedzpf = dropdownmenuzpf.selectedIndex;

            var r0 = parseFloat(document.getElementById('diametre-conducteurs-ecran-batiment-indirect-zpf1').value);

            if (r0<=0 || isNaN(r0)) {

                document.getElementById('diametre-conducteurs-ecran-batiment-indirect-zpf1').value ='8.0';

            }

            ZPFData[selectedzpf]["D0"]=document.getElementById('diametre-conducteurs-ecran-batiment-indirect-zpf1').value;


            
            calculchampmagnetiqueindirectzpf1()
        
        
        });

        document.getElementById('type-materiau-champ-indirect-zpf1').addEventListener('change', function() {

            const selectedzpf = dropdownmenuzpf.selectedIndex;

            ZPFData[selectedzpf]["Materiau"]=document.getElementById('type-materiau-champ-indirect-zpf1').value;

            
            calculchampmagnetiqueindirectzpf1();
        
        
        });


        document.getElementById('niveau-protection-champ-indirect-zpf1').addEventListener('change', function () {

            const niveauprotection = document.getElementById('niveau-protection-champ-indirect-zpf1').value;
            const typechoc = document.getElementById('type-choc-champ-indirect-zpf1').value;
           

        if (niveauprotection =='1' || niveauprotection =='AUTRE') {

            if (typechoc =='1') {

                document.getElementById('courant-max-champ-indirect-zpf1').value='200.0';
             


            } else if (typechoc =='2') {

                document.getElementById('courant-max-champ-indirect-zpf1').value='100.0';


            } else if (typechoc =='3') {

                document.getElementById('courant-max-champ-indirect-zpf1').value='50.0';



            }

 
        }  else if (niveauprotection =='2') {

            if (typechoc =='1') {

                document.getElementById('courant-max-champ-indirect-zpf1').value='150.0';


            } else if (typechoc =='2') {


                document.getElementById('courant-max-champ-indirect-zpf1').value='75.0';


            } else if (typechoc =='3') {


                document.getElementById('courant-max-champ-indirect-zpf1').value='37.5';

            }


        } else if (niveauprotection =='3') {

            if (typechoc =='1') {

                document.getElementById('courant-max-champ-indirect-zpf1').value='100.0';


            } else if (typechoc =='2') {


                document.getElementById('courant-max-champ-indirect-zpf1').value='50.0';


            } else if (typechoc =='3') {

                document.getElementById('courant-max-champ-indirect-zpf1').value='25.0';

            }




        } else if (niveauprotection =='4') {

             if (typechoc =='1') {

                document.getElementById('courant-max-champ-indirect-zpf1').value='100.0';


            } else if (typechoc =='2') {

                document.getElementById('courant-max-champ-indirect-zpf1').value='50.0';


            } else if (typechoc =='3') {


                document.getElementById('courant-max-champ-indirect-zpf1').value='25.0';

            }


        } 

        if (niveauprotection == 'AUTRE') {

            document.getElementById('courant-max-champ-indirect-zpf1').readOnly = false;
            document.getElementById('courant-max-champ-indirect-zpf1').className = 'select_field';


        } else {

            document.getElementById('courant-max-champ-indirect-zpf1').readOnly = true;
            document.getElementById('courant-max-champ-indirect-zpf1').className = 'select_field_o';

        }


            
            
            calculchampmagnetiqueindirectzpf1();
        
        
        });

        document.getElementById('type-choc-champ-indirect-zpf1').addEventListener('change', function () {

        const niveauprotection = document.getElementById('niveau-protection-champ-indirect-zpf1').value;
        const typechoc = document.getElementById('type-choc-champ-indirect-zpf1').value;
        
        if (typechoc =='1') {

            if (niveauprotection =='1' || niveauprotection =='AUTRE') {

                document.getElementById('courant-max-champ-indirect-zpf1').value='200.0';


            }  else if (niveauprotection =='2') {

                document.getElementById('courant-max-champ-indirect-zpf1').value='150.0';


            } else if (niveauprotection =='3') {

                document.getElementById('courant-max-champ-indirect-zpf1').value='100.0';


            } else if (niveauprotection =='4') {

                document.getElementById('courant-max-champ-indirect-zpf1').value='100.0';


            } 


        }  else if (typechoc =='2') {

            if (niveauprotection =='1') {

                document.getElementById('courant-max-champ-indirect-zpf1').value='100.0';


            }  else if (niveauprotection =='2') {

                document.getElementById('courant-max-champ-indirect-zpf1').value='75.0';



            } else if (niveauprotection =='3') {

                document.getElementById('courant-max-champ-indirect-zpf1').value='50.0';


            } else if (niveauprotection =='4') {

                document.getElementById('courant-max-champ-indirect-zpf1').value='50.0';


            } else {

                document.getElementById('courant-max-champ-indirect-zpf1').value='100.0';

            }


        } else if (typechoc =='3') {

             if (niveauprotection =='1') {

                document.getElementById('courant-max-champ-indirect-zpf1').value='50.0';


            }  else if (niveauprotection =='2') {

                document.getElementById('courant-max-champ-indirect-zpf1').value='37.5';


            } else if (niveauprotection =='3') {

                document.getElementById('courant-max-champ-indirect-zpf1').value='25.0';


            } else if (niveauprotection =='4') {

                document.getElementById('courant-max-champ-indirect-zpf1').value='25.0';


            } else {

                document.getElementById('courant-max-champ-indirect-zpf1').value='50.0';

            }


        } 
        
      
            calculchampmagnetiqueindirectzpf1 ();
        
        });


        document.getElementById('courant-max-champ-indirect-zpf1').addEventListener('change', function() {
            
            const courantImpulsionnel = parseFloat(document.getElementById('courant-max-champ-indirect-zpf1').value);

            if (courantImpulsionnel <=0 || courantImpulsionnel >600 || isNaN(courantImpulsionnel)) {

                document.getElementById('courant-max-champ-indirect-zpf1').value = '200';

            }
            
            calculchampmagnetiqueindirectzpf1 ();


        });

        document.getElementById('hauteur-batiment-champ-indirect-zpf1').addEventListener('change', function () {

            const h=document.getElementById('hauteur-batiment-champ-indirect-zpf1').value;

            if (h<=1 || isNaN(h)) {

                document.getElementById('hauteur-batiment-champ-indirect-zpf1').value ='10.0';

            }

            calculchampmagnetiqueindirectzpf1 ();

        });

        document.getElementById('longueur-batiment-champ-indirect-zpf1').addEventListener('change', function () {

            const l=document.getElementById('longueur-batiment-champ-indirect-zpf1').value;

            if (l<=1 || isNaN(l)) {

                document.getElementById('longueur-batiment-champ-indirect-zpf1').value ='10.0';

            }

            calculchampmagnetiqueindirectzpf1 ();
        
        });

        document.getElementById('reseau-equipotentialite-indirect').addEventListener('change', calculchampmagnetiqueindirectzpf1);


    });


    function removeZPF() {

        const dropdownmenuzpf = document.getElementById('dropdown-menu-zpf');
        const selectedOption = dropdownmenuzpf.options[dropdownmenuzpf.selectedIndex];
        var selectedzpf = dropdownmenuzpf.selectedIndex;
        const selectedzpf0 = selectedzpf;

        if (dropdownmenuzpf.options.length <= 1) {

            alert("Opération invalide");
            
        } else {


        dropdownmenuzpf.remove(dropdownmenuzpf.selectedIndex);
        zpfCounter=zpfCounter-1;
 
        delete ZPFData[selectedzpf];

        const newZPFData = {};
        let newIndex = 0;

        for (let key in ZPFData) {
            newZPFData[newIndex] = ZPFData[key];
            newIndex++;
        }

        // Replace the old ZPFData with the new reindexed one
        ZPFData = newZPFData;
            

        //dropdownmenuzpf.selectedIndex = dropdownmenuzpf.options.length-1;

        var newselectedzpf = selectedzpf0;

        if (newselectedzpf>0) {

            newselectedzpf = selectedzpf0-1;

        } else {

            newselectedzpf = selectedzpf0;
        }

        dropdownmenuzpf.value = dropdownmenuzpf.options[newselectedzpf].value;

        document.getElementById('taille-mailles-batiment-indirect-zpf1').value =ZPFData[newselectedzpf]["W"];
        document.getElementById('diametre-conducteurs-ecran-batiment-indirect-zpf1').value =ZPFData[newselectedzpf]["D0"];
        document.getElementById('type-materiau-champ-indirect-zpf1').value=ZPFData[newselectedzpf]["Materiau"];
        document.getElementById('facteur-ecran-indirect-zpf1').value =ZPFData[newselectedzpf]["sf"];
        document.getElementById('distance-securite-indirect-zpf1').value=ZPFData[newselectedzpf]["ds"];

        calculchampmagnetiqueindirectzpf1();

        }
      

    }


    function renameZPF() {

        const dropdownmenuzpf = document.getElementById('dropdown-menu-zpf');
        const selectedOption = dropdownmenuzpf.options[dropdownmenuzpf.selectedIndex];
        var selectedzpf = dropdownmenuzpf.selectedIndex;

        const newName = prompt("Saisir un nouveau nom du cheminement:");

        // Check if a new name was provided and it's not an empty string
        if (newName !== null && newName.trim() !== "") {
            const newNameTrimmed = newName.trim();
            ZPFData[selectedzpf]["zonename"] = newNameTrimmed;

            selectedOption.text = newNameTrimmed;
          
        }

        calculchampmagnetiqueindirectzpf1();


    }


       //////////////////////ZPF ECRANS//////////////////
       ZPFDataDirect = {};
    zpfdirectCounter=2;

    document.addEventListener('DOMContentLoaded', function() {

        const addzpfbtn=document.getElementById('add-zpf-direct-btn');
        const dropdownmenuzpf=document.getElementById('dropdown-menu-zpf-direct');
        const selectedzpf=document.getElementById('dropdown-menu-zpf-direct').selectedIndex;
        const niveauprotection=document.getElementById('niveau-protection-champ-direct-zpf1').value;
        const typechoc=document.getElementById('type-choc-champ-direct-zpf1').value;
        const typemateriau=document.getElementById('type-materiau-champ-direct-zpf1').value;
        const r0 = parseFloat(document.getElementById('diametre-conducteurs-ecran-batiment-direct-zpf1').value)/2;
        const W = parseFloat(document.getElementById('taille-mailles-batiment-direct-zpf1').value);
        document.getElementById('reseau-equipotentialite-direct').value = '2'

        var sf;
       

        ZPFDataDirect[selectedzpf] = {
        "W": "5.0",
        "D0":"8.0",
        "Materiau":"1",
        "sf":"",
        "ds":"",
        "zonename": "Zone ZPF N° 1"

        }

        calculchampmagnetiquedirectzpf1();

        document.getElementById('taille-mailles-batiment-direct-zpf1').value =ZPFDataDirect[selectedzpf]["W"];
        document.getElementById('diametre-conducteurs-ecran-batiment-direct-zpf1').value =ZPFDataDirect[selectedzpf]["D0"];
        document.getElementById('type-materiau-champ-direct-zpf1').value=ZPFDataDirect[selectedzpf]["Materiau"];
        document.getElementById('facteur-ecran-direct-zpf1').value =ZPFDataDirect[selectedzpf]["sf"];
        document.getElementById('distance-securite-direct-zpf1').value=ZPFDataDirect[selectedzpf]["ds"];


        addzpfbtn.addEventListener('click', function() {

        const newzpf = `Zone ZPF N° ${zpfdirectCounter}`;
        const option_zpf = document.createElement('option');
        option_zpf.value = newzpf;
        option_zpf.textContent = newzpf;
        dropdownmenuzpf.appendChild(option_zpf);
        option_zpf.value=newzpf;

        dropdownmenuzpf.value= dropdownmenuzpf.options[dropdownmenuzpf.options.length - 1].value;

        const selectedzone = dropdownmenuzpf.options.length-1;
   
        ZPFDataDirect[selectedzone] = {

        "W": "1.0",
        "D0":"8.0",
        "Materiau":"1",
        "sf":"",
        "ds":"",
        "zonename": ""

        }

        ZPFDataDirect[selectedzone]["zonename"] = `Zone ZPF N° ${zpfdirectCounter}`;


        calculchampmagnetiquedirectzpf1();

        document.getElementById('taille-mailles-batiment-direct-zpf1').value =ZPFDataDirect[selectedzone]["W"];
        document.getElementById('diametre-conducteurs-ecran-batiment-direct-zpf1').value =ZPFDataDirect[selectedzone]["D0"];
        document.getElementById('type-materiau-champ-direct-zpf1').value=ZPFDataDirect[selectedzone]["Materiau"];
        document.getElementById('facteur-ecran-direct-zpf1').value =ZPFDataDirect[selectedzone]["sf"];
        document.getElementById('distance-securite-direct-zpf1').value=ZPFDataDirect[selectedzone]["ds"];


        zpfdirectCounter++;

        });

        dropdownmenuzpf.addEventListener('change', function() {

            const selectedzpf = dropdownmenuzpf.selectedIndex;
            document.getElementById('taille-mailles-batiment-direct-zpf1').value =ZPFDataDirect[selectedzpf]["W"];
            document.getElementById('diametre-conducteurs-ecran-batiment-direct-zpf1').value =ZPFDataDirect[selectedzpf]["D0"];
            document.getElementById('type-materiau-champ-direct-zpf1').value=ZPFDataDirect[selectedzpf]["Materiau"];
            document.getElementById('facteur-ecran-direct-zpf1').value =ZPFDataDirect[selectedzpf]["sf"];
            document.getElementById('distance-securite-direct-zpf1').value=ZPFDataDirect[selectedzpf]["ds"];

            calculchampmagnetiquedirectzpf1()

        });



        document.getElementById('taille-mailles-batiment-direct-zpf1').addEventListener('change', function() {

            const selectedzpf = dropdownmenuzpf.selectedIndex;


            var w = parseFloat(document.getElementById('taille-mailles-batiment-indirect-zpf1').value);

            if (w<=0 || isNaN(w)) {

                document.getElementById('taille-mailles-batiment-direct-zpf1').value ='5.0';

            }

            ZPFDataDirect[selectedzpf]["W"]=document.getElementById('taille-mailles-batiment-direct-zpf1').value;
            
            calculchampmagnetiquedirectzpf1();

                    
        
        });


        document.getElementById('distance-point-mur-direct-zpf1').addEventListener('change', function() {

            const selectedzpf = dropdownmenuzpf.selectedIndex;

            var dw = parseFloat(document.getElementById('distance-point-mur-direct-zpf1').value);

            if (dw<=0 || isNaN(dw)) {

                document.getElementById('distance-point-mur-direct-zpf1').value ='10.0';

            }
            
            calculchampmagnetiquedirectzpf1()
        
        
        });


        document.getElementById('distance-point-toit-direct-zpf1').addEventListener('change', function() {

            const selectedzpf = dropdownmenuzpf.selectedIndex;

            var dr = parseFloat(document.getElementById('distance-point-toit-direct-zpf1').value);

            if (dr<=0 || isNaN(dr)) {

                document.getElementById('distance-point-toit-direct-zpf1').value ='10.0';

            }
            
            calculchampmagnetiquedirectzpf1()
        
        
        });



        document.getElementById('diametre-conducteurs-ecran-batiment-direct-zpf1').addEventListener('change', function() {

            const selectedzpf = dropdownmenuzpf.selectedIndex;

            var r0 = parseFloat(document.getElementById('diametre-conducteurs-ecran-batiment-direct-zpf1').value);

            if (r0<=0 || isNaN(r0)) {

                document.getElementById('diametre-conducteurs-ecran-batiment-direct-zpf1').value ='8.0';

            }

            ZPFDataDirect[selectedzpf]["D0"]=document.getElementById('diametre-conducteurs-ecran-batiment-direct-zpf1').value;


            
            calculchampmagnetiquedirectzpf1()
        
        
        });

        document.getElementById('type-materiau-champ-direct-zpf1').addEventListener('change', function() {

            const selectedzpf = dropdownmenuzpf.selectedIndex;

            ZPFDataDirect[selectedzpf]["Materiau"]=document.getElementById('type-materiau-champ-direct-zpf1').value;

            
            calculchampmagnetiquedirectzpf1();
        
        
        });



        document.getElementById('niveau-protection-champ-direct-zpf1').addEventListener('change', function () {

            const niveauprotection = document.getElementById('niveau-protection-champ-direct-zpf1').value;
            const typechoc = document.getElementById('type-choc-champ-direct-zpf1').value;
           

        if (niveauprotection =='1' || niveauprotection =='AUTRE') {

            if (typechoc =='1') {

                document.getElementById('courant-max-champ-direct-zpf1').value='200.0';
             


            } else if (typechoc =='2') {

                document.getElementById('courant-max-champ-direct-zpf1').value='100.0';


            } else if (typechoc =='3') {

                document.getElementById('courant-max-champ-direct-zpf1').value='50.0';



            }

 
        }  else if (niveauprotection =='2') {

            if (typechoc =='1') {

                document.getElementById('courant-max-champ-direct-zpf1').value='150.0';


            } else if (typechoc =='2') {


                document.getElementById('courant-max-champ-direct-zpf1').value='75.0';


            } else if (typechoc =='3') {


                document.getElementById('courant-max-champ-direct-zpf1').value='37.5';

            }


        } else if (niveauprotection =='3') {

            if (typechoc =='1') {

                document.getElementById('courant-max-champ-direct-zpf1').value='100.0';


            } else if (typechoc =='2') {


                document.getElementById('courant-max-champ-direct-zpf1').value='50.0';


            } else if (typechoc =='3') {

                document.getElementById('courant-max-champ-direct-zpf1').value='25.0';

            }




        } else if (niveauprotection =='4') {

             if (typechoc =='1') {

                document.getElementById('courant-max-champ-direct-zpf1').value='100.0';


            } else if (typechoc =='2') {

                document.getElementById('courant-max-champ-direct-zpf1').value='50.0';


            } else if (typechoc =='3') {


                document.getElementById('courant-max-champ-direct-zpf1').value='25.0';

            }


        } 

        if (niveauprotection == 'AUTRE') {

            document.getElementById('courant-max-champ-direct-zpf1').readOnly = false;
            document.getElementById('courant-max-champ-direct-zpf1').className = 'select_field';


        } else {

            document.getElementById('courant-max-champ-direct-zpf1').readOnly = true;
            document.getElementById('courant-max-champ-direct-zpf1').className = 'select_field_o';

        }


            
            
            calculchampmagnetiquedirectzpf1();
        
        
        });

        document.getElementById('type-choc-champ-direct-zpf1').addEventListener('change', function () {

        const niveauprotection = document.getElementById('niveau-protection-champ-direct-zpf1').value;
        const typechoc = document.getElementById('type-choc-champ-direct-zpf1').value;
        
        if (typechoc =='1') {

            if (niveauprotection =='1' || niveauprotection =='AUTRE') {

                document.getElementById('courant-max-champ-direct-zpf1').value='200.0';


            }  else if (niveauprotection =='2') {

                document.getElementById('courant-max-champ-direct-zpf1').value='150.0';


            } else if (niveauprotection =='3') {

                document.getElementById('courant-max-champ-direct-zpf1').value='100.0';


            } else if (niveauprotection =='4') {

                document.getElementById('courant-max-champ-direct-zpf1').value='100.0';


            } 


        }  else if (typechoc =='2') {

            if (niveauprotection =='1') {

                document.getElementById('courant-max-champ-direct-zpf1').value='100.0';


            }  else if (niveauprotection =='2') {

                document.getElementById('courant-max-champ-direct-zpf1').value='75.0';



            } else if (niveauprotection =='3') {

                document.getElementById('courant-max-champ-direct-zpf1').value='50.0';


            } else if (niveauprotection =='4') {

                document.getElementById('courant-max-champ-direct-zpf1').value='50.0';


            } else {

                document.getElementById('courant-max-champ-direct-zpf1').value='100.0';

            }


        } else if (typechoc =='3') {

             if (niveauprotection =='1') {

                document.getElementById('courant-max-champ-direct-zpf1').value='50.0';


            }  else if (niveauprotection =='2') {

                document.getElementById('courant-max-champ-direct-zpf1').value='37.5';


            } else if (niveauprotection =='3') {

                document.getElementById('courant-max-champ-direct-zpf1').value='25.0';


            } else if (niveauprotection =='4') {

                document.getElementById('courant-max-champ-direct-zpf1').value='25.0';


            } else {

                document.getElementById('courant-max-champ-direct-zpf1').value='50.0';

            }


        } 
        
      
            calculchampmagnetiquedirectzpf1 ();
        
        });

        document.getElementById('reseau-equipotentialite-direct').addEventListener('change', calculchampmagnetiquedirectzpf1);

        document.getElementById('courant-max-champ-direct-zpf1').addEventListener('change', function() {
            
            const courantImpulsionnel = parseFloat(document.getElementById('courant-max-champ-direct-zpf1').value);

            if (courantImpulsionnel <=0 || courantImpulsionnel >600 || isNaN(courantImpulsionnel)) {

                document.getElementById('courant-max-champ-direct-zpf1').value = '200';

            }
            
            calculchampmagnetiquedirectzpf1 ();


        });

        




    });



    function removeZPFDIRECT() {

        const dropdownmenuzpf = document.getElementById('dropdown-menu-zpf-direct');
        const selectedOption = dropdownmenuzpf.options[dropdownmenuzpf.selectedIndex];
        var selectedzpf = dropdownmenuzpf.selectedIndex;
        const selectedzpf0 = selectedzpf;

        if (dropdownmenuzpf.options.length <= 1) {

            alert("Opération invalide");

        } else {

            dropdownmenuzpf.remove(dropdownmenuzpf.selectedIndex);
            zpfdirectCounter=zpfdirectCounter-1;
 
            delete ZPFDataDirect[selectedzpf];

            // Reindex ZPFData so the keys are sequential
            const newZPFDataDirect = {};
            let newIndex = 0;

            for (let key in ZPFDataDirect) {
                newZPFDataDirect[newIndex] = ZPFDataDirect[key];
                newIndex++;
            }

            // Replace the old ZPFData with the new reindexed one
            ZPFDataDirect = newZPFDataDirect;

            var newselectedzpf = selectedzpf0;

            if (newselectedzpf>0) {

                newselectedzpf = selectedzpf0-1;

            } else {

                newselectedzpf = selectedzpf0;
            }
            dropdownmenuzpf.value = dropdownmenuzpf.options[newselectedzpf].value;

            document.getElementById('taille-mailles-batiment-direct-zpf1').value =ZPFDataDirect[newselectedzpf]["W"];
            document.getElementById('diametre-conducteurs-ecran-batiment-direct-zpf1').value =ZPFDataDirect[newselectedzpf]["D0"];
            document.getElementById('type-materiau-champ-direct-zpf1').value=ZPFDataDirect[newselectedzpf]["Materiau"];
            document.getElementById('facteur-ecran-direct-zpf1').value =ZPFDataDirect[newselectedzpf]["sf"];
            document.getElementById('distance-securite-direct-zpf1').value=ZPFDataDirect[newselectedzpf]["ds"];

            calculchampmagnetiquedirectzpf1();

        }
      

    }


    function renameZPFDIRECT() {

        const dropdownmenuzpf = document.getElementById('dropdown-menu-zpf-direct');
        const selectedOption = dropdownmenuzpf.options[dropdownmenuzpf.selectedIndex];
        var selectedzpf = dropdownmenuzpf.selectedIndex;

        const newName = prompt("Saisir un nouveau nom du cheminement:");

        // Check if a new name was provided and it's not an empty string
        if (newName !== null && newName.trim() !== "") {
            const newNameTrimmed = newName.trim();
            ZPFDataDirect[selectedzpf]["zonename"] = newNameTrimmed;

            selectedOption.text = newNameTrimmed;
          
        }

        calculchampmagnetiquedirectzpf1();


    }

    /////////////////////////////CALCULS KTA2206////////////////////////////////////////


    async function calcultensionaxialeul() {

        const courantmax = parseFloat(document.getElementById('courant-max-kta2206').value);
        const resistivitesol = parseFloat(document.getElementById('resistivite-sol-kta2206').value);
        const typechoc = document.getElementById('type-choc-foudre-kta2206').value;
        const impedancecouplage = parseFloat(document.getElementById('impedance-couplage-kta2206').value);

        const dropdownmenubusekta2206 = document.getElementById('dropdown-menu-buse-kta2206');
        const selectedgalerie = dropdownmenubusekta2206.selectedIndex;
        const options_galeries = dropdownmenubusekta2206.options; 

        const dropdownmenuconducteurkta2206 = document.getElementById('dropdown-menu-conducteur-kta2206');
        const selectedconducteur = dropdownmenuconducteurkta2206.selectedIndex;
        const options_conducteur = dropdownmenuconducteurkta2206.options; 

        var coefficientponderation = 0;

        for (let i = 0; i < options_galeries.length; i++) {

            coefficientponderation += parseFloat(GalerieData[i]["CoefficientPonderation"]);  
            const nombrejonctions = parseFloat(GalerieData[i]["NombreJonctionsparjd"]);

            if (typechoc =='1') {

                if (nombrejonctions == '1') {

                    GalerieData[i]["Extensionfictiveldf"] = '30';

                } else if (nombrejonctions == '2') {

                    GalerieData[i]["Extensionfictiveldf"] = '20';

                } else if (nombrejonctions == '3') {

                    GalerieData[i]["Extensionfictiveldf"] = '10';
                    
                } else if (nombrejonctions == '4') {

                    GalerieData[i]["Extensionfictiveldf"] = '5';
                    
                } 


                


            }  else if (typechoc =='2') {

    
                if (nombrejonctions == '1') {

                    GalerieData[i]["Extensionfictiveldf"] = '55';

                } else if (nombrejonctions == '2') {

                    GalerieData[i]["Extensionfictiveldf"] = '35';

                } else if (nombrejonctions == '3') {

                    GalerieData[i]["Extensionfictiveldf"] = '20';
                    
                } else if (nombrejonctions == '4') {

                    GalerieData[i]["Extensionfictiveldf"] = '10';
                    
                } 




            } else if (typechoc =='3') {

        
                if (nombrejonctions == '1') {

                    GalerieData[i]["Extensionfictiveldf"] = '70';

                } else if (nombrejonctions == '2') {

                    GalerieData[i]["Extensionfictiveldf"] = '50';

                } else if (nombrejonctions == '3') {

                    GalerieData[i]["Extensionfictiveldf"] = '30';
                    
                } else if (nombrejonctions == '4') {

                    GalerieData[i]["Extensionfictiveldf"] = '15';
                    
                } 


            } 
                

        }

        for (let i = 0; i < options_conducteur.length; i++) {

            coefficientponderation += parseFloat(ElementConducteurData[i]["CoefficientPonderation"]);        

        }

        const K = parseFloat(document.getElementById('facteur-foudre-k-kta2206').value);
        const ldf = parseFloat(document.getElementById('extension-fictive-kta2206').value);
        var lk = parseFloat(document.getElementById('longueur-galerie-kta2206').value);
        var nombrejdr = parseFloat(document.getElementById('nombre-jd-galerie-kta2206').value);
        var nombrejd = parseFloat(document.getElementById('nombre-jd-galerie-kta2206').value);
        var coefficientponderationselectedgalerie = parseFloat(document.getElementById('coefficient-ponderation-galerie-kta2206').value);
                       
        document.getElementById('courant-prise-terre-kta2206').value = (courantmax/3).toFixed(2);

        lf = K*Math.sqrt(resistivitesol);

        if (lf<lk) {

            lk = lf;
        }

        if (ldf/lk>=1) {
            
            nombrejd = 1;

        } else {

            
            const ratiolkldf = lk / ldf;

            if (Number.isInteger(Number(ratiolkldf))) {
                
                nombrejd = ratiolkldf;

            } else {

                nombrejd = Math.ceil(ratiolkldf);

            }

            if (nombrejd>=nombrejdr) {
                nombrejd = nombrejdr;
            }

        }

        // Envoie une requête POST au serveur Node.js
        const response = await fetch('/calcultensionaxialeul', {
        method: 'POST',
        headers: {
        'Content-Type': 'application/json'
        },
        body: JSON.stringify({impedancecouplage,lk,nombrejd,ldf,courantmax,coefficientponderationselectedgalerie,coefficientponderation})
        });

        // Attend la réponse du serveur
        const result = await response.json();
        const ul = result.ul;
        const courantpartielgaleriekta2206 = result.courantpartielgaleriekta2206;

        document.getElementById('tension-induite-kta2206').value = ul.toFixed(2);

        GalerieData[selectedgalerie]["TensionAxialeInduite"] = document.getElementById('tension-induite-kta2206').value;

        document.getElementById('courant-partiel-galerie-kta2206').value = (courantpartielgaleriekta2206).toFixed(2);

        GalerieData[selectedgalerie]["CourantGalerie"] = document.getElementById('courant-partiel-galerie-kta2206').value;

               
        

        if (ul/1000>=GalerieData[selectedgalerie]["TenueUw"]) {

            document.getElementById('tension-induite-kta2206').style.color = 'red';
            exclamationIconKTA2206.style.display = 'inline'; // Display the exclamation icon
            exclamationIconKTA2206.addEventListener('mouseover', function() {
            tooltipKTA2206.style.display = 'block'; // Show the tooltip
            tooltipKTA2206.textContent="La tension induite dépasse la tenue au choc de foudre des équipements internes"
            });

            // Hide tooltip message when mouse leaves the exclamation mark
            exclamationIconKTA2206.addEventListener('mouseout', function() {
            tooltipKTA2206.style.display = 'none'; // Hide the tooltip
            });
        
        } else {

            //niveau_protection_2.classList.remove('invalid');
            document.getElementById('tension-induite-kta2206').style.color = 'blue';
            exclamationIconKTA2206.style.display = 'none'; // Hide the exclamation icon


        }



        
    }


    ElementConducteurData = {};
    ElementConducteurCounter=2;

    GalerieData = {};
    GalerieCounter=2;

    document.addEventListener('DOMContentLoaded', function() {


        const addconducteurkta2206btn=document.getElementById('add-conducteur-kta2206-btn');
        const addbusekta2206btn=document.getElementById('add-buse-kta2206-btn');

        const dropdownmenuelementconducteur=document.getElementById('dropdown-menu-conducteur-kta2206');
        const selectedconducteur=document.getElementById('dropdown-menu-conducteur-kta2206').selectedIndex;
        const dropdownmenubusekta2206=document.getElementById('dropdown-menu-buse-kta2206');
        const selectedgalerie=document.getElementById('dropdown-menu-buse-kta2206').selectedIndex;

        ElementConducteurData[selectedconducteur] = {

        "NomConducteur":"",
        "CoefficientPonderation": "1",
        "TypeElementConducteur":"1"

        }

        GalerieData[selectedgalerie] = {
        "NomGalerie":"",
        "TypeGalerie":"1",
        "CoefficientPonderation": "3",
        "LongueurGalerie":"50",
        "Extensionfictiveldf": "30",
        "CourantGalerie": "100",
        "TenueUw": "1.5",
        "TensionAxialeInduite":"10",
        "NombreJonctionsparjd":"1",
        "NombreJD":"2"

        }

        ElementConducteurData[selectedconducteur]["NomConducteur"] = "Elément Conducteur N° 1";
        GalerieData[selectedgalerie]["NomGalerie"] = "Galerie N° 1";
        
        addconducteurkta2206btn.addEventListener('click', function() {

        const newelementconducteur = `Elément Conducteur N° ${ElementConducteurCounter}`;
        const option_elementconducteur = document.createElement('option');
        option_elementconducteur.value = newelementconducteur;
        option_elementconducteur.textContent = newelementconducteur;
        dropdownmenuelementconducteur.appendChild(option_elementconducteur);
        option_elementconducteur.value=newelementconducteur;

        dropdownmenuelementconducteur.value= dropdownmenuelementconducteur.options[dropdownmenuelementconducteur.options.length - 1].value;

        const selectedconducteur = dropdownmenuelementconducteur.options.length-1;
   
        ElementConducteurData[selectedconducteur] = {

        "NomConducteur":"",
        "CoefficientPonderation": "1",
        "TypeElementConducteur":"1"

        }


        ElementConducteurData[selectedconducteur]["NomConducteur"] = `Elément Conducteur N° ${ElementConducteurCounter}`;


        calcultensionaxialeul();

        document.getElementById('coefficient-ponderation-conducteur-kta2206').value =ElementConducteurData[selectedconducteur]["CoefficientPonderation"];
        document.getElementById('type-cable-kta2206').value =ElementConducteurData[selectedconducteur]["TypeElementConducteur"];

        ElementConducteurCounter++;

        });

        addbusekta2206btn.addEventListener('click', function() {

        const newgalerie = `Galerie N° ${GalerieCounter}`;
        const option_galerie = document.createElement('option');
        option_galerie.value = newgalerie;
        option_galerie.textContent = newgalerie;
        dropdownmenubusekta2206.appendChild(option_galerie);
        option_galerie.value=newgalerie;

        dropdownmenubusekta2206.value= dropdownmenubusekta2206.options[dropdownmenubusekta2206.options.length - 1].value;

        const selectedgalerie = dropdownmenubusekta2206.options.length-1;
   
        GalerieData[selectedgalerie] = {
        "NomGalerie":"",
        "TypeGalerie":"1",
        "CoefficientPonderation": "3",
        "LongueurGalerie":"50",
        "Extensionfictiveldf": "30",
        "CourantGalerie": "100",
        "TenueUw": "1.5",
        "TensionAxialeInduite":"10",
        "NombreJonctionsparjd":"1",
        "NombreJD":"2"

        }

        const typechoc = document.getElementById('type-choc-foudre-kta2206').value;
         
        if (typechoc =='1') {

            GalerieData[selectedgalerie]["Extensionfictiveldf"]='30';

            document.getElementById('extension-fictive-kta2206').value = GalerieData[selectedgalerie]["Extensionfictiveldf"];

        } else if (typechoc =='2') {

            GalerieData[selectedgalerie]["Extensionfictiveldf"]='55';

            document.getElementById('extension-fictive-kta2206').value = GalerieData[selectedgalerie]["Extensionfictiveldf"];

        } else if (typechoc =='3') {

            GalerieData[selectedgalerie]["Extensionfictiveldf"]='70';

            document.getElementById('extension-fictive-kta2206').value = GalerieData[selectedgalerie]["Extensionfictiveldf"];

        }


        GalerieData[selectedgalerie]["NomGalerie"] = `Galerie N° ${GalerieCounter}`;


        calcultensionaxialeul();

        document.getElementById('coefficient-ponderation-galerie-kta2206').value = GalerieData[selectedgalerie]["CoefficientPonderation"];
        document.getElementById('type-buse-kta2206').value = GalerieData[selectedgalerie]["TypeGalerie"];
        document.getElementById('longueur-galerie-kta2206').value = GalerieData[selectedgalerie]["LongueurGalerie"];
        document.getElementById('extension-fictive-kta2206').value = GalerieData[selectedgalerie]["Extensionfictiveldf"];
        document.getElementById('courant-partiel-galerie-kta2206').value = GalerieData[selectedgalerie]["CourantGalerie"];
        document.getElementById('tenue-equipements-kta2206').value = GalerieData[selectedgalerie]["TenueUw"];
        document.getElementById('tension-induite-kta2206').value = GalerieData[selectedgalerie]["TensionAxialeInduite"];
        document.getElementById('nombre-liaisons-jd-kta2206').value = GalerieData[selectedgalerie]["NombreJonctionsparjd"];
        document.getElementById('nombre-jd-galerie-kta2206').value = GalerieData[selectedgalerie]["NombreJD"];

        GalerieCounter++;

        });



        document.getElementById('niveau-protection-kta2206').addEventListener('change', function () {

            const niveauprotection = document.getElementById('niveau-protection-kta2206').value;
            const typechoc = document.getElementById('type-choc-foudre-kta2206').value;
           

        if (niveauprotection =='1' || niveauprotection =='10') {

            if (typechoc =='1') {

                document.getElementById('courant-max-kta2206').value='200.0';
             


            } else if (typechoc =='2') {

                document.getElementById('courant-max-kta2206').value='100.0';


            } else if (typechoc =='3') {

                document.getElementById('courant-max-kta2206').value='50.0';



            }

 
        }  else if (niveauprotection =='2') {

            if (typechoc =='1') {

                document.getElementById('courant-max-kta2206').value='150.0';


            } else if (typechoc =='2') {


                document.getElementById('courant-max-kta2206').value='75.0';


            } else if (typechoc =='3') {


                document.getElementById('courant-max-kta2206').value='37.5';

            }


        } else if (niveauprotection =='3') {

            if (typechoc =='1') {

                document.getElementById('courant-max-kta2206').value='100.0';


            } else if (typechoc =='2') {


                document.getElementById('courant-max-kta2206').value='50.0';


            } else if (typechoc =='3') {

                document.getElementById('courant-max-kta2206').value='25.0';

            }




        } else if (niveauprotection =='4') {

             if (typechoc =='1') {

                document.getElementById('courant-max-kta2206').value='100.0';


            } else if (typechoc =='2') {

                document.getElementById('courant-max-kta2206').value='50.0';


            } else if (typechoc =='3') {


                document.getElementById('courant-max-kta2206').value='25.0';

            }


        } 

        if (niveauprotection == 'AUTRE') {

            document.getElementById('courant-max-kta2206').readOnly = false;
            document.getElementById('courant-max-kta2206').className = 'select_field';


        } else {

            document.getElementById('courant-max-kta2206').readOnly = true;
            document.getElementById('courant-max-kta2206').className = 'select_field_o';

        }

          
            
        calcultensionaxialeul();
        
        
        });


        document.getElementById('courant-max-kta2206').addEventListener('change', function() {
            
            const courantImpulsionnel = parseFloat(document.getElementById('courant-max-kta2206').value);

            if (courantImpulsionnel <=0 || courantImpulsionnel >600 || isNaN(courantImpulsionnel)) {

                document.getElementById('courant-max-kta2206').value = '200';

            }

            calcultensionaxialeul();

        });

        document.getElementById('type-choc-foudre-kta2206').addEventListener('change', function () {

        const niveauprotection = document.getElementById('niveau-protection-kta2206').value;
        const typechoc = document.getElementById('type-choc-foudre-kta2206').value;
        const nombrejonctions = document.getElementById('nombre-liaisons-jd-kta2206').value;
         
        if (typechoc =='1') {

            if (niveauprotection =='1' || niveauprotection =='AUTRE') {

                document.getElementById('courant-max-kta2206').value='200.0';


            }  else if (niveauprotection =='2') {

                document.getElementById('courant-max-kta2206').value='150.0';


            } else if (niveauprotection =='3') {

                document.getElementById('courant-max-kta2206').value='100.0';


            } else if (niveauprotection =='4') {

                document.getElementById('courant-max-kta2206').value='100.0';


            } 

            document.getElementById('impedance-couplage-kta2206').value='0.08';
            document.getElementById('facteur-foudre-k-kta2206').value = '3';

            if (nombrejonctions == '1') {

                document.getElementById('extension-fictive-kta2206').value = '30';

            } else if (nombrejonctions == '2') {

                document.getElementById('extension-fictive-kta2206').value = '20';

            } else if (nombrejonctions == '3') {

                document.getElementById('extension-fictive-kta2206').value = '10';
                
            } else if (nombrejonctions == '4') {

                document.getElementById('extension-fictive-kta2206').value = '5';
                
            } 


            


        }  else if (typechoc =='2') {

            if (niveauprotection =='1') {

                document.getElementById('courant-max-kta2206').value='100.0';


            }  else if (niveauprotection =='2') {

                document.getElementById('courant-max-kta2206').value='75.0';



            } else if (niveauprotection =='3') {

                document.getElementById('courant-max-kta2206').value='50.0';


            } else if (niveauprotection =='4') {

                document.getElementById('courant-max-kta2206').value='50.0';


            } else {

                document.getElementById('courant-max-kta2206').value='100.0';

            }

            document.getElementById('impedance-couplage-kta2206').value='0.30';
            document.getElementById('facteur-foudre-k-kta2206').value = '1';

            if (nombrejonctions == '1') {

                document.getElementById('extension-fictive-kta2206').value = '55';

            } else if (nombrejonctions == '2') {

                document.getElementById('extension-fictive-kta2206').value = '35';

            } else if (nombrejonctions == '3') {

                document.getElementById('extension-fictive-kta2206').value = '20';
                
            } else if (nombrejonctions == '4') {

                document.getElementById('extension-fictive-kta2206').value = '10';
                
            } 




        } else if (typechoc =='3') {

             if (niveauprotection =='1') {

                document.getElementById('courant-max-kta2206').value='50.0';


            }  else if (niveauprotection =='2') {

                document.getElementById('courant-max-kta2206').value='37.5';


            } else if (niveauprotection =='3') {

                document.getElementById('courant-max-kta2206').value='25.0';


            } else if (niveauprotection =='4') {

                document.getElementById('courant-max-kta2206').value='25.0';


            } else {

                document.getElementById('courant-max-kta2206').value='50.0';

            }

            document.getElementById('impedance-couplage-kta2206').value='0.50';
            document.getElementById('facteur-foudre-k-kta2206').value = '0.5';


            if (nombrejonctions == '1') {

                document.getElementById('extension-fictive-kta2206').value = '70';

            } else if (nombrejonctions == '2') {

                document.getElementById('extension-fictive-kta2206').value = '50';

            } else if (nombrejonctions == '3') {

                document.getElementById('extension-fictive-kta2206').value = '30';
                
            } else if (nombrejonctions == '4') {

                document.getElementById('extension-fictive-kta2206').value = '15';
                
            } 


        } 


        GalerieData[selectedgalerie]["Extensionfictiveldf"] = document.getElementById('extension-fictive-kta2206').value;
      
        calcultensionaxialeul();
        
        });


        document.getElementById('resistivite-sol-kta2206').addEventListener('change', function () {

        const resistivitesol = parseFloat(document.getElementById('resistivite-sol-kta2206').value);

        if (resistivitesol<0. || isNaN(resistivitesol)) {

            document.getElementById('resistivite-sol-kta2206').value = '500.0';
        }

            calcultensionaxialeul();

        });

        
        dropdownmenubusekta2206.addEventListener('change', function() {

            const selectedgalerie = dropdownmenubusekta2206.selectedIndex;
            document.getElementById('coefficient-ponderation-galerie-kta2206').value = GalerieData[selectedgalerie]["CoefficientPonderation"];
            document.getElementById('type-buse-kta2206').value = GalerieData[selectedgalerie]["TypeGalerie"];
            document.getElementById('longueur-galerie-kta2206').value = GalerieData[selectedgalerie]["LongueurGalerie"];
            document.getElementById('extension-fictive-kta2206').value = GalerieData[selectedgalerie]["Extensionfictiveldf"];
            document.getElementById('courant-partiel-galerie-kta2206').value = GalerieData[selectedgalerie]["CourantGalerie"];
            document.getElementById('tenue-equipements-kta2206').value = GalerieData[selectedgalerie]["TenueUw"];
            document.getElementById('tension-induite-kta2206').value = GalerieData[selectedgalerie]["TensionAxialeInduite"];
            document.getElementById('nombre-liaisons-jd-kta2206').value = GalerieData[selectedgalerie]["NombreJonctionsparjd"];
            document.getElementById('nombre-jd-galerie-kta2206').value = GalerieData[selectedgalerie]["NombreJD"];

            calcultensionaxialeul();

        });


        dropdownmenuelementconducteur.addEventListener('change', function() {

            const selectedconducteur = dropdownmenuelementconducteur.selectedIndex;
            document.getElementById('coefficient-ponderation-conducteur-kta2206').value =ElementConducteurData[selectedconducteur]["CoefficientPonderation"];
            document.getElementById('type-cable-kta2206').value =ElementConducteurData[selectedconducteur]["TypeElementConducteur"];

            calcultensionaxialeul();

        });


        document.getElementById('type-cable-kta2206').addEventListener('change', function () {

            const dropdownmenuelementconducteur=document.getElementById('dropdown-menu-conducteur-kta2206');
            const selectedconducteur=document.getElementById('dropdown-menu-conducteur-kta2206').selectedIndex;
            const typecable = document.getElementById('type-cable-kta2206').value;

            if (typecable == '1') {

                document.getElementById('coefficient-ponderation-conducteur-kta2206').value = '1';


            } else if (typecable == '2') {

                document.getElementById('coefficient-ponderation-conducteur-kta2206').value = '2';

            } else if (typecable == '3') {

                document.getElementById('coefficient-ponderation-conducteur-kta2206').value = '3';

            } else if (typecable == '4') {

                document.getElementById('coefficient-ponderation-conducteur-kta2206').value = '1';

            } else if (typecable == '5') {

                document.getElementById('coefficient-ponderation-conducteur-kta2206').value = '2';

            } else if (typecable == '6') {

                document.getElementById('coefficient-ponderation-conducteur-kta2206').value = '3';

            }


            ElementConducteurData[selectedconducteur]["TypeElementConducteur"] = document.getElementById('type-cable-kta2206').value;
            ElementConducteurData[selectedconducteur]["CoefficientPonderation"] = document.getElementById('coefficient-ponderation-conducteur-kta2206').value


            calcultensionaxialeul();

        });


        document.getElementById('type-buse-kta2206').addEventListener('change', function () {

            const dropdownmenubusekta2206=document.getElementById('dropdown-menu-buse-kta2206');
            const selectedgalerie=document.getElementById('dropdown-menu-buse-kta2206').selectedIndex;
            const typebuse = document.getElementById('type-buse-kta2206').value;

            if (typebuse == '1') {

                document.getElementById('coefficient-ponderation-galerie-kta2206').value = '3';


            } else {

                document.getElementById('coefficient-ponderation-galerie-kta2206').value = '6';
                

            }

            GalerieData[selectedgalerie]["TypeGalerie"] = document.getElementById('type-buse-kta2206').value;
            GalerieData[selectedgalerie]["CoefficientPonderation"]=document.getElementById('coefficient-ponderation-galerie-kta2206').value;

            calcultensionaxialeul();

        });


        document.getElementById('longueur-galerie-kta2206').addEventListener('change', function () {

            const dropdownmenubusekta2206=document.getElementById('dropdown-menu-buse-kta2206');
            const selectedgalerie=document.getElementById('dropdown-menu-buse-kta2206').selectedIndex;

            const longueurgalerie = parseFloat(document.getElementById('longueur-galerie-kta2206').value);

            if (longueurgalerie<=0. || isNaN(longueurgalerie)) {

                document.getElementById('longueur-galerie-kta2206').value = '50.0';
            }

            GalerieData[selectedgalerie]["LongueurGalerie"] = document.getElementById('longueur-galerie-kta2206').value;

            calcultensionaxialeul();

        });



        document.getElementById('nombre-liaisons-jd-kta2206').addEventListener('change', function () {

            const dropdownmenubusekta2206=document.getElementById('dropdown-menu-buse-kta2206');
            const selectedgalerie=document.getElementById('dropdown-menu-buse-kta2206').selectedIndex;
            const nombrejonctions = document.getElementById('nombre-liaisons-jd-kta2206').value;
            const typechoc = document.getElementById('type-choc-foudre-kta2206').value;

            if (nombrejonctions == '1') {

                if (typechoc == '1') {

                    document.getElementById('extension-fictive-kta2206').value = '30';

                } else if (typechoc == '2') {

                    document.getElementById('extension-fictive-kta2206').value = '55';


                } else if (typechoc == '3') {

                    document.getElementById('extension-fictive-kta2206').value = '70';


                }

                GalerieData[selectedgalerie]["Extensionfictiveldf"] = document.getElementById('extension-fictive-kta2206').value;


            } else if (nombrejonctions == '2') {

                if (typechoc == '1') {

                    document.getElementById('extension-fictive-kta2206').value = '20';

                } else if (typechoc == '2') {

                    document.getElementById('extension-fictive-kta2206').value = '35';


                } else if (typechoc == '3') {

                    document.getElementById('extension-fictive-kta2206').value = '50';


                }

                GalerieData[selectedgalerie]["Extensionfictiveldf"] = document.getElementById('extension-fictive-kta2206').value;
                

            } else if (nombrejonctions == '3') {

                if (typechoc == '1') {

                    document.getElementById('extension-fictive-kta2206').value = '10';

                } else if (typechoc == '2') {

                    document.getElementById('extension-fictive-kta2206').value = '20';


                } else if (typechoc == '3') {

                    document.getElementById('extension-fictive-kta2206').value = '30';


                }

                GalerieData[selectedgalerie]["Extensionfictiveldf"] = document.getElementById('extension-fictive-kta2206').value;
                

            } else if (nombrejonctions == '4') {

                if (typechoc == '1') {

                    document.getElementById('extension-fictive-kta2206').value = '5';

                } else if (typechoc == '2') {

                    document.getElementById('extension-fictive-kta2206').value = '10';


                } else if (typechoc == '3') {

                    document.getElementById('extension-fictive-kta2206').value = '15';


                }

                GalerieData[selectedgalerie]["Extensionfictiveldf"] = document.getElementById('extension-fictive-kta2206').value;
                

            } 

            GalerieData[selectedgalerie]["NombreJonctionsparjd"] = document.getElementById('nombre-liaisons-jd-kta2206').value;

            calcultensionaxialeul();


        });


        document.getElementById('nombre-jd-galerie-kta2206').addEventListener('change', function () {

            const dropdownmenubusekta2206=document.getElementById('dropdown-menu-buse-kta2206');
            const selectedgalerie=document.getElementById('dropdown-menu-buse-kta2206').selectedIndex;

            var nombrejd = Math.floor(parseFloat(document.getElementById('nombre-jd-galerie-kta2206').value));

            if (nombrejd<=0. || isNaN(nombrejd)) {

                nombrejd = 2;

            }

            document.getElementById('nombre-jd-galerie-kta2206').value = nombrejd.toFixed(0);

            GalerieData[selectedgalerie]["NombreJD"] = document.getElementById('nombre-jd-galerie-kta2206').value;

            calcultensionaxialeul();

        });


        document.getElementById('tenue-equipements-kta2206').addEventListener('change', function () {

            const dropdownmenubusekta2206=document.getElementById('dropdown-menu-buse-kta2206');
            const selectedgalerie=document.getElementById('dropdown-menu-buse-kta2206').selectedIndex;

            var nombrejd = parseFloat(document.getElementById('tenue-equipements-kta2206').value);

            if (nombrejd<=0. || isNaN(nombrejd)) {

                nombrejd = 1.5;

            }

            document.getElementById('tenue-equipements-kta2206').value = nombrejd.toFixed(2);

            GalerieData[selectedgalerie]["TenueUw"] = document.getElementById('tenue-equipements-kta2206').value;

            calcultensionaxialeul();

        });






    });


    function removeConducteurkta2206() {

        const dropdownmenuelementconducteur=document.getElementById('dropdown-menu-conducteur-kta2206');
        const selectedOption = dropdownmenuelementconducteur.options[dropdownmenuelementconducteur.selectedIndex];
        var selectedconducteur = dropdownmenuelementconducteur.selectedIndex;
        const selectedconducteur0 = selectedconducteur;

        if (dropdownmenuelementconducteur.options.length <= 1) {

            alert("Opération invalide");

        } else {

            dropdownmenuelementconducteur.remove(dropdownmenuelementconducteur.selectedIndex);
            ElementConducteurCounter=ElementConducteurCounter-1;
 
            delete ElementConducteurData[selectedconducteur];

            // Reindex ZPFData so the keys are sequential
            const newConducteurData = {};
            let newIndex = 0;

            for (let key in ElementConducteurData) {
                newConducteurData[newIndex] = ElementConducteurData[key];
                newIndex++;
            }

            // Replace the old ZPFData with the new reindexed one
            ElementConducteurData = newConducteurData;

            var newselectedConducteur = selectedconducteur0;

            if (newselectedConducteur>0) {

                newselectedConducteur = selectedconducteur0-1;

            } else {

                newselectedConducteur = selectedzpf0;
            }

            dropdownmenuelementconducteur.value = dropdownmenuelementconducteur.options[newselectedConducteur].value;


            document.getElementById('coefficient-ponderation-conducteur-kta2206').value =ElementConducteurData[newselectedConducteur]["CoefficientPonderation"];
            document.getElementById('type-cable-kta2206').value =ElementConducteurData[newselectedConducteur]["TypeElementConducteur"];


            calcultensionaxialeul();

        }
      

    }


    function renameConducteurkta2206() {

        const dropdownmenuelementconducteur=document.getElementById('dropdown-menu-conducteur-kta2206');
        const selectedOption = dropdownmenuelementconducteur.options[dropdownmenuelementconducteur.selectedIndex];
        var selectedconducteur = dropdownmenuelementconducteur.selectedIndex;

        const newName = prompt("Saisir un nouveau nom de l'élément conducteur:");

        // Check if a new name was provided and it's not an empty string
        if (newName !== null && newName.trim() !== "") {
            const newNameTrimmed = newName.trim();
            ElementConducteurData[selectedconducteur]["NomConducteur"] = newNameTrimmed;

            selectedOption.text = newNameTrimmed;
          
        }

        calcultensionaxialeul();


    }



    function removeGaleriekta2206() {

        const dropdownmenubusekta2206=document.getElementById('dropdown-menu-buse-kta2206');
        const selectedOption = dropdownmenubusekta2206.options[dropdownmenubusekta2206.selectedIndex];
        var selectedgalerie = dropdownmenubusekta2206.selectedIndex;
        const selectedgalerie0 = selectedgalerie;

        if (dropdownmenubusekta2206.options.length <= 1) {

            alert("Opération invalide");

        } else {

            dropdownmenubusekta2206.remove(dropdownmenubusekta2206.selectedIndex);
            GalerieCounter=GalerieCounter-1;
 
            delete GalerieData[selectedgalerie];

            // Reindex ZPFData so the keys are sequential
            const newGalerieData = {};
            let newIndex = 0;

            for (let key in GalerieData) {
                newGalerieData[newIndex] = GalerieData[key];
                newIndex++;
            }

            // Replace the old ZPFData with the new reindexed one
            GalerieData = newGalerieData;

            var newselectedgalerie = selectedgalerie0;

            if (newselectedgalerie>0) {

                newselectedgalerie = selectedgalerie0-1;

            } else {

                newselectedgalerie = selectedgalerie0;
            }

            dropdownmenubusekta2206.value = dropdownmenubusekta2206.options[newselectedgalerie].value;


            document.getElementById('coefficient-ponderation-galerie-kta2206').value = GalerieData[newselectedgalerie]["CoefficientPonderation"];
            document.getElementById('type-buse-kta2206').value = GalerieData[newselectedgalerie]["TypeGalerie"];
            document.getElementById('longueur-galerie-kta2206').value = GalerieData[newselectedgalerie]["LongueurGalerie"];
            document.getElementById('extension-fictive-kta2206').value = GalerieData[newselectedgalerie]["Extensionfictiveldf"];
            document.getElementById('courant-partiel-galerie-kta2206').value = GalerieData[newselectedgalerie]["CourantGalerie"];
            document.getElementById('tenue-equipements-kta2206').value = GalerieData[newselectedgalerie]["TenueUw"];
            document.getElementById('tension-induite-kta2206').value = GalerieData[newselectedgalerie]["TensionAxialeInduite"];
            document.getElementById('nombre-liaisons-jd-kta2206').value = GalerieData[newselectedgalerie]["NombreJonctionsparjd"];
            document.getElementById('nombre-jd-galerie-kta2206').value = GalerieData[newselectedgalerie]["NombreJD"];

            calcultensionaxialeul();

        }
      

    }


    function renameGaleriekta2206() {

        const dropdownmenubusekta2206=document.getElementById('dropdown-menu-buse-kta2206');
        const selectedOption = dropdownmenubusekta2206.options[dropdownmenubusekta2206.selectedIndex];
        var selectedgalerie = dropdownmenubusekta2206.selectedIndex;

        const newName = prompt("Saisir un nouveau nom de la galerie:");

        // Check if a new name was provided and it's not an empty string
        if (newName !== null && newName.trim() !== "") {
            const newNameTrimmed = newName.trim();
            GalerieData[selectedgalerie]["NomGalerie"] = newNameTrimmed;

            selectedOption.text = newNameTrimmed;
          
        }

        calcultensionaxialeul();


    }








    /////////////////////////////CALCULS KTA2206////////////////////////////////////////


    

    var temperatureFusion;

    async function calculsectionecran(event) {

        var courantmax = parseFloat(document.getElementById('courant-impulsionnel-blindage').value);
        var tenuechocs = parseFloat(document.getElementById('tenue-chocs-equipements-blindage').value);
        var diametreecran = parseFloat(document.getElementById('diametre-moyen-ecran').value);
        var resistivitesol = parseFloat(document.getElementById('resistivite-sol-blindage').value);
        var temperaturemaximaleisolant = parseFloat(document.getElementById('temperature-maximale-isolant-cable-blindage').value);

        const temperatureambiante = parseFloat(document.getElementById('temperature-ambiante-blindage').value);
        
        const etatecran = document.getElementById('etat-ecran-blindage').value;

        var Lc;

        var longueurcable;

        var longueurcable = parseFloat(document.getElementById('longueur-cable-blindage').value);


        if (etatecran == '1') {

            Lc = 8*Math.sqrt(resistivitesol);
            document.getElementById('longueur-cable-blindage').readOnly = true;

            if (Lc<=longueurcable) {
            document.getElementById('longueur-cable-blindage').value = Lc.toFixed(2);
            longueurcable = parseFloat(document.getElementById('longueur-cable-blindage').value);
            }
            

        } else {

            document.getElementById('longueur-cable-blindage').readOnly = false;

        }

        const typemateriau = document.getElementById('materiau-conducteur-blindage').value;

        

        var resistiviteecran;
        var coefficientTemperature;
        var densiteMateriau;
        var capaciteThermique;
        var temperatureFusion;

        if (typemateriau=='1') {

            resistiviteecran = 1.78E-8;
            document.getElementById('resistivite-blindage').value = '1.68E-8';
            coefficientTemperature=3.92E-3;
            densiteMateriau=8920;
            capaciteThermique=385;
            temperatureFusion=1080;

        } else if (typemateriau=='2') {

            resistiviteecran = 2.90E-8;
            document.getElementById('resistivite-blindage').value = '2.82E-8';
            coefficientTemperature=4.0E-3;
            densiteMateriau=2700;
            capaciteThermique=908;
            temperatureFusion=658;


        } else {

            resistiviteecran = 1.2E-7;
            document.getElementById('resistivite-blindage').value = '1.6E-7';
            coefficientTemperature=6.5E-3;
            densiteMateriau=7700;
            capaciteThermique=469;
            temperatureFusion=1080;

        }

        // Envoie une requête POST au serveur Node.js
        const response = await fetch('/calculsectionecran', {
        method: 'POST',
        headers: {
        'Content-Type': 'application/json'
        },
        body: JSON.stringify({courantmax,resistiviteecran,longueurcable,tenuechocs,coefficientTemperature,densiteMateriau,capaciteThermique,temperaturemaximaleisolant,temperatureambiante})
        });

        // Attend la réponse du serveur
        result = await response.json();
        Smin1 = result.Smin1;
        Smin2 = result.Smin2;
 
        var Smin;

        if (Smin1>=Smin2) {

            Smin = Smin1;


        } else {

            Smin = Smin2;

        }


        epaisseurecran = Smin/(8*diametreecran);

        document.getElementById('section-ecran-blindage').value = Smin.toFixed(2);

        document.getElementById('epaisseur-ecran-blindage').value = epaisseurecran.toFixed(2);



    }

    document.getElementById('niveau-protection-elevation').addEventListener('change', function() {

    const niveauprotection = document.getElementById('niveau-protection-elevation').value;

    if (niveauprotection =='1') {

        document.getElementById('courant-impulsionnel-elevation').value = '200.00';
        document.getElementById('courant-impulsionnel-elevation').readOnly = true;
        document.getElementById('courant-impulsionnel-elevation').className = 'select_field_o';
        

    } else if (niveauprotection =='2') {


        document.getElementById('courant-impulsionnel-elevation').value = '150.00';
        document.getElementById('courant-impulsionnel-elevation').readOnly = true;
        document.getElementById('courant-impulsionnel-elevation').className = 'select_field_o';

    } else if (niveauprotection =='3') {

        document.getElementById('courant-impulsionnel-elevation').value = '100.00';
        document.getElementById('courant-impulsionnel-elevation').readOnly = true;
        document.getElementById('courant-impulsionnel-elevation').className = 'select_field_o';

    } else if (niveauprotection =='4') {

        document.getElementById('courant-impulsionnel-elevation').value = '100.00';
        document.getElementById('courant-impulsionnel-elevation').readOnly = true;
        document.getElementById('courant-impulsionnel-elevation').className = 'select_field_o';

    } else {

        document.getElementById('courant-impulsionnel-elevation').value = '200.00';
        document.getElementById('courant-impulsionnel-elevation').readOnly = false;
        document.getElementById('courant-impulsionnel-elevation').className = 'select_field';

    }

    calculateDeltaTheta();


    });


    // Ajout de listeners pour recalculer Δθ à chaque changement d'entrée
    document.getElementById('courant-impulsionnel-elevation').addEventListener('change', calculateDeltaTheta);
    document.getElementById('coef-repartition').addEventListener('change', calculateDeltaTheta);
    document.getElementById('section-conducteur').addEventListener('change', calculateDeltaTheta);

    // Ajout de listeners pour recalculer Δθ à chaque changement d'entrée

    ///////////////////////////////////////////////////////////////////////////////////////////////////////

    document.getElementById('niveau-protection-profondeur').addEventListener('change', function() {

    const niveauprotection = document.getElementById('niveau-protection-profondeur').value;

    if (niveauprotection =='1') {

        document.getElementById('courant-impulsionnel-profondeur').value = '200.00';
        document.getElementById('courant-impulsionnel-profondeur').readOnly = true;
        document.getElementById('courant-impulsionnel-profondeur').className = 'select_field_o';
        

    } else if (niveauprotection =='2') {


        document.getElementById('courant-impulsionnel-profondeur').value = '150.00';
        document.getElementById('courant-impulsionnel-profondeur').readOnly = true;
        document.getElementById('courant-impulsionnel-profondeur').className = 'select_field_o';

    } else if (niveauprotection =='3') {

        document.getElementById('courant-impulsionnel-profondeur').value = '100.00';
        document.getElementById('courant-impulsionnel-profondeur').readOnly = true;
        document.getElementById('courant-impulsionnel-profondeur').className = 'select_field_o';

    } else if (niveauprotection =='4') {

        document.getElementById('courant-impulsionnel-profondeur').value = '100.00';
        document.getElementById('courant-impulsionnel-profondeur').readOnly = true;
        document.getElementById('courant-impulsionnel-profondeur').className = 'select_field_o';

    } else {

        document.getElementById('courant-impulsionnel-profondeur').value = '200.00';
        document.getElementById('courant-impulsionnel-profondeur').readOnly = false;
        document.getElementById('courant-impulsionnel-profondeur').className = 'select_field';

    }

    calculateProfondeurFusion();


    });

        
    document.getElementById('courant-impulsionnel-profondeur').addEventListener('change', calculateProfondeurFusion);
    document.getElementById('epaisseur-conducteur-profondeur').addEventListener('change', calculateProfondeurFusion);
    document.getElementById('temperature-ambiante-profondeur').addEventListener('change', calculateProfondeurFusion);

    // Ajout de listeners pour recalculer Δθ à chaque changement d'entrée

    document.getElementById('niveau-protection-spf').addEventListener('change', function() {

    const niveauprotection = document.getElementById('niveau-protection-spf').value;

    if (niveauprotection =='1') {

        document.getElementById('courant-impulsionnel-spf').value = '200.00';
        document.getElementById('courant-impulsionnel-spf').readOnly = true;
        document.getElementById('courant-impulsionnel-spf').className = 'select_field_o';
        

    } else if (niveauprotection =='2') {


        document.getElementById('courant-impulsionnel-spf').value = '150.00';
        document.getElementById('courant-impulsionnel-spf').readOnly = true;
        document.getElementById('courant-impulsionnel-spf').className = 'select_field_o';

    } else if (niveauprotection =='3') {

        document.getElementById('courant-impulsionnel-spf').value = '100.00';
        document.getElementById('courant-impulsionnel-spf').readOnly = true;
        document.getElementById('courant-impulsionnel-spf').className = 'select_field_o';

    } else if (niveauprotection =='4') {

        document.getElementById('courant-impulsionnel-spf').value = '100.00';
        document.getElementById('courant-impulsionnel-spf').readOnly = true;
        document.getElementById('courant-impulsionnel-spf').className = 'select_field_o';

    } else {

        document.getElementById('courant-impulsionnel-spf').value = '200.00';
        document.getElementById('courant-impulsionnel-spf').readOnly = false;
        document.getElementById('courant-impulsionnel-spf').className = 'select_field';

    }

    calculateSectionConducteurs();


    });

    document.getElementById('courant-impulsionnel-spf').addEventListener('change', calculateSectionConducteurs);
    document.getElementById('coef-repartition-spf').addEventListener('change', calculateSectionConducteurs);
    document.getElementById('temperature-ambiante-spf').addEventListener('change', calculateSectionConducteurs);

    document.getElementById('temperature-initiale').addEventListener('change', calculateSectionConducteursTerre);
    document.getElementById('temperature-finale').addEventListener('change', calculateSectionConducteursTerre);
    document.getElementById('courant-court-circuit').addEventListener('change', calculateSectionConducteursTerre);
    document.getElementById('duree-court-circuit').addEventListener('change', calculateSectionConducteursTerre);


    document.getElementById('niveau-protection-liaisons').addEventListener('change', function() {

    const niveauprotection = document.getElementById('niveau-protection-liaisons').value;

    if (niveauprotection =='1') {

        document.getElementById('courant-impulsionnel-liaisons').value = '200.00';
        document.getElementById('courant-impulsionnel-liaisons').readOnly = true;
        document.getElementById('courant-impulsionnel-liaisons').className = 'select_field_o';
        

    } else if (niveauprotection =='2') {


        document.getElementById('courant-impulsionnel-liaisons').value = '150.00';
        document.getElementById('courant-impulsionnel-liaisons').readOnly = true;
        document.getElementById('courant-impulsionnel-liaisons').className = 'select_field_o';

    } else if (niveauprotection =='3') {

        document.getElementById('courant-impulsionnel-liaisons').value = '100.00';
        document.getElementById('courant-impulsionnel-liaisons').readOnly = true;
        document.getElementById('courant-impulsionnel-liaisons').className = 'select_field_o';

    } else if (niveauprotection =='4') {

        document.getElementById('courant-impulsionnel-liaisons').value = '100.00';
        document.getElementById('courant-impulsionnel-liaisons').readOnly = true;
        document.getElementById('courant-impulsionnel-liaisons').className = 'select_field_o';

    } else {

        document.getElementById('courant-impulsionnel-liaisons').value = '200.00';
        document.getElementById('courant-impulsionnel-liaisons').readOnly = false;
        document.getElementById('courant-impulsionnel-liaisons').className = 'select_field';

    }

    calculateSectionConducteursLiaisons();


    });

    document.getElementById('courant-impulsionnel-liaisons').addEventListener('change', calculateSectionConducteursLiaisons);
    document.getElementById('coef-repartition-liaisons').addEventListener('change', calculateSectionConducteursLiaisons);
    document.getElementById('temperature-ambiante-liaisons').addEventListener('change', calculateSectionConducteursLiaisons);

    document.getElementById('courant-foudre-iimp-in').addEventListener('change', calculcalibredeconnecteur);
    document.getElementById('classe-parafoudre-calibre').addEventListener('change', updateOptions);


    document.getElementById('niveau-protection-option').addEventListener('change', function() {

    const niveauprotection = document.getElementById('niveau-protection-option').value;

    if (niveauprotection =='1') {

        document.getElementById('courant-impulsionnel-angle-protection').value = '3';
        document.getElementById('rayon-sphere-fictive-angle-protection').value = '20';
        document.getElementById('courant-impulsionnel-angle-protection').readOnly = true;
        document.getElementById('courant-impulsionnel-angle-protection').className = 'select_field_o';
        

    } else if (niveauprotection =='2') {


        document.getElementById('courant-impulsionnel-angle-protection').value = '5';
        document.getElementById('rayon-sphere-fictive-angle-protection').value = '30';
        document.getElementById('courant-impulsionnel-angle-protection').readOnly = true;
        document.getElementById('courant-impulsionnel-angle-protection').className = 'select_field_o';

    } else if (niveauprotection =='3') {

        document.getElementById('courant-impulsionnel-angle-protection').value = '10';
        document.getElementById('rayon-sphere-fictive-angle-protection').value = '45';
        document.getElementById('courant-impulsionnel-angle-protection').readOnly = true;
        document.getElementById('courant-impulsionnel-angle-protection').className = 'select_field_o';

    } else if (niveauprotection =='4') {

        document.getElementById('courant-impulsionnel-angle-protection').value = '15';
        document.getElementById('rayon-sphere-fictive-angle-protection').value = '60';
        document.getElementById('courant-impulsionnel-angle-protection').readOnly = true;
        document.getElementById('courant-impulsionnel-angle-protection').className = 'select_field_o';

    } else {

        document.getElementById('courant-impulsionnel-angle-protection').value = '3';
        document.getElementById('rayon-sphere-fictive-angle-protection').value = '20';
        document.getElementById('courant-impulsionnel-angle-protection').readOnly = false;
        document.getElementById('courant-impulsionnel-angle-protection').className = 'select_field';

    }

    calculangleprotection();


    });

    document.getElementById('niveau-protection-option').addEventListener('change', calculangleprotection);
    document.getElementById('courant-impulsionnel-angle-protection').addEventListener('change', calculangleprotection);
    document.getElementById('surelevation-protection').addEventListener('change', calculangleprotection);

    
    document.getElementById('niveau-protection-option-sf').addEventListener('change', function() {

    const niveauprotection = document.getElementById('niveau-protection-option-sf').value;

    if (niveauprotection =='1') {

        document.getElementById('courant-impulsionnel-sphere-fictive').value = '3';
        document.getElementById('rayon-sphere-fictive-sphere-fictive').value = '20';
        document.getElementById('courant-impulsionnel-sphere-fictive').readOnly = true;
        document.getElementById('courant-impulsionnel-sphere-fictive').className = 'select_field_o';
        

    } else if (niveauprotection =='2') {


        document.getElementById('courant-impulsionnel-sphere-fictive').value = '5';
        document.getElementById('rayon-sphere-fictive-sphere-fictive').value = '30';
        document.getElementById('courant-impulsionnel-sphere-fictive').readOnly = true;
        document.getElementById('courant-impulsionnel-sphere-fictive').className = 'select_field_o';

    } else if (niveauprotection =='3') {

        document.getElementById('courant-impulsionnel-sphere-fictive').value = '10';
        document.getElementById('rayon-sphere-fictive-sphere-fictive').value = '45';
        document.getElementById('courant-impulsionnel-sphere-fictive').readOnly = true;
        document.getElementById('courant-impulsionnel-sphere-fictive').className = 'select_field_o';

    } else if (niveauprotection =='4') {

        document.getElementById('courant-impulsionnel-sphere-fictive').value = '15';
        document.getElementById('rayon-sphere-fictive-sphere-fictive').value = '60';
        document.getElementById('courant-impulsionnel-sphere-fictive').readOnly = true;
        document.getElementById('courant-impulsionnel-sphere-fictive').className = 'select_field_o';

    } else {

        document.getElementById('courant-impulsionnel-sphere-fictive').value = '3';
        document.getElementById('rayon-sphere-fictive-sphere-fictive').value = '20';
        document.getElementById('courant-impulsionnel-sphere-fictive').readOnly = false;
        document.getElementById('courant-impulsionnel-sphere-fictive').className = 'select_field';

    }

    calculspherefictive();


    });
    document.getElementById('courant-impulsionnel-sphere-fictive').addEventListener('change', calculspherefictive);
    document.getElementById('niveau-protection-option-sf').addEventListener('change', calculspherefictive);
    document.getElementById('surelevation-protection-sf').addEventListener('change', calculspherefictive);

    document.getElementById('niveau-protection-option-pda').addEventListener('change', calculpda);
    document.getElementById('surelevation-protection-pda').addEventListener('change', calculpda);
    document.getElementById('icpe').addEventListener('change', calculpda);
    document.getElementById('deltaT-pda').addEventListener('change', calculpda);


    document.getElementById('niveau-protection-p').addEventListener('change', function() {

    const niveauprotection = document.getElementById('niveau-protection-p').value;

    if (niveauprotection =='1') {

        document.getElementById('courant-impulsionnel-p').value = '3';
        document.getElementById('rayon-sphere-fictive-p').value = '20';
        document.getElementById('courant-impulsionnel-p').readOnly = true;
        document.getElementById('courant-impulsionnel-p').className = 'select_field_o';
        

    } else if (niveauprotection =='2') {


        document.getElementById('courant-impulsionnel-p').value = '5';
        document.getElementById('rayon-sphere-fictive-p').value = '30';
        document.getElementById('courant-impulsionnel-p').readOnly = true;
        document.getElementById('courant-impulsionnel-p').className = 'select_field_o';

    } else if (niveauprotection =='3') {

        document.getElementById('courant-impulsionnel-p').value = '10';
        document.getElementById('rayon-sphere-fictive-p').value = '45';
        document.getElementById('courant-impulsionnel-p').readOnly = true;
        document.getElementById('courant-impulsionnel-p').className = 'select_field_o';

    } else if (niveauprotection =='4') {

        document.getElementById('courant-impulsionnel-p').value = '15';
        document.getElementById('rayon-sphere-fictive-p').value = '60';
        document.getElementById('courant-impulsionnel-p').readOnly = true;
        document.getElementById('courant-impulsionnel-p').className = 'select_field_o';

    } else {

        document.getElementById('courant-impulsionnel-p').value = '3';
        document.getElementById('rayon-sphere-fictive-p').value = '20';
        document.getElementById('courant-impulsionnel-p').readOnly = false;
        document.getElementById('courant-impulsionnel-p').className = 'select_field';

    }

    calculprofondeurpenetrationsf();


    });
    document.getElementById('courant-impulsionnel-p').addEventListener('change', calculprofondeurpenetrationsf);
    document.getElementById('surelevation-pointe-1').addEventListener('change', calculprofondeurpenetrationsf);
    document.getElementById('surelevation-pointe-2').addEventListener('change', calculprofondeurpenetrationsf);
    document.getElementById('distance-pointes-1-2').addEventListener('change', calculprofondeurpenetrationsf);

    document.getElementById('courant-impulsionnel-blindage').addEventListener('change', function () {

        const courantmax = parseFloat(document.getElementById('courant-impulsionnel-blindage').value);

        if (courantmax<0. || isNaN(courantmax) || courantmax>600) {

            document.getElementById('courant-impulsionnel-blindage').value = '50.00';
        }

        calculsectionecran ();

    });

    document.getElementById('tenue-chocs-equipements-blindage').addEventListener('change', function () {

        const tenuechocs = parseFloat(document.getElementById('tenue-chocs-equipements-blindage').value);

        if (tenuechocs<0. || isNaN(tenuechocs)) {

            document.getElementById('tenue-chocs-equipements-blindage').value = '1.50';
        }

        calculsectionecran ();

    });

    document.getElementById('diametre-moyen-ecran').addEventListener('change', function () {

        const diametreecran = parseFloat(document.getElementById('diametre-moyen-ecran').value);

        if (diametreecran<0. || isNaN(diametreecran)) {

            document.getElementById('diametre-moyen-ecran').value = '20.00';
        }

        calculsectionecran ();

    });


    document.getElementById('resistivite-sol-blindage').addEventListener('change', function () {

        const resistivitesol = parseFloat(document.getElementById('resistivite-sol-blindage').value);

        if (resistivitesol<0. || isNaN(resistivitesol)) {

            document.getElementById('resistivite-sol-blindage').value = '500.0';
        }

        calculsectionecran ();

    });

    document.getElementById('temperature-ambiante-blindage').addEventListener('change', function () {

        const temperatureambiante = parseFloat(document.getElementById('temperature-ambiante-blindage').value);
        const temperaturemaxisolant = parseFloat(document.getElementById('temperature-maximale-isolant-cable-blindage').value);
        
        if (temperatureambiante<0. || isNaN(temperatureambiante) || temperatureambiante>=temperaturemaxisolant ) {

            document.getElementById('temperature-ambiante-blindage').value = '25.0';
        }

        calculsectionecran ();

    });


    document.getElementById('temperature-maximale-isolant-cable-blindage').addEventListener('change', function () {

        const temperaturemaxisolant = parseFloat(document.getElementById('temperature-maximale-isolant-cable-blindage').value);
        const temperatureambiante = parseFloat(document.getElementById('temperature-ambiante-blindage').value);
        
        if (temperaturemaxisolant<0. || isNaN(temperaturemaxisolant) || temperaturemaxisolant<=temperatureambiante ) {

            document.getElementById('temperature-maximale-isolant-cable-blindage').value = '250.0';

        }

        calculsectionecran ();

    });


    document.getElementById('longueur-cable-blindage').addEventListener('change', function () {

        const longueurcable = parseFloat(document.getElementById('longueur-cable-blindage').value);
        
        if (longueurcable<0. || isNaN(longueurcable)) {

            document.getElementById('longueur-cable-blindage').value = '100.0';
        }

        calculsectionecran ();

    });

   



    document.getElementById('etat-ecran-blindage').value = '2';


    document.getElementById('materiau-conducteur-blindage').addEventListener('change', calculsectionecran);

    document.getElementById('etat-ecran-blindage').addEventListener('change', calculsectionecran);
   



let fileHandle;

async function save() {

    const v0 = cliqued_button;
    const v1 = document.getElementById('materiau-conducteur-profondeur').value;
    const v2=document.getElementById('niveau-protection-profondeur').value;   
    const v3=document.getElementById('courant-impulsionnel-profondeur').value;
    const v4 = document.getElementById('chute-tension-profondeur').value;
    const v5=document.getElementById('densite-materiau-profondeur').value;
    const v6=document.getElementById('chaleur-specifique-profondeur').value;
    const v7=document.getElementById('capacite-thermique-profondeur').value;
    const v8=document.getElementById('temperature-fusion-profondeur').value;
    const v9=document.getElementById('temperature-ambiante-profondeur').value;
    const v10=document.getElementById('epaisseur-conducteur-profondeur').value;
    const v11=document.getElementById('profondeur-fusion-conducteur').value;

    const v12=document.getElementById('courant-max-fourrier').value;
    const v13=document.getElementById('coefficient-k-fourrier').value;
    const v14=document.getElementById('constante-temps-to1-fourrier').value;
    const v15=document.getElementById('constante-temps-to2-fourrier').value;
    const v16=document.getElementById('exposant-echantillonnage-fourrier').value;
    const v17=document.getElementById('duree-fourrier').value;
    const v18=document.getElementById('type-choc-fourrier').value;
    const v19=document.getElementById('niveau-protection-fourrier').value;

    const v20=document.getElementById('niveau-protection-elevation').value;   
    const v21=document.getElementById('courant-impulsionnel-elevation').value;
    const v22=document.getElementById('coef-repartition').value;
    const v23=document.getElementById('resistance-ohmique').value;
    const v24=document.getElementById('coefficient-temperature').value;
    const v25=document.getElementById('densite-materiau').value;
    const v26=document.getElementById('capacite-thermique').value;
    const v27=document.getElementById('temperature-fusion').value;
    const v28=document.getElementById('section-conducteur').value;
    const v29=document.getElementById('delta-theta').value;
    const v30=document.getElementById('materiau-conducteur').value;

    const v31 = document.getElementById('materiau-conducteur-spf').value;
    const v32=document.getElementById('niveau-protection-spf').value;   
    const v33=document.getElementById('courant-impulsionnel-spf').value;
    const v34=document.getElementById('coef-repartition-spf').value;
    const v35=document.getElementById('resistance-ohmique-spf').value;
    const v36=document.getElementById('coefficient-temperature-spf').value;
    const v37=document.getElementById('densite-materiau-spf').value;
    const v38=document.getElementById('capacite-thermique-spf').value;
    const v39=document.getElementById('temperature-fusion-spf').value;
    const v40=document.getElementById('temperature-ambiante-spf').value;
    const v41=document.getElementById('section-minimale').value;

    const v42 = document.getElementById('materiau-conducteur-liaisons').value;
    const v43=document.getElementById('niveau-protection-liaisons').value;   
    const v44=document.getElementById('courant-impulsionnel-liaisons').value;
    const v45=document.getElementById('coef-repartition-liaisons').value;
    const v46=document.getElementById('resistance-ohmique-liaisons').value;
    const v47=document.getElementById('coefficient-temperature-liaisons').value;
    const v48=document.getElementById('densite-materiau-liaisons').value;
    const v49=document.getElementById('capacite-thermique-liaisons').value;
    const v50=document.getElementById('temperature-fusion-liaisons').value;
    const v51=document.getElementById('temperature-ambiante-liaisons').value;
    const v52=document.getElementById('section-minimale-liaisons').value;

    const v53 = document.getElementById('materiau-conducteur-terre').value;
    const v54=document.getElementById('courant-court-circuit').value;   
    const v55=document.getElementById('duree-court-circuit').value;  
    const v56=document.getElementById('Qc').value;  
    const v57=document.getElementById('Beta').value;
    const v58=document.getElementById('rho20').value;
    const v59=document.getElementById('temperature-initiale').value;
    const v60=document.getElementById('temperature-finale').value;
    const v61=document.getElementById('section-minimale-terre').value;

    const v62 = document.getElementById('calibre-protection').value;
    const v63 = document.getElementById('classe-parafoudre').value;
    const v64=document.getElementById('section-minimale-raccordement-s1').value;
    const v65=document.getElementById('section-minimale-raccordement-s2').value;

    const v66 = document.getElementById('courant-foudre-iimp-in').value;
    const v67 = document.getElementById('classe-parafoudre-calibre').value;
    const v68 = document.getElementById('calibre-deconnecteur-parafoudre').value;
    const v69 = document.getElementById('current-label').innerText;

    const v70 = document.getElementById('niveau-protection-option').value;
    const v71 = document.getElementById('courant-impulsionnel-angle-protection').value;
    const v72 = document.getElementById('surelevation-protection').value;
    const v73 = document.getElementById('rayon-sphere-fictive-angle-protection').value;
    const v74 = document.getElementById('angle-protection').value;
    const v75 = document.getElementById('rayon-protection-angle-protection').value;

    const v76 = document.getElementById('niveau-protection-option-sf').value;
    const v77 = document.getElementById('courant-impulsionnel-sphere-fictive').value;
    const v78 = document.getElementById('surelevation-protection-sf').value;
    const v79 = document.getElementById('rayon-sphere-fictive-sphere-fictive').value;
    const v80 = document.getElementById('rayon-protection-sphere-fictive').value;

    const v81 = document.getElementById('niveau-protection-p').value;
    const v82 = document.getElementById('courant-impulsionnel-p').value;
    const v83 = document.getElementById('surelevation-pointe-1').value;
    const v84 = document.getElementById('surelevation-pointe-2').value;
    const v85 = document.getElementById('distance-pointes-1-2').value;
    const v86 = document.getElementById('rayon-sphere-fictive-p').value;
    const v87 = document.getElementById('centre-x0-sphere').value;
    const v88 = document.getElementById('centre-y0-sphere').value;
    const v89 = document.getElementById('profondeur-penetration-petitepointe').value;

    const v90 = document.getElementById('niveau-protection-option-pda').value;
    const v91 = document.getElementById('icpe').value;
    const v92 = document.getElementById('surelevation-protection-pda').value;
    const v93 = document.getElementById('rayon-sphere-fictive-pda').value;
    const v94 = document.getElementById('deltaT-pda').value;
    const v95 = document.getElementById('rayon-protection-pda').value;

    const v96 = document.getElementById('niveau-protection-force').value;
    const v97 = document.getElementById('courant-max-force').value;
    const v98 = document.getElementById('dropdown-menu-force').value;
    const v99 = document.getElementById('distance-entre-fixations').value;
    const v100 = document.getElementById('position-conducteur-x0').value;
    const v101 = document.getElementById('position-conducteur-y0').value;
    const v102 = document.getElementById('angle-inclinaison-mur').value;
    const v103 = document.getElementById('coefficient-repartition-force').value;
    const v104 = document.getElementById('force-resultante-traction').value;
    const v105 = document.getElementById('force-resultante-cisaillement').value;
    const options_force1 = document.getElementById('dropdown-menu-force').options;
    const options_force = Array.from(options_force1, option => option.text);
    //const dropdownmenuforcevalue = document.getElementById('dropdown-menu-force').value;

    const v106 = document.getElementById('niveau-protection-cheminement').value;
    const v107 = document.getElementById('courant-total-cheminement').value;
    const v108 = document.getElementById('impedance-prise-terre').value;
    const v109 = document.getElementById('courant-prise-terre').value;
    const v110 = document.getElementById('nombre-conducteurs').value;
    const v111 = document.getElementById('impedance-cheminement').value;
    const v112= document.getElementById('coefficient-repartition').value;
    const v113 = document.getElementById('courant-iimp-cheminement-selectionne').value;
    const v114 = document.getElementById('dropdown-menu-cheminement').value;
    const options_cheminement1 = document.getElementById('dropdown-menu-cheminement').options;
    const options_cheminement = Array.from(options_cheminement1, option => option.text);

    const v115 = document.getElementById('niveau-protection-champ-direct-zpf1').value;
    const v116 = document.getElementById('type-choc-champ-direct-zpf1').value
    const v117 = document.getElementById('distance-point-mur-direct-zpf1').value;
    const v118 = document.getElementById('distance-point-toit-direct-zpf1').value;
    const v119 = document.getElementById('courant-max-champ-direct-zpf1').value;
    const v120 = document.getElementById('reseau-equipotentialite-direct').value;
    const v121 = document.getElementById('taille-mailles-batiment-direct-zpf1').value;
    const v122 = document.getElementById('diametre-conducteurs-ecran-batiment-direct-zpf1').value;
    const v123 = document.getElementById('type-materiau-champ-direct-zpf1-label').value;
    const v124 = document.getElementById('facteur-ecran-direct-zpf1').value;
    const v125 = document.getElementById('distance-securite-direct-zpf1').value;
    const v126 = document.getElementById('champ-magnetrique-avec-ecran-direct-zpf1').value;
    const v127 = document.getElementById('facteur-global-ecran-direct-zpf1').value;
    const v128 = document.getElementById('dropdown-menu-zpf-direct').value;
    const options_champdirect1 = document.getElementById('dropdown-menu-zpf-direct').options;
    const options_champdirect = Array.from(options_champdirect1, option => option.text);

    const v129 = document.getElementById('niveau-protection-champ-indirect-zpf1').value;
    const v130 = document.getElementById('type-choc-champ-indirect-zpf1').value;
    const v131 = document.getElementById('hauteur-batiment-champ-indirect-zpf1').value;
    const v132 = document.getElementById('longueur-batiment-champ-indirect-zpf1').value;
    const v133 = document.getElementById('courant-max-champ-indirect-zpf1').value;
    const v134 = document.getElementById('distance-indirect-zpf1').value;
    const v135 = document.getElementById('rayon-sf-indirect-zpf1').value;
    const v136 = document.getElementById('reseau-equipotentialite-indirect').value;
    const v137 = document.getElementById('taille-mailles-batiment-indirect-zpf1').value;
    const v138 = document.getElementById('diametre-conducteurs-ecran-batiment-indirect-zpf1').value;
    const v139 = document.getElementById('type-materiau-champ-indirect-zpf1').value;
    const v140 = document.getElementById('facteur-ecran-indirect-zpf1').value;
    const v141 = document.getElementById('distance-securite-indirect-zpf1').value;
    const v142 = document.getElementById('champ-magnetrique-sans-ecran-indirect-zpf1').value;
    const v143 = document.getElementById('champ-magnetrique-avec-ecran-indirect-zpf1').value;
    const v144 = document.getElementById('facteur-global-ecran-indirect-zpf1').value;
    const v145 = document.getElementById('dropdown-menu-zpf').value;
    const options_champindirect1 = document.getElementById('dropdown-menu-zpf').options;
    const options_champindirect = Array.from(options_champindirect1, option => option.text);

    const v146 = document.getElementById('niveau-protection-kta2206').value;
    const v147 = document.getElementById('type-choc-foudre-kta2206').value;
    const v148 = document.getElementById('courant-max-kta2206').value;
    const v149 = document.getElementById('resistivite-sol-kta2206').value;
    const v150 = document.getElementById('courant-prise-terre-kta2206').value;
    const v151 = document.getElementById('facteur-foudre-k-kta2206').value;
    const v152 = document.getElementById('impedance-couplage-kta2206').value;
    const v153 = document.getElementById('type-cable-kta2206').value;
    const v154 = document.getElementById('coefficient-ponderation-conducteur-kta2206').value;
    const v155 = document.getElementById('type-buse-kta2206').value;
    const v156 = document.getElementById('longueur-galerie-kta2206').value;
    const v157 = document.getElementById('nombre-liaisons-jd-kta2206').value;
    const v158 = document.getElementById('nombre-jd-galerie-kta2206').value;
    const v159 = document.getElementById('tenue-equipements-kta2206').value;
    const v160 = document.getElementById('coefficient-ponderation-galerie-kta2206').value;
    const v161 = document.getElementById('extension-fictive-kta2206').value;
    const v162 = document.getElementById('courant-partiel-galerie-kta2206').value;
    const v163 = document.getElementById('tension-induite-kta2206').value;
    const v164 = document.getElementById('dropdown-menu-conducteur-kta2206').value;
    const v165 = document.getElementById('dropdown-menu-buse-kta2206').value;
    const options_conducteurKTA22061 = document.getElementById('dropdown-menu-conducteur-kta2206').options;
    const options_conducteurKTA2206 = Array.from(options_conducteurKTA22061, option => option.text);
    const options_buseKTA22061 = document.getElementById('dropdown-menu-buse-kta2206').options;
    const options_buseKTA2206 = Array.from(options_buseKTA22061, option => option.text);

    const v166 = document.getElementById('materiau-conducteur-blindage').value;
    const v167 = document.getElementById('courant-impulsionnel-blindage').value;
    const v168 = document.getElementById('resistivite-blindage').value;
    const v169 = document.getElementById('tenue-chocs-equipements-blindage').value;
    const v170 = document.getElementById('diametre-moyen-ecran').value;
    const v171 = document.getElementById('resistivite-sol-blindage').value;
    const v172 = document.getElementById('etat-ecran-blindage').value;
    const v173 = document.getElementById('longueur-cable-blindage').value;
    const v174 = document.getElementById('temperature-ambiante-blindage').value;
    const v175 = document.getElementById('temperature-maximale-isolant-cable-blindage').value;
    const v176 = document.getElementById('section-ecran-blindage').value;
    const v177 = document.getElementById('epaisseur-ecran-blindage').value;
  


    const data = {
        v0,
        v1,
        v2,
        v3,
        v4,
        v5,
        v6,
        v7,
        v8,
        v9,
        v10,
        v11,
        v12,
        v13,
        v14,
        v15,
        v16,
        v17,
        v18,
        v19,
        v20,
        v21,
        v22,
        v23,
        v24,
        v25,
        v26,
        v27,
        v28,
        v29,
        v30,
        v31,
        v32,
        v33,
        v34,
        v35,
        v36,
        v37,
        v38,
        v39,
        v40,
        v41,
        v42,
        v43,
        v44,
        v45,
        v46,
        v47,
        v48,
        v49,
        v50,
        v51,
        v52, 
        v53,
        v54,
        v55,
        v56,
        v57,
        v58,
        v59,
        v60,
        v61,
        v62,
        v63,
        v64,
        v65,
        v66,
        v67,
        v68,
        v69,
        v70,
        v71,
        v72,
        v73,
        v74,
        v75,
        v76,
        v77,
        v78,
        v79,
        v80,
        v81,
        v82,
        v83,
        v84,
        v85,
        v86,
        v87,
        v88,
        v89,
        v90,
        v91,
        v92,
        v93,
        v94,
        v95,
        v96, 
        v97,
        v98, 
        v99, 
        v100,
        v101,
        v102,
        v103,
        v104,
        v105,
        options_force,
        ConducteurData,
        ConducteurCounter,
        v106,
        v107,
        v108,
        v109,
        v110,
        v111,
        v112,
        v113,
        v114,
        CheminementData,
        CheminementCounter,
        options_cheminement,
        v115,
        v116,
        v117,
        v118,
        v119,
        v120,
        v121,
        v122,
        v123,
        v124,
        v125,
        v126,
        v127,
        v128,
        options_champdirect,
        zpfdirectCounter,
        ZPFDataDirect,
        v129,
        v130,
        v131,
        v132,
        v133,
        v134,
        v135,
        v136,
        v137,
        v138,
        v139,
        v140,
        v141,
        v142,
        v143,
        v144,
        v145,
        options_champindirect,
        zpfCounter,
        ZPFData,
        v146,
        v147,
        v148,
        v149,
        v150,
        v151,
        v152,
        v153,
        v154,
        v155,
        v156,
        v157,
        v158,
        v159,
        v160,
        v161,
        v162,
        v163,
        v164,
        v165,
        options_conducteurKTA2206,
        options_buseKTA2206,
        ElementConducteurData,
        GalerieData,
        ElementConducteurCounter,
        GalerieCounter,
        v166,
        v167,
        v168,
        v169,
        v170,
        v171,
        v172,
        v173,
        v174,
        v175,
        v176,
        v177,

        mission_dv:'dv'
    };




    const jsonData = JSON.stringify(data, null, 2);
    const blob = new Blob([jsonData], { type: 'application/json' });

    try {
        if (!fileHandle) {

            const suggestedName = fileName || 'dv_calculs_divers.json'; // Use stored fileName or default
            // If no file handle, ask the user to pick a file and save for the first time
            fileHandle = await showSaveFilePicker({
                suggestedName: suggestedName,
                types: [{
                    description: 'JSON Files',
                    accept: { 'application/json': ['.json'] },
                }],
            });

            fileName = fileHandle.name; // Store the new file name if a new file is picked
        }

        // Create a writable stream and write the blob to the file
        const writableStream = await fileHandle.createWritable();
        await writableStream.write(blob);
        await writableStream.close();
        //alert('Fichier enregistré avec succès.');
    } catch (err) {
        if (err.name === 'AbortError') {
            //console.warn('Ouverture du fichier a été abandonnée.');
        } else {
            //console.error('Erreur de lecture du fichier:', err);
        }
    }
}

// Save As function
async function save_as() {

    const v0 = cliqued_button;
    const v1 = document.getElementById('materiau-conducteur-profondeur').value;
    const v2=document.getElementById('niveau-protection-profondeur').value;   
    const v3=document.getElementById('courant-impulsionnel-profondeur').value;
    const v4 = document.getElementById('chute-tension-profondeur').value;
    const v5=document.getElementById('densite-materiau-profondeur').value;
    const v6=document.getElementById('chaleur-specifique-profondeur').value;
    const v7=document.getElementById('capacite-thermique-profondeur').value;
    const v8=document.getElementById('temperature-fusion-profondeur').value;
    const v9=document.getElementById('temperature-ambiante-profondeur').value;
    const v10=document.getElementById('epaisseur-conducteur-profondeur').value;
    const v11=document.getElementById('profondeur-fusion-conducteur').value;

    const v12=document.getElementById('courant-max-fourrier').value;
    const v13=document.getElementById('coefficient-k-fourrier').value;
    const v14=document.getElementById('constante-temps-to1-fourrier').value;
    const v15=document.getElementById('constante-temps-to2-fourrier').value;
    const v16=document.getElementById('exposant-echantillonnage-fourrier').value;
    const v17=document.getElementById('duree-fourrier').value;
    const v18=document.getElementById('type-choc-fourrier').value;
    const v19=document.getElementById('niveau-protection-fourrier').value;

    const v20=document.getElementById('niveau-protection-elevation').value;   
    const v21=document.getElementById('courant-impulsionnel-elevation').value;
    const v22=document.getElementById('coef-repartition').value;
    const v23=document.getElementById('resistance-ohmique').value;
    const v24=document.getElementById('coefficient-temperature').value;
    const v25=document.getElementById('densite-materiau').value;
    const v26=document.getElementById('capacite-thermique').value;
    const v27=document.getElementById('temperature-fusion').value;
    const v28=document.getElementById('section-conducteur').value;
    const v29=document.getElementById('delta-theta').value;
    const v30=document.getElementById('materiau-conducteur').value;

    const v31 = document.getElementById('materiau-conducteur-spf').value;
    const v32=document.getElementById('niveau-protection-spf').value;   
    const v33=document.getElementById('courant-impulsionnel-spf').value;
    const v34=document.getElementById('coef-repartition-spf').value;
    const v35=document.getElementById('resistance-ohmique-spf').value;
    const v36=document.getElementById('coefficient-temperature-spf').value;
    const v37=document.getElementById('densite-materiau-spf').value;
    const v38=document.getElementById('capacite-thermique-spf').value;
    const v39=document.getElementById('temperature-fusion-spf').value;
    const v40=document.getElementById('temperature-ambiante-spf').value;
    const v41=document.getElementById('section-minimale').value;

    const v42 = document.getElementById('materiau-conducteur-liaisons').value;
    const v43=document.getElementById('niveau-protection-liaisons').value;   
    const v44=document.getElementById('courant-impulsionnel-liaisons').value;
    const v45=document.getElementById('coef-repartition-liaisons').value;
    const v46=document.getElementById('resistance-ohmique-liaisons').value;
    const v47=document.getElementById('coefficient-temperature-liaisons').value;
    const v48=document.getElementById('densite-materiau-liaisons').value;
    const v49=document.getElementById('capacite-thermique-liaisons').value;
    const v50=document.getElementById('temperature-fusion-liaisons').value;
    const v51=document.getElementById('temperature-ambiante-liaisons').value;
    const v52=document.getElementById('section-minimale-liaisons').value;

    const v53 = document.getElementById('materiau-conducteur-terre').value;
    const v54=document.getElementById('courant-court-circuit').value;   
    const v55=document.getElementById('duree-court-circuit').value;  
    const v56=document.getElementById('Qc').value;  
    const v57=document.getElementById('Beta').value;
    const v58=document.getElementById('rho20').value;
    const v59=document.getElementById('temperature-initiale').value;
    const v60=document.getElementById('temperature-finale').value;
    const v61=document.getElementById('section-minimale-terre').value;

    const v62 = document.getElementById('calibre-protection').value;
    const v63 = document.getElementById('classe-parafoudre').value;
    const v64=document.getElementById('section-minimale-raccordement-s1').value;
    const v65=document.getElementById('section-minimale-raccordement-s2').value;

    const v66 = document.getElementById('courant-foudre-iimp-in').value;
    const v67 = document.getElementById('classe-parafoudre-calibre').value;
    const v68 = document.getElementById('calibre-deconnecteur-parafoudre').value;
    const v69 = document.getElementById('current-label').innerText;

    const v70 = document.getElementById('niveau-protection-option').value;
    const v71 = document.getElementById('courant-impulsionnel-angle-protection').value;
    const v72 = document.getElementById('surelevation-protection').value;
    const v73 = document.getElementById('rayon-sphere-fictive-angle-protection').value;
    const v74 = document.getElementById('angle-protection').value;
    const v75 = document.getElementById('rayon-protection-angle-protection').value;

    const v76 = document.getElementById('niveau-protection-option-sf').value;
    const v77 = document.getElementById('courant-impulsionnel-sphere-fictive').value;
    const v78 = document.getElementById('surelevation-protection-sf').value;
    const v79 = document.getElementById('rayon-sphere-fictive-sphere-fictive').value;
    const v80 = document.getElementById('rayon-protection-sphere-fictive').value;

    const v81 = document.getElementById('niveau-protection-p').value;
    const v82 = document.getElementById('courant-impulsionnel-p').value;
    const v83 = document.getElementById('surelevation-pointe-1').value;
    const v84 = document.getElementById('surelevation-pointe-2').value;
    const v85 = document.getElementById('distance-pointes-1-2').value;
    const v86 = document.getElementById('rayon-sphere-fictive-p').value;
    const v87 = document.getElementById('centre-x0-sphere').value;
    const v88 = document.getElementById('centre-y0-sphere').value;
    const v89 = document.getElementById('profondeur-penetration-petitepointe').value;

    const v90 = document.getElementById('niveau-protection-option-pda').value;
    const v91 = document.getElementById('icpe').value;
    const v92 = document.getElementById('surelevation-protection-pda').value;
    const v93 = document.getElementById('rayon-sphere-fictive-pda').value;
    const v94 = document.getElementById('deltaT-pda').value;
    const v95 = document.getElementById('rayon-protection-pda').value;

    const v96 = document.getElementById('niveau-protection-force').value;
    const v97 = document.getElementById('courant-max-force').value;
    const v98 = document.getElementById('dropdown-menu-force').value;
    const v99 = document.getElementById('distance-entre-fixations').value;
    const v100 = document.getElementById('position-conducteur-x0').value;
    const v101 = document.getElementById('position-conducteur-y0').value;
    const v102 = document.getElementById('angle-inclinaison-mur').value;
    const v103 = document.getElementById('coefficient-repartition-force').value;
    const v104 = document.getElementById('force-resultante-traction').value;
    const v105 = document.getElementById('force-resultante-cisaillement').value;
    const options_force1 = document.getElementById('dropdown-menu-force').options;
    const options_force = Array.from(options_force1, option => option.text);
    //const dropdownmenuforcevalue = document.getElementById('dropdown-menu-force').value;

    const v106 = document.getElementById('niveau-protection-cheminement').value;
    const v107 = document.getElementById('courant-total-cheminement').value;
    const v108 = document.getElementById('impedance-prise-terre').value;
    const v109 = document.getElementById('courant-prise-terre').value;
    const v110 = document.getElementById('nombre-conducteurs').value;
    const v111 = document.getElementById('impedance-cheminement').value;
    const v112= document.getElementById('coefficient-repartition').value;
    const v113 = document.getElementById('courant-iimp-cheminement-selectionne').value;
    const v114 = document.getElementById('dropdown-menu-cheminement').value;
    const options_cheminement1 = document.getElementById('dropdown-menu-cheminement').options;
    const options_cheminement = Array.from(options_cheminement1, option => option.text);

    const v115 = document.getElementById('niveau-protection-champ-direct-zpf1').value;
    const v116 = document.getElementById('type-choc-champ-direct-zpf1').value
    const v117 = document.getElementById('distance-point-mur-direct-zpf1').value;
    const v118 = document.getElementById('distance-point-toit-direct-zpf1').value;
    const v119 = document.getElementById('courant-max-champ-direct-zpf1').value;
    const v120 = document.getElementById('reseau-equipotentialite-direct').value;
    const v121 = document.getElementById('taille-mailles-batiment-direct-zpf1').value;
    const v122 = document.getElementById('diametre-conducteurs-ecran-batiment-direct-zpf1').value;
    const v123 = document.getElementById('type-materiau-champ-direct-zpf1-label').value;
    const v124 = document.getElementById('facteur-ecran-direct-zpf1').value;
    const v125 = document.getElementById('distance-securite-direct-zpf1').value;
    const v126 = document.getElementById('champ-magnetrique-avec-ecran-direct-zpf1').value;
    const v127 = document.getElementById('facteur-global-ecran-direct-zpf1').value;
    const v128 = document.getElementById('dropdown-menu-zpf-direct').value;
    const options_champdirect1 = document.getElementById('dropdown-menu-zpf-direct').options;
    const options_champdirect = Array.from(options_champdirect1, option => option.text);

    const v129 = document.getElementById('niveau-protection-champ-indirect-zpf1').value;
    const v130 = document.getElementById('type-choc-champ-indirect-zpf1').value;
    const v131 = document.getElementById('hauteur-batiment-champ-indirect-zpf1').value;
    const v132 = document.getElementById('longueur-batiment-champ-indirect-zpf1').value;
    const v133 = document.getElementById('courant-max-champ-indirect-zpf1').value;
    const v134 = document.getElementById('distance-indirect-zpf1').value;
    const v135 = document.getElementById('rayon-sf-indirect-zpf1').value;
    const v136 = document.getElementById('reseau-equipotentialite-indirect').value;
    const v137 = document.getElementById('taille-mailles-batiment-indirect-zpf1').value;
    const v138 = document.getElementById('diametre-conducteurs-ecran-batiment-indirect-zpf1').value;
    const v139 = document.getElementById('type-materiau-champ-indirect-zpf1').value;
    const v140 = document.getElementById('facteur-ecran-indirect-zpf1').value;
    const v141 = document.getElementById('distance-securite-indirect-zpf1').value;
    const v142 = document.getElementById('champ-magnetrique-sans-ecran-indirect-zpf1').value;
    const v143 = document.getElementById('champ-magnetrique-avec-ecran-indirect-zpf1').value;
    const v144 = document.getElementById('facteur-global-ecran-indirect-zpf1').value;
    const v145 = document.getElementById('dropdown-menu-zpf').value;
    const options_champindirect1 = document.getElementById('dropdown-menu-zpf').options;
    const options_champindirect = Array.from(options_champindirect1, option => option.text);

    const v146 = document.getElementById('niveau-protection-kta2206').value;
    const v147 = document.getElementById('type-choc-foudre-kta2206').value;
    const v148 = document.getElementById('courant-max-kta2206').value;
    const v149 = document.getElementById('resistivite-sol-kta2206').value;
    const v150 = document.getElementById('courant-prise-terre-kta2206').value;
    const v151 = document.getElementById('facteur-foudre-k-kta2206').value;
    const v152 = document.getElementById('impedance-couplage-kta2206').value;
    const v153 = document.getElementById('type-cable-kta2206').value;
    const v154 = document.getElementById('coefficient-ponderation-conducteur-kta2206').value;
    const v155 = document.getElementById('type-buse-kta2206').value;
    const v156 = document.getElementById('longueur-galerie-kta2206').value;
    const v157 = document.getElementById('nombre-liaisons-jd-kta2206').value;
    const v158 = document.getElementById('nombre-jd-galerie-kta2206').value;
    const v159 = document.getElementById('tenue-equipements-kta2206').value;
    const v160 = document.getElementById('coefficient-ponderation-galerie-kta2206').value;
    const v161 = document.getElementById('extension-fictive-kta2206').value;
    const v162 = document.getElementById('courant-partiel-galerie-kta2206').value;
    const v163 = document.getElementById('tension-induite-kta2206').value;
    const v164 = document.getElementById('dropdown-menu-conducteur-kta2206').value;
    const v165 = document.getElementById('dropdown-menu-buse-kta2206').value;
    const options_conducteurKTA22061 = document.getElementById('dropdown-menu-conducteur-kta2206').options;
    const options_conducteurKTA2206 = Array.from(options_conducteurKTA22061, option => option.text);
    const options_buseKTA22061 = document.getElementById('dropdown-menu-buse-kta2206').options;
    const options_buseKTA2206 = Array.from(options_buseKTA22061, option => option.text);

    const v166 = document.getElementById('materiau-conducteur-blindage').value;
    const v167 = document.getElementById('courant-impulsionnel-blindage').value;
    const v168 = document.getElementById('resistivite-blindage').value;
    const v169 = document.getElementById('tenue-chocs-equipements-blindage').value;
    const v170 = document.getElementById('diametre-moyen-ecran').value;
    const v171 = document.getElementById('resistivite-sol-blindage').value;
    const v172 = document.getElementById('etat-ecran-blindage').value;
    const v173 = document.getElementById('longueur-cable-blindage').value;
    const v174 = document.getElementById('temperature-ambiante-blindage').value;
    const v175 = document.getElementById('temperature-maximale-isolant-cable-blindage').value;
    const v176 = document.getElementById('section-ecran-blindage').value;
    const v177 = document.getElementById('epaisseur-ecran-blindage').value;
  


    const data = {
        v0,
        v1,
        v2,
        v3,
        v4,
        v5,
        v6,
        v7,
        v8,
        v9,
        v10,
        v11,
        v12,
        v13,
        v14,
        v15,
        v16,
        v17,
        v18,
        v19,
        v20,
        v21,
        v22,
        v23,
        v24,
        v25,
        v26,
        v27,
        v28,
        v29,
        v30,
        v31,
        v32,
        v33,
        v34,
        v35,
        v36,
        v37,
        v38,
        v39,
        v40,
        v41,
        v42,
        v43,
        v44,
        v45,
        v46,
        v47,
        v48,
        v49,
        v50,
        v51,
        v52, 
        v53,
        v54,
        v55,
        v56,
        v57,
        v58,
        v59,
        v60,
        v61,
        v62,
        v63,
        v64,
        v65,
        v66,
        v67,
        v68,
        v69,
        v70,
        v71,
        v72,
        v73,
        v74,
        v75,
        v76,
        v77,
        v78,
        v79,
        v80,
        v81,
        v82,
        v83,
        v84,
        v85,
        v86,
        v87,
        v88,
        v89,
        v90,
        v91,
        v92,
        v93,
        v94,
        v95,
        v96, 
        v97,
        v98, 
        v99, 
        v100,
        v101,
        v102,
        v103,
        v104,
        v105,
        options_force,
        ConducteurData,
        ConducteurCounter,
        v106,
        v107,
        v108,
        v109,
        v110,
        v111,
        v112,
        v113,
        v114,
        CheminementData,
        CheminementCounter,
        options_cheminement,
        v115,
        v116,
        v117,
        v118,
        v119,
        v120,
        v121,
        v122,
        v123,
        v124,
        v125,
        v126,
        v127,
        v128,
        options_champdirect,
        zpfdirectCounter,
        ZPFDataDirect,
        v129,
        v130,
        v131,
        v132,
        v133,
        v134,
        v135,
        v136,
        v137,
        v138,
        v139,
        v140,
        v141,
        v142,
        v143,
        v144,
        v145,
        options_champindirect,
        zpfCounter,
        ZPFData,
        v146,
        v147,
        v148,
        v149,
        v150,
        v151,
        v152,
        v153,
        v154,
        v155,
        v156,
        v157,
        v158,
        v159,
        v160,
        v161,
        v162,
        v163,
        v164,
        v165,
        options_conducteurKTA2206,
        options_buseKTA2206,
        ElementConducteurData,
        GalerieData,
        ElementConducteurCounter,
        GalerieCounter,
        v166,
        v167,
        v168,
        v169,
        v170,
        v171,
        v172,
        v173,
        v174,
        v175,
        v176,
        v177,

        mission_dv:'dv'
    };






    const jsonData = JSON.stringify(data, null, 2);
    const blob = new Blob([jsonData], { type: 'application/json' });

    if (window.showSaveFilePicker) {
        // Use File System Access API if available
        try {

            const suggestedName = fileName || 'dv_calculs_divers.json'; // Use stored fileName or default
            // Open a file picker to select the file to save
            fileHandle = await showSaveFilePicker({
                suggestedName: suggestedName,
                types: [{
                    description: 'JSON Files',
                    accept: { 'application/json': ['.json'] },
                }],
            });

            fileName = fileHandle.name; // Store the file name

            // Create a writable stream and write the blob to the file
            const writableStream = await fileHandle.createWritable();
            await writableStream.write(blob);
            await writableStream.close();
            
            //alert('Fichier enregistré avec succès.');
        } catch (err) {
            if (err.name === 'AbortError') {
                //console.warn('Ouverture du fichier a été abandonnée.');
            } else {
                //console.error('Erreur de lecture du fichier:', err);
            }
        }
    } else {
        // Fallback for browsers without File System Access API
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = 'dv_calculs_divers.json';
        a.click();
        URL.revokeObjectURL(url);
    }
 
 
}


let fileName;

document.getElementById('ouvrir').addEventListener('click', async (event) => {
    try {
        // Open file picker and get the file handle
        [fileHandle] = await window.showOpenFilePicker({
            types: [{
                description: 'JSON Files',
                accept: { 'application/json': ['.json'] },
            }],
        });

        fileName = fileHandle.name; // Store the file name

        const file = await fileHandle.getFile(); // Get the file object from the file handle

    const reader = new FileReader();
    reader.onload = function(e) {

    try {
    const data = JSON.parse(e.target.result);


    const prefixeAttendu = 'dv_';


    if (!data.mission_dv|| (!file.name.startsWith(prefixeAttendu))) {

        alert('Fichier invalide');

        return


    }

    
    // Replace the existing arrays with the loaded data
    const v0 = data.v0 || null;
    const v1 = data.v1 || null;
    const v2 = data.v2 || null;
    const v3 = data.v3 || null;
    const v4 = data.v4 || null;
    const v5 = data.v5 || null;
    const v6 = data.v6 || null;
    const v7 = data.v7 || null;
    const v8 = data.v8 || null;
    const v9 = data.v9 || null;
    const v10 = data.v10 || null;
    const v11 = data.v11 || null;
    const v12 = data.v12 || null;
    const v13 = data.v13 || null;
    const v14 = data.v14 || null;
    const v15 = data.v15 || null;
    const v16 = data.v16 || null;
    const v17 = data.v17 || null;
    const v18 = data.v18 || null;
    const v19 = data.v19 || null
    const v20 = data.v20 || null;
    const v21 = data.v21 || null;
    const v22 = data.v22 || null;
    const v23 = data.v23 || null;
    const v24 = data.v24 || null;
    const v25 = data.v25 || null;
    const v26 = data.v26 || null;
    const v27 = data.v27 || null;
    const v28 = data.v28 || null;
    const v29 = data.v29 || null;
    const v30 = data.v30 || null;
    const v31 = data.v31 || null;
    const v32 = data.v32 || null;
    const v33 = data.v33 || null;
    const v34 = data.v34 || null;
    const v35 = data.v35 || null;
    const v36 = data.v36 || null;
    const v37 = data.v37 || null;
    const v38 = data.v38 || null;
    const v39 = data.v39 || null;
    const v40 = data.v40 || null;
    const v41 = data.v41 || null;
    const v42 = data.v42 || null;
    const v43 = data.v43 || null;
    const v44 = data.v44 || null;
    const v45 = data.v45 || null;
    const v46 = data.v46 || null;
    const v47 = data.v47 || null;
    const v48 = data.v48 || null;
    const v49 = data.v49 || null;
    const v50 = data.v50 || null;
    const v51 = data.v51 || null;
    const v52 = data.v52 || null;
    const v53 = data.v53 || null;
    const v54 = data.v54 || null;
    const v55 = data.v55 || null;
    const v56 = data.v56 || null;   
    const v57 = data.v57 || null;
    const v58 = data.v58 || null;
    const v59 = data.v59 || null;
    const v60 = data.v60 || null;
    const v61 = data.v61 || null;
    const v62 = data.v62 || null;
    const v63 = data.v63 || null;
    const v64 = data.v64 || null;
    const v65 = data.v65 || null;
    const v66 = data.v66 || null;
    const v67 = data.v67 || null;
    const v68 = data.v68 || null;
    const v69 = data.v69 || null;
    const v70 = data.v70 || null;
    const v71 = data.v71 || null;
    const v72 = data.v72 || null;
    const v73 = data.v73 || null;
    const v74 = data.v74 || null;
    const v75 = data.v75 || null;
    const v76 = data.v76 || null;
    const v77 = data.v77 || null;
    const v78 = data.v78 || null;
    const v79 = data.v79 || null;
    const v80 = data.v80 || null;
    const v81 = data.v81 || null;
    const v82 = data.v82 || null;
    const v83 = data.v83 || null;
    const v84 = data.v84 || null;
    const v85 = data.v85 || null;
    const v86 = data.v86 || null;
    const v87 = data.v87 || null;
    const v88 = data.v88 || null;
    const v89 = data.v89 || null;
    const v90 = data.v90 || null;
    const v91 = data.v91 || null;
    const v92 = data.v92 || null;
    const v93 = data.v93 || null;
    const v94 = data.v94 || null;
    const v95 = data.v95 || null;
    const v96 = data.v96 || null;
    const v97 = data.v97 || null;
    const v98 = data.v98 || null;
    const v99 = data.v99 || null;
    const v100 = data.v100 || null;
    const v101 = data.v101 || null;
    const v102 = data.v102 || null;
    const v103 = data.v103 || null;
    const v104 = data.v104 || null;
    const v105 = data.v105 || null;
    const v106 = data.v106 || null;
    const v107 = data.v107 || null;
    const v108 = data.v108 || null;
    const v109 = data.v109 || null;
    const v110 = data.v110 || null;
    const v111 = data.v111 || null;
    const v112 = data.v112 || null;
    const v113 = data.v113 || null;
    const v114 = data.v114 || null;
    const v115 = data.v115 || null;
    const v116 = data.v116 || null;
    const v117 = data.v117 || null;
    const v118 = data.v118 || null;
    const v119 = data.v119 || null;
    const v120 = data.v120 || null;
    const v121 = data.v121 || null;
    const v122 = data.v122 || null;
    const v123 = data.v123 || null;
    const v124 = data.v124 || null;
    const v125 = data.v125 || null;
    const v126 = data.v126 || null;
    const v127 = data.v127 || null;
    const v128 = data.v128 || null;
    const v129 = data.v129 || null;
    const v130 = data.v130 || null;
    const v131 = data.v131 || null;
    const v132 = data.v132 || null;
    const v133 = data.v133 || null;
    const v134 = data.v134 || null;
    const v135 = data.v135 || null;
    const v136 = data.v136 || null;
    const v137 = data.v137 || null;
    const v138= data.v138 || null;
    const v139 = data.v139 || null;
    const v140 = data.v140 || null;
    const v141 = data.v141 || null;
    const v142 = data.v142 || null;
    const v143 = data.v143 || null;
    const v144 = data.v144 || null;
    const v145 = data.v145 || null;
    const v146 = data.v146 || null;
    const v147 = data.v147 || null;
    const v148 = data.v148 || null;
    const v149 = data.v149 || null;
    const v150 = data.v150 || null;
    const v151 = data.v151 || null;
    const v152 = data.v152 || null;
    const v153 = data.v153 || null;
    const v154 = data.v154 || null;
    const v155 = data.v155 || null;
    const v156 = data.v156 || null;
    const v157 = data.v157 || null;
    const v158 = data.v158 || null;
    const v159 = data.v159 || null;
    const v160 = data.v160 || null;
    const v161 = data.v161 || null;
    const v162 = data.v162 || null;
    const v163 = data.v163 || null;
    const v164 = data.v164 || null;
    const v165 = data.v165 || null;
    const v166 = data.v166 || null;
    const v167 = data.v167 || null;
    const v168 = data.v168 || null;
    const v169 = data.v169 || null;
    const v170 = data.v170 || null;
    const v171 = data.v171 || null;
    const v172 = data.v172 || null;
    const v173 = data.v173 || null;
    const v174 = data.v174 || null;
    const v175 = data.v175 || null;
    const v176 = data.v176 || null;
    const v177 = data.v177 || null;
   

    cliqued_button = v0;

    document.getElementById('materiau-conducteur-profondeur').value =v1;
    document.getElementById('niveau-protection-profondeur').value=v2;   
    document.getElementById('courant-impulsionnel-profondeur').value=v3;
    document.getElementById('chute-tension-profondeur').value=v4;
    document.getElementById('densite-materiau-profondeur').value=v5;
    document.getElementById('chaleur-specifique-profondeur').value=v6;
    document.getElementById('capacite-thermique-profondeur').value=v7;
    document.getElementById('temperature-fusion-profondeur').value=v8;
    document.getElementById('temperature-ambiante-profondeur').value=v9;
    document.getElementById('epaisseur-conducteur-profondeur').value=v10;
    document.getElementById('profondeur-fusion-conducteur').value=v11;

    if (parseFloat(document.getElementById('profondeur-fusion-conducteur').value)>=parseFloat(document.getElementById('epaisseur-conducteur-profondeur').value)) {
        document.getElementById('profondeur-fusion-conducteur').style.color = 'red';
        exclamationIcon2.style.display = 'inline'; // Display the exclamation icon
        exclamationIcon2.addEventListener('mouseover', function() {
        tooltip2.style.display = 'block'; // Show the tooltip
        tooltip2.textContent="La profondeur de fusion obtenue dépasse l'épaisseur du conducteur"
        });

        // Hide tooltip message when mouse leaves the exclamation mark
        exclamationIcon2.addEventListener('mouseout', function() {
        tooltip2.style.display = 'none'; // Hide the tooltip
        });

        } else {

        //niveau_protection_2.classList.remove('invalid');
        document.getElementById('profondeur-fusion-conducteur').style.color = 'blue';
        exclamationIcon2.style.display = 'none'; // Hide the exclamation icon
    }

    if (document.getElementById('niveau-protection-profondeur').value === 'AUTRE') {

        document.getElementById('courant-impulsionnel-profondeur').readOnly = false;
        document.getElementById('courant-impulsionnel-profondeur').className = 'select_field';


    } else {

        document.getElementById('courant-impulsionnel-profondeur').readOnly = true;
        document.getElementById('courant-impulsionnel-profondeur').className = 'select_field_o';

    }



    document.getElementById('courant-max-fourrier').value = v12;
    document.getElementById('coefficient-k-fourrier').value = v13;
    document.getElementById('constante-temps-to1-fourrier').value = v14;
    document.getElementById('constante-temps-to2-fourrier').value = v15;
    document.getElementById('exposant-echantillonnage-fourrier').value = v16;
    document.getElementById('duree-fourrier').value = v17;
    document.getElementById('type-choc-fourrier').value = v18;
    document.getElementById('niveau-protection-fourrier').value = v19;


    document.getElementById('niveau-protection-elevation').value = v20;   
    document.getElementById('courant-impulsionnel-elevation').value = v21;  
    document.getElementById('coef-repartition').value = v22;  
    document.getElementById('resistance-ohmique').value = v23;  
    document.getElementById('coefficient-temperature').value = v24;  
    document.getElementById('densite-materiau').value = v25;  
    document.getElementById('capacite-thermique').value = v26;  
    document.getElementById('temperature-fusion').value = v27;  
    document.getElementById('section-conducteur').value = v28;  
    document.getElementById('delta-theta').value = v29;  
    document.getElementById('materiau-conducteur').value = v30;

    if (parseFloat(document.getElementById('delta-theta').value)>=parseFloat(document.getElementById('temperature-fusion').value)) {
        document.getElementById('delta-theta').style.color = 'red';
        exclamationIcon1.style.display = 'inline'; // Display the exclamation icon
        exclamationIcon1.addEventListener('mouseover', function() {
        tooltip1.style.display = 'block'; // Show the tooltip
        tooltip1.textContent="L'élévation de température obtenue dépasse la température de fusion du conducteur"
        });

        // Hide tooltip message when mouse leaves the exclamation mark
        exclamationIcon1.addEventListener('mouseout', function() {
        tooltip1.style.display = 'none'; // Hide the tooltip
        });
        
        } else {

        //niveau_protection_2.classList.remove('invalid');
        document.getElementById('delta-theta').style.color = 'blue';
        exclamationIcon1.style.display = 'none'; // Hide the exclamation icon

    }

    if (document.getElementById('niveau-protection-elevation').value === 'AUTRE') {

        document.getElementById('courant-impulsionnel-elevation').readOnly = false;
        document.getElementById('courant-impulsionnel-elevation').className = 'select_field';


    } else {

        document.getElementById('courant-impulsionnel-elevation').readOnly = true;
        document.getElementById('courant-impulsionnel-elevation').className = 'select_field_o';

    }


    document.getElementById('materiau-conducteur-spf').value = v31;
    document.getElementById('niveau-protection-spf').value = v32; 
    document.getElementById('courant-impulsionnel-spf').value = v33;
    document.getElementById('coef-repartition-spf').value = v34;
    document.getElementById('resistance-ohmique-spf').value = v35;
    document.getElementById('coefficient-temperature-spf').value = v36;
    document.getElementById('densite-materiau-spf').value = v37;
    document.getElementById('capacite-thermique-spf').value = v38;
    document.getElementById('temperature-fusion-spf').value = v39;
    document.getElementById('temperature-ambiante-spf').value = v40;
    document.getElementById('section-minimale').value = v41;

    if (document.getElementById('niveau-protection-spf').value === 'AUTRE') {

        document.getElementById('courant-impulsionnel-spf').readOnly = false;
        document.getElementById('courant-impulsionnel-spf').className = 'select_field';


    } else {

        document.getElementById('courant-impulsionnel-spf').readOnly = true;
        document.getElementById('courant-impulsionnel-spf').className = 'select_field_o';

    }

    document.getElementById('materiau-conducteur-liaisons').value = v42;
    document.getElementById('niveau-protection-liaisons').value = v43;   
    document.getElementById('courant-impulsionnel-liaisons').value = v44;
    document.getElementById('coef-repartition-liaisons').value = v45;
    document.getElementById('resistance-ohmique-liaisons').value = v46;
    document.getElementById('coefficient-temperature-liaisons').value = v47;
    document.getElementById('densite-materiau-liaisons').value = v48;
    document.getElementById('capacite-thermique-liaisons').value = v49;
    document.getElementById('temperature-fusion-liaisons').value = v50;
    document.getElementById('temperature-ambiante-liaisons').value = v51;
    document.getElementById('section-minimale-liaisons').value = v52;

    if (document.getElementById('niveau-protection-liaisons').value === 'AUTRE') {

        document.getElementById('courant-impulsionnel-liaisons').readOnly = false;
        document.getElementById('courant-impulsionnel-liaisons').className = 'select_field';


    } else {

        document.getElementById('courant-impulsionnel-liaisons').readOnly = true;
        document.getElementById('courant-impulsionnel-liaisons').className = 'select_field_o';

    }

    document.getElementById('materiau-conducteur-terre').value = v53;
    document.getElementById('courant-court-circuit').value = v54;   
    document.getElementById('duree-court-circuit').value = v55;
    document.getElementById('Qc').value = v56;  
    document.getElementById('Beta').value = v57;
    document.getElementById('rho20').value = v58;
    document.getElementById('temperature-initiale').value = v59;
    document.getElementById('temperature-finale').value = v60;
    document.getElementById('section-minimale-terre').value = v61;

    document.getElementById('calibre-protection').value = v62;
    document.getElementById('classe-parafoudre').value = v63;
    document.getElementById('section-minimale-raccordement-s1').value = v64;
    document.getElementById('section-minimale-raccordement-s2').value = v65;

    document.getElementById('courant-foudre-iimp-in').value = v66;
    document.getElementById('classe-parafoudre-calibre').value = v67;
    document.getElementById('calibre-deconnecteur-parafoudre').value = v68;
    document.getElementById('current-label').innerText = v69;

    document.getElementById('niveau-protection-option').value = v70;
    document.getElementById('courant-impulsionnel-angle-protection').value = v71;
    document.getElementById('surelevation-protection').value = v72;
    document.getElementById('rayon-sphere-fictive-angle-protection').value = v73;
    document.getElementById('angle-protection').value = v74;
    document.getElementById('rayon-protection-angle-protection').value = v75;

    if (document.getElementById('niveau-protection-option').value === 'AUTRE') {

        document.getElementById('courant-impulsionnel-angle-protection').readOnly = false;
        document.getElementById('courant-impulsionnel-angle-protection').className = 'select_field';


    } else {

        document.getElementById('courant-impulsionnel-angle-protection').readOnly = true;
        document.getElementById('courant-impulsionnel-angle-protection').className = 'select_field_o';

    }

    document.getElementById('niveau-protection-option-sf').value = v76;
    document.getElementById('courant-impulsionnel-sphere-fictive').value = v77;
    document.getElementById('surelevation-protection-sf').value = v78;
    document.getElementById('rayon-sphere-fictive-sphere-fictive').value = v79;
    document.getElementById('rayon-protection-sphere-fictive').value = v80;

    if (document.getElementById('niveau-protection-option-sf').value === 'AUTRE') {

        document.getElementById('courant-impulsionnel-sphere-fictive').readOnly = false;
        document.getElementById('courant-impulsionnel-sphere-fictive').className = 'select_field';


    } else {

        document.getElementById('courant-impulsionnel-sphere-fictive').readOnly = true;
        document.getElementById('courant-impulsionnel-sphere-fictive').className = 'select_field_o';

    }

    document.getElementById('niveau-protection-p').value = v81;
    document.getElementById('courant-impulsionnel-p').value = v82;
    document.getElementById('surelevation-pointe-1').value = v83;
    document.getElementById('surelevation-pointe-2').value = v84;
    document.getElementById('distance-pointes-1-2').value = v85;
    document.getElementById('rayon-sphere-fictive-p').value = v86;
    document.getElementById('centre-x0-sphere').value = v87;
    document.getElementById('centre-y0-sphere').value = v88;
    document.getElementById('profondeur-penetration-petitepointe').value = v89;
    
    const HAB = Math.min(parseFloat(document.getElementById('surelevation-pointe-1').value),parseFloat(document.getElementById('surelevation-pointe-2').value))

    if (parseFloat(document.getElementById('profondeur-penetration-petitepointe').value)===HAB) {
        document.getElementById('profondeur-penetration-petitepointe').style.color = 'red';
            exclamationIcon3.style.display = 'inline'; // Display the exclamation icon
            exclamationIcon3.addEventListener('mouseover', function() {
            tooltip3.style.display = 'block'; // Show the tooltip
            tooltip3.textContent="La sphère fictive touche la surface à protéger"
            });

            // Hide tooltip message when mouse leaves the exclamation mark
            exclamationIcon3.addEventListener('mouseout', function() {
            tooltip3.style.display = 'none'; // Hide the tooltip
            });
        
        } else {

            //niveau_protection_2.classList.remove('invalid');
            document.getElementById('profondeur-penetration-petitepointe').style.color = 'blue';
            exclamationIcon3.style.display = 'none'; // Hide the exclamation icon

    }

    if (document.getElementById('niveau-protection-p').value === 'AUTRE') {

        document.getElementById('courant-impulsionnel-p').readOnly = false;
        document.getElementById('courant-impulsionnel-p').className = 'select_field';

    } else {

        document.getElementById('courant-impulsionnel-p').readOnly = true;
        document.getElementById('courant-impulsionnel-p').className = 'select_field_o';

    }

    document.getElementById('niveau-protection-option-pda').value = v90;
    document.getElementById('icpe').value = v91;
    document.getElementById('surelevation-protection-pda').value = v92;
    document.getElementById('rayon-sphere-fictive-pda').value = v93;
    document.getElementById('deltaT-pda').value = v94;
    document.getElementById('rayon-protection-pda').value = v95;

    ConducteurData = {};
    ConducteurData = data.ConducteurData || [];
    const options_force = data.options_force || [];
    ConducteurCounter = data.ConducteurCounter || null;
    document.getElementById('niveau-protection-force').value = v96;
    document.getElementById('courant-max-force').value = v97;
    document.getElementById('distance-entre-fixations').value = v99;
    document.getElementById('position-conducteur-x0').value = v100;
    document.getElementById('position-conducteur-y0').value = v101;
    document.getElementById('angle-inclinaison-mur').value = v102;
    document.getElementById('coefficient-repartition-force').value = v103;
    document.getElementById('force-resultante-traction').value = v104;
    document.getElementById('force-resultante-cisaillement').value = v105;

    let dropdownforce = document.getElementById('dropdown-menu-force');
    dropdownforce.innerHTML = ''; // Clear existing options
    
    // Convert HTMLCollection to an array before using forEach
    options_force.forEach(optionText => {
        let option = document.createElement('option');
        option.text = optionText; // Use .text property for the text content of the option
        dropdownforce.add(option);
    });

    document.getElementById('dropdown-menu-force').value = v98;

    if (document.getElementById('niveau-protection-force').value === 'AUTRE') {

        document.getElementById('courant-max-force').readOnly = false;
        document.getElementById('courant-max-force').className = 'select_field';


    } else {

        document.getElementById('courant-max-force').readOnly = true;
        document.getElementById('courant-max-force').className = 'select_field_o';

    }



    CheminementData = {};
    CheminementData = data.CheminementData || [];
    CheminementCounter = data.CheminementCounter || null;
    const options_cheminement= data.options_cheminement || [];
    document.getElementById('niveau-protection-cheminement').value = v106;
    document.getElementById('courant-total-cheminement').value = v107;
    document.getElementById('impedance-prise-terre').value = v108;
    document.getElementById('courant-prise-terre').value = v109;
    document.getElementById('nombre-conducteurs').value = v110;
    document.getElementById('impedance-cheminement').value = v111;
    document.getElementById('coefficient-repartition').value = v112;
    document.getElementById('courant-iimp-cheminement-selectionne').value = v113;
    document.getElementById('dropdown-menu-cheminement').value = v114;

    let dropdownmenucheminement = document.getElementById('dropdown-menu-cheminement');
    dropdownmenucheminement.innerHTML = ''; // Clear existing options
    
    // Convert HTMLCollection to an array before using forEach
    options_cheminement.forEach(optionText => {
        let option = document.createElement('option');
        option.text = optionText; // Use .text property for the text content of the option
        dropdownmenucheminement.add(option);
    });

    document.getElementById('dropdown-menu-cheminement').value = v114;

    if (document.getElementById('niveau-protection-cheminement').value === 'AUTRE') {

        document.getElementById('courant-total-cheminement').readOnly = false;
        document.getElementById('courant-total-cheminement').className = 'select_field';

    } else {

        document.getElementById('courant-total-cheminement').readOnly = true;
        document.getElementById('courant-total-cheminement').className = 'select_field_o';

    }

    ZPFDataDirect = {};
    ZPFDataDirect = data.ZPFDataDirect || [];
    zpfdirectCounter = data.zpfdirectCounter || null;
    const options_champdirect = data.options_champdirect || null;
    document.getElementById('niveau-protection-champ-direct-zpf1').value = v115;
    document.getElementById('type-choc-champ-direct-zpf1').value = v116;
    document.getElementById('distance-point-mur-direct-zpf1').value = v117;
    document.getElementById('distance-point-toit-direct-zpf1').value = v118;
    document.getElementById('courant-max-champ-direct-zpf1').value = v119;
    document.getElementById('reseau-equipotentialite-direct').value = v120;
    document.getElementById('taille-mailles-batiment-direct-zpf1').value = v121;
    document.getElementById('diametre-conducteurs-ecran-batiment-direct-zpf1').value = v122;
    document.getElementById('type-materiau-champ-direct-zpf1-label').value = v123;
    document.getElementById('facteur-ecran-direct-zpf1').value = v124;
    document.getElementById('distance-securite-direct-zpf1').value = v125;
    document.getElementById('champ-magnetrique-avec-ecran-direct-zpf1').value = v126;
    document.getElementById('facteur-global-ecran-direct-zpf1').value = v127;

    let dropdownmenuzpfdirect = document.getElementById('dropdown-menu-zpf-direct');
    dropdownmenuzpfdirect.innerHTML = ''; // Clear existing options
    
    // Convert HTMLCollection to an array before using forEach
    options_champdirect.forEach(optionText => {
        let option = document.createElement('option');
        option.text = optionText; // Use .text property for the text content of the option
        dropdownmenuzpfdirect.add(option);
    });

    document.getElementById('dropdown-menu-zpf-direct').value = v128;

    if (document.getElementById('niveau-protection-champ-direct-zpf1').value === 'AUTRE') {

        document.getElementById('courant-max-champ-direct-zpf1').readOnly = false;
        document.getElementById('courant-max-champ-direct-zpf1').className = 'select_field';

    } else {

        document.getElementById('courant-max-champ-direct-zpf1').readOnly = true;
        document.getElementById('courant-max-champ-direct-zpf1').className = 'select_field_o';

    }

    ZPFData = {};
    ZPFData = data.ZPFData || [];
    zpfCounter = data.zpfCounter || null;
    const options_champindirect = data.options_champindirect || null;
    document.getElementById('niveau-protection-champ-indirect-zpf1').value = v129;
    document.getElementById('type-choc-champ-indirect-zpf1').value = v130;
    document.getElementById('hauteur-batiment-champ-indirect-zpf1').value = v131;
    document.getElementById('longueur-batiment-champ-indirect-zpf1').value = v132;
    document.getElementById('courant-max-champ-indirect-zpf1').value = v133;
    document.getElementById('distance-indirect-zpf1').value = v134;
    document.getElementById('rayon-sf-indirect-zpf1').value = v135;
    document.getElementById('reseau-equipotentialite-indirect').value = v136;
    document.getElementById('taille-mailles-batiment-indirect-zpf1').value = v137;
    document.getElementById('diametre-conducteurs-ecran-batiment-indirect-zpf1').value = v138;
    document.getElementById('type-materiau-champ-indirect-zpf1').value = v139;
    document.getElementById('facteur-ecran-indirect-zpf1').value = v140;
    document.getElementById('distance-securite-indirect-zpf1').value = v141;
    document.getElementById('champ-magnetrique-sans-ecran-indirect-zpf1').value = v142;
    document.getElementById('champ-magnetrique-avec-ecran-indirect-zpf1').value = v143;
    document.getElementById('facteur-global-ecran-indirect-zpf1').value = v144;

    let dropdownmenuzpf = document.getElementById('dropdown-menu-zpf');
    dropdownmenuzpf.innerHTML = ''; // Clear existing options
    
    // Convert HTMLCollection to an array before using forEach
    options_champindirect.forEach(optionText => {
        let option = document.createElement('option');
        option.text = optionText; // Use .text property for the text content of the option
        dropdownmenuzpf.add(option);
    });

    document.getElementById('dropdown-menu-zpf').value = v145;

    if (document.getElementById('niveau-protection-champ-indirect-zpf1').value === 'AUTRE') {

        document.getElementById('courant-max-champ-indirect-zpf1').readOnly = false;
        document.getElementById('courant-max-champ-indirect-zpf1').className = 'select_field';

    } else {

        document.getElementById('courant-max-champ-indirect-zpf1').readOnly = true;
        document.getElementById('courant-max-champ-indirect-zpf1').className = 'select_field_o';

    }



    ElementConducteurData = {};
    ElementConducteurData = data.ElementConducteurData || [];
    ElementConducteurCounter = data.ElementConducteurCounter || null;
    const options_conducteurKTA2206 = data.options_conducteurKTA2206 || null;
    GalerieData = {};
    GalerieData = data.GalerieData || [];
    GalerieCounter = data.GalerieCounter || null;
    const options_buseKTA2206 = data.options_buseKTA2206 || null;
    document.getElementById('niveau-protection-kta2206').value = v146;
    document.getElementById('type-choc-foudre-kta2206').value = v147;
    document.getElementById('courant-max-kta2206').value = v148;
    document.getElementById('resistivite-sol-kta2206').value = v149;
    document.getElementById('courant-prise-terre-kta2206').value = v150;
    document.getElementById('facteur-foudre-k-kta2206').value = v151;
    document.getElementById('impedance-couplage-kta2206').value = v152;
    document.getElementById('type-cable-kta2206').value = v153;
    document.getElementById('coefficient-ponderation-conducteur-kta2206').value = v154;
    document.getElementById('type-buse-kta2206').value = v155;
    document.getElementById('longueur-galerie-kta2206').value = v156;
    document.getElementById('nombre-liaisons-jd-kta2206').value = v157;
    document.getElementById('nombre-jd-galerie-kta2206').value = v158;
    document.getElementById('tenue-equipements-kta2206').value = v159;
    document.getElementById('coefficient-ponderation-galerie-kta2206').value = v160;
    document.getElementById('extension-fictive-kta2206').value = v161;
    document.getElementById('courant-partiel-galerie-kta2206').value = v162;
    document.getElementById('tension-induite-kta2206').value = v163;

    
    let dropdownmenuconducteurkta2206 = document.getElementById('dropdown-menu-conducteur-kta2206');
    dropdownmenuconducteurkta2206.innerHTML = ''; // Clear existing options
    
    // Convert HTMLCollection to an array before using forEach
    options_conducteurKTA2206.forEach(optionText => {
        let option = document.createElement('option');
        option.text = optionText; // Use .text property for the text content of the option
        dropdownmenuconducteurkta2206.add(option);
    });

    let dropdownmenubusekta2206 = document.getElementById('dropdown-menu-buse-kta2206');
    dropdownmenubusekta2206.innerHTML = ''; // Clear existing options
    
    // Convert HTMLCollection to an array before using forEach
    options_buseKTA2206.forEach(optionText => {
        let option = document.createElement('option');
        option.text = optionText; // Use .text property for the text content of the option
        dropdownmenubusekta2206.add(option);
    });

    document.getElementById('dropdown-menu-conducteur-kta2206').value = v164;
    document.getElementById('dropdown-menu-buse-kta2206').value = v165;

    if (parseFloat(document.getElementById('tension-induite-kta2206').value)/1000>=parseFloat(document.getElementById('tenue-equipements-kta2206').value )) {

        document.getElementById('tension-induite-kta2206').style.color = 'red';
        exclamationIconKTA2206.style.display = 'inline'; // Display the exclamation icon
        exclamationIconKTA2206.addEventListener('mouseover', function() {
        tooltipKTA2206.style.display = 'block'; // Show the tooltip
        tooltipKTA2206.textContent="La tension induite dépasse la tenue au choc de foudre des équipements internes"
        });

        // Hide tooltip message when mouse leaves the exclamation mark
        exclamationIconKTA2206.addEventListener('mouseout', function() {
        tooltipKTA2206.style.display = 'none'; // Hide the tooltip
        });

        } else {

        //niveau_protection_2.classList.remove('invalid');
        document.getElementById('tension-induite-kta2206').style.color = 'blue';
        exclamationIconKTA2206.style.display = 'none'; // Hide the exclamation icon


    }

    if (document.getElementById('niveau-protection-kta2206').value === 'AUTRE') {

        document.getElementById('courant-max-kta2206').readOnly = false;
        document.getElementById('courant-max-kta2206').className = 'select_field';


    } else {

        document.getElementById('courant-max-kta2206').readOnly = true;
        document.getElementById('courant-max-kta2206').className = 'select_field_o';

    }


    


    document.getElementById('materiau-conducteur-blindage').value = v166;
    document.getElementById('courant-impulsionnel-blindage').value = v167;
    document.getElementById('resistivite-blindage').value = v168;
    document.getElementById('tenue-chocs-equipements-blindage').value = v169;
    document.getElementById('diametre-moyen-ecran').value = v170;
    document.getElementById('resistivite-sol-blindage').value = v171;
    document.getElementById('etat-ecran-blindage').value = v172;
    document.getElementById('longueur-cable-blindage').value = v173;
    document.getElementById('temperature-ambiante-blindage').value = v174;
    document.getElementById('temperature-maximale-isolant-cable-blindage').value = v175;
    document.getElementById('section-ecran-blindage').value = v176;
    document.getElementById('epaisseur-ecran-blindage').value = v177;


    switch (cliqued_button) {

        case 1: document.getElementById('elevation_temperature').click();
        break;
        case 2: document.getElementById('profondeur_fusion').click();
        break;
        case 3: document.getElementById('section_conducteurs').click();
        break;
        case 4: document.getElementById('section_electrodes_terre').click();
        break;
        case 5: document.getElementById('section_cables_parafoudres').click();
        break;
        case 6: document.getElementById('section_liaisons_terre').click();
        break;
        case 7: document.getElementById('calibre_deconnecteurs').click();
        break;
        case 8: document.getElementById('angle_protection').click();
        break;
        case 9: document.getElementById('rayon_protection_sf').click();
        break;
        case 10: document.getElementById('rayon_protection_PDA').click();
        break;
        case 11: document.getElementById('profondeur_sf').click();
        break;
        case 12: document.getElementById('courant_iimp_par_module').click();
        break;
        case 13: document.getElementById('spectre_frequentiel').click();
        break;
        case 14: document.getElementById('calcul_champ_magnetique_direct_zpf1').click();
        break;
        case 15: document.getElementById('calcul_champ_magnetique_indirect_zpf1').click();
        break;
        case 16: document.getElementById('forces electrodynamiques').click();
        break;
        case 17: document.getElementById('calcul_section_blindage').click();
        break;
        case 18: document.getElementById('calcul_surtensions_KTA2206').click();
        break;

    }



       
    } catch (error) {
        
       alert('Fichier invalide');
       return;

    }

    };

    reader.onerror = function() {
        //alert('Erreur de lecture du fichier');
    };




    reader.readAsText(file);

    } catch (error) {
        //console.error('Erreur lors de l\'ouverture du fichier:', error);
        //alert('Erreur lors de l\'ouverture du fichier.');
    }

    //input.click();
});




document.getElementById('print').addEventListener('click', function () {

    //getCheckedLineData();
    showData();

});


function new_file() {


    window.open('CALCULS DIVERS 01 10 24 JS NODE JS.html', '_blank');
    

}


function showData() {
    //const checkedData = getCheckedLineData();

    if (cliqued_button===13) {

        const courant_max_fourrier=document.getElementById('courant-max-fourrier').value;
        const coefficient_k_fourrier=document.getElementById('coefficient-k-fourrier').value;
        const constante_temps_to1_fourrier=document.getElementById('constante-temps-to1-fourrier').value;
        const constante_temps_to2_fourrier=document.getElementById('constante-temps-to2-fourrier').value;

        
        const exposant_echantillonnage_fourrier=document.getElementById('exposant-echantillonnage-fourrier').value;
        const duree_fourrier=document.getElementById('duree-fourrier').value;

        const type_choc_fourrier=document.getElementById('type-choc-fourrier').value;

        var type_choc_fourrier_label;

        if (type_choc_fourrier=='1') {

            type_choc_fourrier_label ='Premier coup de foudre positif'


        } else if (type_choc_fourrier=='2') {

            type_choc_fourrier_label ='Premier coup de foudre négatif'


        } else {

            type_choc_fourrier_label ='Arc subséquent'



        }
        const niveauprotection=document.getElementById('niveau-protection-fourrier').value;

        const newWindow = window.open('aaaaa', '_blank');

        const newDoc = newWindow.document;


    // Obtenir la date actuelle
    const currentDate = new Date();
    const formattedDate = currentDate.toLocaleDateString('fr-FR', {
        Année: 'numeric',
        Mois: 'long',
        Jour: 'numeric'
    });


    const versionlogicielle='ELP-DV-SFF-07-09-01A';
    const normeReference='NF EN 62305-1';


    const html = `
    <html>
    <head>
        <title>CALCUL DE LA TRANSFORMEE DE FOURRIER DE L'ONDE DE FOUDRE ${''} </title>
            <style>
            @media print {
                    @page {
                        margin-left: 1cm;
                        margin-right: 1cm;
                        margin-top: 2cm;
                        margin-bottom: 1cm;
                    }
                    body {
                        margin: 0;
                    }
                    .page-number:after {
                        content: counter(page);
                    }
                    .page-number {
                        position: fixed;
                        bottom: 0;
                        width: 100%;
                        text-align: center;
                    }
                }

                
                /* Optional: Additional CSS styles for the output window */
            </style>
    </head>
    <body>

    <h3 style="text-decoration: underline; text-align: center;">DONNEES DE SORTIE LOGICIELLE</h3>
    <p style="text-align: center">Version logicielle: <span style="color: blue;">${versionlogicielle}</span></p>

    <p style="margin: 0;">--------------------------------------------------------------------------------------------------------------</p>
    <h4 style="margin: 0px 0;">DONNEES GENERALES</h4>  
    <p style="margin: 0;">--------------------------------------------------------------------------------------------------------------</p>
    <p>Date: <span style="color: blue;">${formattedDate}</span></p>
    <p>Norme de référence: <span style="color: blue;">${normeReference}</span></p>


    <p style="margin: 0;">--------------------------------------------------------------------------------------------------------------</p>
    <h4 style="margin: 0px 0;">DONNEES D'ENTREE SAISIS SAISIS</h4>  
    <p style="margin: 0;">--------------------------------------------------------------------------------------------------------------</p>

    <p>Niveau de protection foudre: <span style="color: blue;">${niveauprotection}</span></p>
    <p>Type d'onde de foudre: <span style="color: blue;">${type_choc_fourrier_label}</span></p>
    <p>Valeur maximale du courant impulsionnel de foudre: <span style="color: blue;">${courant_max_fourrier} kA</span></p>
    <p>Coefficient k de l'onde de foudre: <span style="color: blue;">${coefficient_k_fourrier}</span></p>
    <p>Constante de temps &tau;1 de l'onde de foudre: <span style="color: blue;">${constante_temps_to1_fourrier} &micro;s</span></p>
    <p>Constante de temps &tau;2 de l'onde de foudre: <span style="color: blue;">${constante_temps_to2_fourrier} &micro;s</span></p>
    <p>Période d'échantillonnage: <span style="color: blue;">${exposant_echantillonnage_fourrier} ns</span></p>
    <p>Durée de l'impulsion : <span style="color: blue;">${duree_fourrier} &micro;s</span></p>

    <div id="input-data-container"></div>

    <p style="margin: 0;">--------------------------------------------------------------------------------------------------------------</p>
    <h4 style="margin: 0px 0;">FORME TEMPORELLE DU COURANT DE FOUDRE</h4>  
    <p style="margin: 0;">--------------------------------------------------------------------------------------------------------------</p>

    <div id="forme-temporelle-container"></div>

    <p style="margin: 0;"></p>
    <p style="margin: 0;"></p>

    <p style="margin: 0;">--------------------------------------------------------------------------------------------------------------</p>
    <h4 style="margin: 0px 0;">FORME SPECTRALE DU COURANT DE FOUDRE</h4>  
    <p style="margin: 0;">--------------------------------------------------------------------------------------------------------------</p>

    <div id="forme-spectrale-container"></div>


    </body>
    </html>
    `;


    newDoc.open();

    newDoc.write(html);
    newDoc.close();

    newWindow.onload = function () {

    const inputdatacontainer = newDoc.getElementById('input-data-container');
    const formetemporellecontainer = newDoc.getElementById('forme-temporelle-container');
    const formespectralecontainer = newDoc.getElementById('forme-spectrale-container');

    formetemporellecontainer.innerHTML = `

    <div style="display: inline-block; border-top: 1px dashed black; border-bottom: 1px dashed black; padding: 10px;">
        
        <span style="display: inline-block; width: 150px; text-align: center;">Temps (µs)</span>

        <span style="display: inline-block; width: 150px; text-align: center;">Courant I (A)</span>

    </div>

        
    `;

    formespectralecontainer.innerHTML = `

    <div style="display: inline-block; border-top: 1px dashed black; border-bottom: 1px dashed black; padding: 10px;">
        
        <span style="display: inline-block; width: 150px; text-align: center;">Fréquence (Hz)</span>

        <span style="display: inline-block; width: 150px; text-align: center;">Amplitude</span>
        
    </div>
        
    `;


    for (let i = 0; i < time.length; i++) {

        const t = (time[i]*1E6).toFixed(4);
        const I = (signal[i]).toFixed(2);


        formetemporellecontainer.innerHTML += `

        <div>

            <span style="display: inline-block; width: 150px; text-align: center;">${t}</span>

            <span style="display: inline-block; width: 150px; text-align: center;">${I}</span>

        </div>
          `;


    }

    for (let i = 0; i < frequencies.length; i++) {


        const M = (magnitudes[i]).toFixed(4);
        const f = (frequencies[i]).toFixed(2);


        formespectralecontainer.innerHTML += `

        <div>

            <span style="display: inline-block; width: 150px; text-align: center;">${f}</span>

            <span style="display: inline-block; width: 150px; text-align: center;">${M}</span>

        </div>


          `;

    }


    newWindow.print();

    const tempWindow = window.open('', '_blank', 'width=1,height=1');
    tempWindow.blur(); // Perdre le focus de la fenêtre temporaire
    window.focus(); // Revenir à la fenêtre principale
    setTimeout(() => tempWindow.close(), 100); // Fermer la fenêtre temporaire


    }

////////////////////////////////////////////////////////////////////////////////ELEVATION TEMPERATURE//////////////////////////////////////////////
    

}  else if (cliqued_button===1) {


    const type_materiau=document.getElementById('materiau-conducteur').value;

    var type_materiau_label;

    if (type_materiau=='1') {

        type_materiau_label ='Cuivre'


    } else if (type_materiau=='2') {

        type_materiau_label ='Aluminium'


    } else if (type_materiau=='3') {

        type_materiau_label ='Acier doux'



    } else {

        type_materiau_label ='Acier inoxydable'

    }

    const niveauprotection=document.getElementById('niveau-protection-elevation').value;   
    const courant_impulsionnel_foudre=document.getElementById('courant-impulsionnel-elevation').value;

    const coefficient_repartition_courant=document.getElementById('coef-repartition').value;
    const resistance_ohmique=document.getElementById('resistance-ohmique').value;
    const coefficient_temperature=document.getElementById('coefficient-temperature').value;
    const densite_materiau=document.getElementById('densite-materiau').value;
    const capacite_thermique=document.getElementById('capacite-thermique').value;
    const temperature_fusion=document.getElementById('temperature-fusion').value;
    const section_conducteur=document.getElementById('section-conducteur').value;
    const elevation_temperature=document.getElementById('delta-theta').value;

    const newWindow = window.open('aaaaa', '_blank');

    const newDoc = newWindow.document;


    // Obtenir la date actuelle
    const currentDate = new Date();
    const formattedDate = currentDate.toLocaleDateString('fr-FR', {
    Année: 'numeric',
    Mois: 'long',
    Jour: 'numeric'
    });


    const versionlogicielle='ELP-DV-ETC-07-09-01A';
    const normeReference='NF EN 62305-1';


    const html = `
    <html>
    <head>
    <title>CALCUL DE L'ELEVATION DE TEMPERATURE DANS LES CONDUCTEURS DU SPF ${''} </title>
        <style>
        @media print {
                @page {
                    margin-left: 1cm;
                    margin-right: 1cm;
                    margin-top: 2cm;
                    margin-bottom: 1cm;
                }
                body {
                    margin: 0;
                }
                .page-number:after {
                    content: counter(page);
                }
                .page-number {
                    position: fixed;
                    bottom: 0;
                    width: 100%;
                    text-align: center;
                }
            }

            
            /* Optional: Additional CSS styles for the output window */
        </style>
    </head>
    <body>

    <h3 style="text-decoration: underline; text-align: center;">DONNEES DE SORTIE LOGICIELLE</h3>
    <p style="text-align: center">Version logicielle: <span style="color: blue;">${versionlogicielle}</span></p>

    <p style="margin: 0;">--------------------------------------------------------------------------------------------------------------</p>
    <h4 style="margin: 0px 0;">DONNEES GENERALES</h4>  
    <p style="margin: 0;">--------------------------------------------------------------------------------------------------------------</p>
    <p>Date: <span style="color: blue;">${formattedDate}</span></p>
    <p>Norme de référence: <span style="color: blue;">${normeReference}</span></p>


    <p style="margin: 0;">--------------------------------------------------------------------------------------------------------------</p>
    <h4 style="margin: 0px 0;">DONNEES D'ENTREE SAISIS SAISIS</h4>  
    <p style="margin: 0;">--------------------------------------------------------------------------------------------------------------</p>


    <p>Type de matériau: <span style="color: blue;">${type_materiau_label}</span></p>
    <p>Niveau de protection foudre: <span style="color: blue;">${niveauprotection}</span></p>
    <p>Courant impulsionnel de foudre: <span style="color: blue;">${courant_impulsionnel_foudre} kA</span></p>
    <p>Coefficient de répartition du courant de foudre: <span style="color: blue;">${coefficient_repartition_courant}</span></p>
    <p>Résistance ohmique spécifique du conducteur à la température ambiante ;&rho: <span style="color: blue;">${resistance_ohmique} &ohm;.m</span></p>
    <p>Coefficient de température de la résistance &alpha;: <span style="color: blue;">${coefficient_temperature} 1/K</span></p>
    <p>Densité du matériau &gamma;: <span style="color: blue;">${densite_materiau} kg/m<sup>3</sup></span></p>
    <p>Capacité thermique Cw: <span style="color: blue;">${capacite_thermique} J/kg.K</span></p>
    <p>Température de fusion &theta;s : <span style="color: blue;">${temperature_fusion} °C</span></p>
    <p>Section du conducteur s : <span style="color: blue;">${section_conducteur} mm<sup>2</sup></span></p>
    


    <p style="margin: 0;">--------------------------------------------------------------------------------------------------------------</p>
    <h4 style="margin: 0px 0;">RESULTATS DE SORTIE</h4>  
    <p style="margin: 0;">--------------------------------------------------------------------------------------------------------------</p>

    <p><strong>Elévation de température dans le conducteur &Delta;&theta; : </strong><span style="color: blue;"><strong>${elevation_temperature} °C </strong></span></p>


    </body>
    </html>
    `;


    newDoc.open();

    newDoc.write(html);
    newDoc.close();

    newWindow.onload = function () {
   
    newWindow.print();

    const tempWindow = window.open('', '_blank', 'width=1,height=1');
    tempWindow.blur(); // Perdre le focus de la fenêtre temporaire
    window.focus(); // Revenir à la fenêtre principale
    setTimeout(() => tempWindow.close(), 100); // Fermer la fenêtre temporaire

    }

    ////////////////////////////////////////////////////////////////////////////////PROFONDEUR FUSION//////////////////////////////////////////////

    } else if (cliqued_button ===2) {


    const type_materiau_label = (document.getElementById('materiau-conducteur-profondeur').options[document.getElementById('materiau-conducteur-profondeur').selectedIndex]).text;

    const niveauprotection=document.getElementById('niveau-protection-profondeur').value;   
    const courant_impulsionnel_foudre=document.getElementById('courant-impulsionnel-profondeur').value;
    const chute_tension_profondeur = document.getElementById('chute-tension-profondeur').value;
    const densite_materiau=document.getElementById('densite-materiau-profondeur').value;
    const chaleur_specifique_profondeur=document.getElementById('chaleur-specifique-profondeur').value;
    const capacite_thermique_profondeur=document.getElementById('capacite-thermique-profondeur').value;
    const temperature_fusion_profondeur=document.getElementById('temperature-fusion-profondeur').value;
    const temperature_ambiante_profondeur=document.getElementById('temperature-ambiante-profondeur').value;
    const epaisseur_conducteur_profondeur=document.getElementById('epaisseur-conducteur-profondeur').value;

    const profondeur_fusion=document.getElementById('profondeur-fusion-conducteur').value;

    const newWindow = window.open('aaaaa', '_blank');

    const newDoc = newWindow.document;


    // Obtenir la date actuelle
    const currentDate = new Date();
    const formattedDate = currentDate.toLocaleDateString('fr-FR', {
    Année: 'numeric',
    Mois: 'long',
    Jour: 'numeric'
    });


    const versionlogicielle='ELP-DV-PFC-07-09-01A';
    const normeReference='NF EN 62305-1';


    const html = `
    <html>
    <head>
    <title>CALCUL DE LA PROFONDEUR DE FUSION DANS UN ELEMENT DU SYSTEME DE CAPTURE ${''} </title>
    <style>
    @media print {
            @page {
                margin-left: 1cm;
                margin-right: 1cm;
                margin-top: 2cm;
                margin-bottom: 1cm;
            }
            body {
                margin: 0;
            }
            .page-number:after {
                content: counter(page);
            }
            .page-number {
                position: fixed;
                bottom: 0;
                width: 100%;
                text-align: center;
            }
        }

        
        /* Optional: Additional CSS styles for the output window */
    </style>
    </head>
    <body>

    <h3 style="text-decoration: underline; text-align: center;">DONNEES DE SORTIE LOGICIELLE</h3>
    <p style="text-align: center">Version logicielle: <span style="color: blue;">${versionlogicielle}</span></p>

    <p style="margin: 0;">--------------------------------------------------------------------------------------------------------------</p>
    <h4 style="margin: 0px 0;">DONNEES GENERALES</h4>  
    <p style="margin: 0;">--------------------------------------------------------------------------------------------------------------</p>
    <p>Date: <span style="color: blue;">${formattedDate}</span></p>
    <p>Norme de référence: <span style="color: blue;">${normeReference}</span></p>


    <p style="margin: 0;">--------------------------------------------------------------------------------------------------------------</p>
    <h4 style="margin: 0px 0;">DONNEES D'ENTREE SAISIS SAISIS</h4>  
    <p style="margin: 0;">--------------------------------------------------------------------------------------------------------------</p>


    <p>Type de matériau: <span style="color: blue;">${type_materiau_label}</span></p>
    <p>Niveau de protection foudre: <span style="color: blue;">${niveauprotection}</span></p>
    <p>Courant impulsionnel de foudre: <span style="color: blue;">${courant_impulsionnel_foudre} kA</span></p>
    <p>Chute de tension anode-cathode ua,c: <span style="color: blue;">${chute_tension_profondeur}</span></p>
    <p>Densité du matériau &gamma;: <span style="color: blue;">${densite_materiau} kg/m<sup>3</sup></span></p>
    <p>Chaleur spécifique de fusion Cs : <span style="color: blue;">${chaleur_specifique_profondeur} J/kg </span></p>
    <p>Capacité thermique Cw: <span style="color: blue;">${capacite_thermique_profondeur} J/kg.K</span></p>
    <p>Température de fusion &theta;s : <span style="color: blue;">${temperature_fusion_profondeur} °C </span></p>
    <p>Température ambiante &theta;0 : <span style="color: blue;">${temperature_ambiante_profondeur} °C </span></p>
    <p>Epaisseur du conducteur : <span style="color: blue;">${epaisseur_conducteur_profondeur} mm </sup></span></p>


    <p style="margin: 0;">--------------------------------------------------------------------------------------------------------------</p>
    <h4 style="margin: 0px 0;">RESULTATS DE SORTIE</h4>  
    <p style="margin: 0;">--------------------------------------------------------------------------------------------------------------</p>

    <p><strong>Profondeur de fusion du conducteur "pf" : </strong><span style="color: blue;"><strong> ${profondeur_fusion} mm </strong></span></p>


    </body>
    </html>
    `;


    newDoc.open();

    newDoc.write(html);
    newDoc.close();

    newWindow.onload = function () {

    newWindow.print();

    const tempWindow = window.open('', '_blank', 'width=1,height=1');
    tempWindow.blur(); // Perdre le focus de la fenêtre temporaire
    window.focus(); // Revenir à la fenêtre principale
    setTimeout(() => tempWindow.close(), 100); // Fermer la fenêtre temporaire

    }


    } else if (cliqued_button===3) {


    const type_materiau_label = (document.getElementById('materiau-conducteur-spf').options[document.getElementById('materiau-conducteur-spf').selectedIndex]).text;

    const niveauprotection=document.getElementById('niveau-protection-spf').value;   
    const courant_impulsionnel_foudre=document.getElementById('courant-impulsionnel-spf').value;
    const coefficient_repartition_courant=document.getElementById('coef-repartition-spf').value;
    const resistance_ohmique=document.getElementById('resistance-ohmique-spf').value;
    const coefficient_temperature=document.getElementById('coefficient-temperature-spf').value;
    const densite_materiau=document.getElementById('densite-materiau-spf').value;
    const capacite_thermique=document.getElementById('capacite-thermique-spf').value;
    const temperature_fusion=document.getElementById('temperature-fusion-spf').value;
    const temperature_ambiante=document.getElementById('temperature-ambiante-spf').value;
    const section_minimale_conducteur=document.getElementById('section-minimale').value;


    const newWindow = window.open('aaaaa', '_blank');

    const newDoc = newWindow.document;


    // Obtenir la date actuelle
    const currentDate = new Date();
    const formattedDate = currentDate.toLocaleDateString('fr-FR', {
    Année: 'numeric',
    Mois: 'long',
    Jour: 'numeric'
    });


    const versionlogicielle='ELP-DV-SCF-07-09-01A';
    const normeReference='NF EN 62305-1';


    const html = `
    <html>
    <head>
    <title>SECTION MINIMALE REQUISE DES CONDUCTEURS DU SPF ${''} </title>
        <style>
        @media print {
                @page {
                    margin-left: 1cm;
                    margin-right: 1cm;
                    margin-top: 2cm;
                    margin-bottom: 1cm;
                }
                body {
                    margin: 0;
                }
                .page-number:after {
                    content: counter(page);
                }
                .page-number {
                    position: fixed;
                    bottom: 0;
                    width: 100%;
                    text-align: center;
                }
            }

            
            /* Optional: Additional CSS styles for the output window */
        </style>
    </head>
    <body>

    <h3 style="text-decoration: underline; text-align: center;">DONNEES DE SORTIE LOGICIELLE</h3>
    <p style="text-align: center">Version logicielle: <span style="color: blue;">${versionlogicielle}</span></p>

    <p style="margin: 0;">--------------------------------------------------------------------------------------------------------------</p>
    <h4 style="margin: 0px 0;">DONNEES GENERALES</h4>  
    <p style="margin: 0;">--------------------------------------------------------------------------------------------------------------</p>
    <p>Date: <span style="color: blue;">${formattedDate}</span></p>
    <p>Norme de référence: <span style="color: blue;">${normeReference}</span></p>


    <p style="margin: 0;">--------------------------------------------------------------------------------------------------------------</p>
    <h4 style="margin: 0px 0;">DONNEES D'ENTREE SAISIS SAISIS</h4>  
    <p style="margin: 0;">--------------------------------------------------------------------------------------------------------------</p>


    <p>Type de matériau: <span style="color: blue;">${type_materiau_label}</span></p>
    <p>Niveau de protection foudre: <span style="color: blue;">${niveauprotection}</span></p>
    <p>Courant impulsionnel de foudre: <span style="color: blue;">${courant_impulsionnel_foudre} kA</span></p>
    <p>Coefficient de répartition du courant de foudre: <span style="color: blue;">${coefficient_repartition_courant}</span></p>
    <p>Résistance ohmique spécifique du conducteur à la température ambiante ;&rho: <span style="color: blue;">${resistance_ohmique} &ohm;.m</span></p>
    <p>Coefficient de température de la résistance &alpha;: <span style="color: blue;">${coefficient_temperature} 1/K</span></p>
    <p>Densité du matériau &gamma;: <span style="color: blue;">${densite_materiau} kg/m<sup>3</sup></span></p>
    <p>Capacité thermique Cw: <span style="color: blue;">${capacite_thermique} J/kg.K</span></p>
    <p>Température de fusion &theta;s : <span style="color: blue;">${temperature_fusion} °C</span></p>
    <p>Température ambiante &theta;0 : <span style="color: blue;">${temperature_ambiante} °C</span></p>


    <p style="margin: 0;">--------------------------------------------------------------------------------------------------------------</p>
    <h4 style="margin: 0px 0;">RESULTATS DE SORTIE</h4>  
    <p style="margin: 0;">--------------------------------------------------------------------------------------------------------------</p>

    <p><strong>Section minimale requise s : </strong><span style="color: blue;"><strong>${section_minimale_conducteur} mm<sup>2 </strong></sup></span></p>


    </body>
    </html>
    `;


    newDoc.open();

    newDoc.write(html);
    newDoc.close();

    newWindow.onload = function () {

    newWindow.print();

    const tempWindow = window.open('', '_blank', 'width=1,height=1');
    tempWindow.blur(); // Perdre le focus de la fenêtre temporaire
    window.focus(); // Revenir à la fenêtre principale
    setTimeout(() => tempWindow.close(), 100); // Fermer la fenêtre temporaire

    }

} else if (cliqued_button===6) {


    const type_materiau_label = (document.getElementById('materiau-conducteur-liaisons').options[document.getElementById('materiau-conducteur-liaisons').selectedIndex]).text;
   
    const niveauprotection=document.getElementById('niveau-protection-liaisons').value;   
    const courant_impulsionnel_foudre=document.getElementById('courant-impulsionnel-liaisons').value;
    const coefficient_repartition_courant=document.getElementById('coef-repartition-liaisons').value;
    const resistance_ohmique=document.getElementById('resistance-ohmique-liaisons').value;
    const coefficient_temperature=document.getElementById('coefficient-temperature-liaisons').value;
    const densite_materiau=document.getElementById('densite-materiau-liaisons').value;
    const capacite_thermique=document.getElementById('capacite-thermique-liaisons').value;
    const temperature_fusion=document.getElementById('temperature-fusion-liaisons').value;
    const temperature_ambiante=document.getElementById('temperature-ambiante-liaisons').value;
    const section_minimale_conducteur=document.getElementById('section-minimale-liaisons').value;


    const newWindow = window.open('aaaaa', '_blank');

    const newDoc = newWindow.document;


    // Obtenir la date actuelle
    const currentDate = new Date();
    const formattedDate = currentDate.toLocaleDateString('fr-FR', {
    Année: 'numeric',
    Mois: 'long',
    Jour: 'numeric'
    });


    const versionlogicielle='ELP-DV-SCM-07-09-01A';
    const normeReference='NF EN 62305-1';


    const html = `
    <html>
    <head>
    <title>SECTION MINIMALE REQUISE DES CONDUCTEURS DE MISE A LA TERRE ${''} </title>
        <style>
        @media print {
                @page {
                    margin-left: 1cm;
                    margin-right: 1cm;
                    margin-top: 2cm;
                    margin-bottom: 1cm;
                }
                body {
                    margin: 0;
                }
                .page-number:after {
                    content: counter(page);
                }
                .page-number {
                    position: fixed;
                    bottom: 0;
                    width: 100%;
                    text-align: center;
                }
            }

            
            /* Optional: Additional CSS styles for the output window */
        </style>
    </head>
    <body>

    <h3 style="text-decoration: underline; text-align: center;">DONNEES DE SORTIE LOGICIELLE</h3>
    <p style="text-align: center">Version logicielle: <span style="color: blue;">${versionlogicielle}</span></p>

    <p style="margin: 0;">--------------------------------------------------------------------------------------------------------------</p>
    <h4 style="margin: 0px 0;">DONNEES GENERALES</h4>  
    <p style="margin: 0;">--------------------------------------------------------------------------------------------------------------</p>
    <p>Date: <span style="color: blue;">${formattedDate}</span></p>
    <p>Norme de référence: <span style="color: blue;">${normeReference}</span></p>


    <p style="margin: 0;">--------------------------------------------------------------------------------------------------------------</p>
    <h4 style="margin: 0px 0;">DONNEES D'ENTREE SAISIS SAISIS</h4>  
    <p style="margin: 0;">--------------------------------------------------------------------------------------------------------------</p>


    <p>Type de matériau: <span style="color: blue;">${type_materiau_label}</span></p>
    <p>Niveau de protection foudre: <span style="color: blue;">${niveauprotection}</span></p>
    <p>Courant impulsionnel de foudre: <span style="color: blue;">${courant_impulsionnel_foudre} kA</span></p>
    <p>Coefficient de répartition du courant de foudre: <span style="color: blue;">${coefficient_repartition_courant}</span></p>
    <p>Résistance ohmique spécifique du conducteur à la température ambiante ;&rho: <span style="color: blue;">${resistance_ohmique} &ohm;.m</span></p>
    <p>Coefficient de température de la résistance &alpha;: <span style="color: blue;">${coefficient_temperature} 1/K</span></p>
    <p>Densité du matériau &gamma;: <span style="color: blue;">${densite_materiau} kg/m<sup>3</sup></span></p>
    <p>Capacité thermique Cw: <span style="color: blue;">${capacite_thermique} J/kg.K</span></p>
    <p>Température de fusion &theta;s : <span style="color: blue;">${temperature_fusion} °C</span></p>
    <p>Température ambiante &theta;0 : <span style="color: blue;">${temperature_ambiante} °C</span></p>


    <p style="margin: 0;">--------------------------------------------------------------------------------------------------------------</p>
    <h4 style="margin: 0px 0;">RESULTATS DE SORTIE</h4>  
    <p style="margin: 0;">--------------------------------------------------------------------------------------------------------------</p>

    <p><strong>Section minimale requise s : </strong><span style="color: blue;"><strong>${section_minimale_conducteur} mm<sup>2 </strong></sup></span></p>


    </body>
    </html>
    `;


    newDoc.open();

    newDoc.write(html);
    newDoc.close();

    newWindow.onload = function () {

    newWindow.print();

    const tempWindow = window.open('', '_blank', 'width=1,height=1');
    tempWindow.blur(); // Perdre le focus de la fenêtre temporaire
    window.focus(); // Revenir à la fenêtre principale
    setTimeout(() => tempWindow.close(), 100); // Fermer la fenêtre temporaire

    }

} else if (cliqued_button===4) {


    const type_materiau_label = (document.getElementById('materiau-conducteur-terre').options[document.getElementById('materiau-conducteur-terre').selectedIndex]).text;
    
    const courant_court_circuit=document.getElementById('courant-court-circuit').value;   
    const duree_court_circuit=document.getElementById('duree-court-circuit').value;  
    const Qc=document.getElementById('Qc').value;  
    const Beta=document.getElementById('Beta').value;
    const rho20=document.getElementById('rho20').value;
    const temperature_initiale=document.getElementById('temperature-initiale').value;
    const temperature_finale=document.getElementById('temperature-finale').value;
    const section_minimale_terre=document.getElementById('section-minimale-terre').value;

    const newWindow = window.open('aaaaa', '_blank');

    const newDoc = newWindow.document;


    // Obtenir la date actuelle
    const currentDate = new Date();
    const formattedDate = currentDate.toLocaleDateString('fr-FR', {
    Année: 'numeric',
    Mois: 'long',
    Jour: 'numeric'
    });


    const versionlogicielle='ELP-DV-SET-07-09-01A';
    const normeReference='NF EN 62305-1';


    const html = `
    <html>
    <head>
    <title>SECTION MINIMALE REQUISE DES ELECTRODES DE TERRE ${''} </title>
        <style>
        @media print {
                @page {
                    margin-left: 1cm;
                    margin-right: 1cm;
                    margin-top: 2cm;
                    margin-bottom: 1cm;
                }
                body {
                    margin: 0;
                }
                .page-number:after {
                    content: counter(page);
                }
                .page-number {
                    position: fixed;
                    bottom: 0;
                    width: 100%;
                    text-align: center;
                }
            }

            
            /* Optional: Additional CSS styles for the output window */
        </style>
    </head>
    <body>

    <h3 style="text-decoration: underline; text-align: center;">DONNEES DE SORTIE LOGICIELLE</h3>
    <p style="text-align: center">Version logicielle: <span style="color: blue;">${versionlogicielle}</span></p>

    <p style="margin: 0;">--------------------------------------------------------------------------------------------------------------</p>
    <h4 style="margin: 0px 0;">DONNEES GENERALES</h4>  
    <p style="margin: 0;">--------------------------------------------------------------------------------------------------------------</p>
    <p>Date: <span style="color: blue;">${formattedDate}</span></p>
    <p>Norme de référence: <span style="color: blue;">${normeReference}</span></p>


    <p style="margin: 0;">--------------------------------------------------------------------------------------------------------------</p>
    <h4 style="margin: 0px 0;">DONNEES D'ENTREE SAISIS SAISIS</h4>  
    <p style="margin: 0;">--------------------------------------------------------------------------------------------------------------</p>

    <p>Type de matériau: <span style="color: blue;">${type_materiau_label}</span></p>
    <p>Courant de court-circuit présumé Ik : <span style="color: blue;">${courant_court_circuit} kA eff</span></p>
    <p>Durée du courant de court-circuit présumé t : <span style="color: blue;">${duree_court_circuit} s </span></p>
    <p>Capacité volumétrique de chaleur du conducteur 20°C Qc : <span style="color: blue;">${Qc} J/°C.mm<sup>3</sup> </span></p>
    <p>Inverse du coefficient de température de la résistivité à 0°C du conducteur &beta; : <span style="color: blue;">${Qc} °C </span></p>
    <p>Résistivité du conducteur à 20 °C &rho;20 : <span style="color: blue;">${Qc} &ohm;.m </span></p>
    <p>Température initiale &theta;i : <span style="color: blue;">${temperature_initiale} °C</span></p>
    <p>Température ambiante &theta;f : <span style="color: blue;">${temperature_finale} °C</span></p>


    <p style="margin: 0;">--------------------------------------------------------------------------------------------------------------</p>
    <h4 style="margin: 0px 0;">RESULTATS DE SORTIE</h4>  
    <p style="margin: 0;">--------------------------------------------------------------------------------------------------------------</p>

    <p><strong>Section minimale requise des électrodes de terre : </strong><span style="color: blue;"><strong>${section_minimale_terre} mm<sup>2 </strong></sup></span></p>


    </body>
    </html>
    `;


    newDoc.open();

    newDoc.write(html);
    newDoc.close();

    newWindow.onload = function () {

    newWindow.print();

    const tempWindow = window.open('', '_blank', 'width=1,height=1');
    tempWindow.blur(); // Perdre le focus de la fenêtre temporaire
    window.focus(); // Revenir à la fenêtre principale
    setTimeout(() => tempWindow.close(), 100); // Fermer la fenêtre temporaire

    }

} else if (cliqued_button===5) {


    const calibre_protection_label = (document.getElementById('calibre-protection').options[document.getElementById('calibre-protection').selectedIndex]).text;
  
    const classe_parafoudre_label = (document.getElementById('classe-parafoudre').options[document.getElementById('classe-parafoudre').selectedIndex]).text;
  
    const section_minimale_raccordement_s1=document.getElementById('section-minimale-raccordement-s1').value;
    const section_minimale_raccordement_s2=document.getElementById('section-minimale-raccordement-s2').value;

    const newWindow = window.open('aaaaa', '_blank');

    const newDoc = newWindow.document;


    // Obtenir la date actuelle
    const currentDate = new Date();
    const formattedDate = currentDate.toLocaleDateString('fr-FR', {
    Année: 'numeric',
    Mois: 'long',
    Jour: 'numeric'
    });


    const versionlogicielle='ELP-DV-SRP-07-09-01A';
    const normeReference='NF EN 62305-1';


    const html = `
    <html>
    <head>
    <title>SECTION MINIMALE DES CONDUCTEURS DE RACCORDEMENT DES PARAFOUDRES ${''} </title>
        <style>
        @media print {
                @page {
                    margin-left: 1cm;
                    margin-right: 1cm;
                    margin-top: 2cm;
                    margin-bottom: 1cm;
                }
                body {
                    margin: 0;
                }
                .page-number:after {
                    content: counter(page);
                }
                .page-number {
                    position: fixed;
                    bottom: 0;
                    width: 100%;
                    text-align: center;
                }
            }

            
            /* Optional: Additional CSS styles for the output window */
        </style>
    </head>
    <body>

    <h3 style="text-decoration: underline; text-align: center;">DONNEES DE SORTIE LOGICIELLE</h3>
    <p style="text-align: center">Version logicielle: <span style="color: blue;">${versionlogicielle}</span></p>

    <p style="margin: 0;">--------------------------------------------------------------------------------------------------------------</p>
    <h4 style="margin: 0px 0;">DONNEES GENERALES</h4>  
    <p style="margin: 0;">--------------------------------------------------------------------------------------------------------------</p>
    <p>Date: <span style="color: blue;">${formattedDate}</span></p>
    <p>Norme de référence: <span style="color: blue;">${normeReference}</span></p>


    <p style="margin: 0;">--------------------------------------------------------------------------------------------------------------</p>
    <h4 style="margin: 0px 0;">DONNEES D'ENTREE SAISIS SAISIS</h4>  
    <p style="margin: 0;">--------------------------------------------------------------------------------------------------------------</p>

    <p>Calibre de la protection amont: <span style="color: blue;">${calibre_protection_label}</span></p>
    <p>Classe du parafoudre : <span style="color: blue;">${classe_parafoudre_label}</span></p>


    <p style="margin: 0;">--------------------------------------------------------------------------------------------------------------</p>
    <h4 style="margin: 0px 0;">RESULTATS DE SORTIE</h4>  
    <p style="margin: 0;">--------------------------------------------------------------------------------------------------------------</p>

    <p><strong>Section minimale requise des câbles de raccordement du parafoudre (Phases/Neutre) : </strong><span style="color: blue;"><strong>${section_minimale_raccordement_s1} mm<sup>2 </strong></sup></span></p>
    <p><strong>Section minimale requise des câbles de raccordement du parafoudre (PE) : </strong><span style="color: blue;"><strong>${section_minimale_raccordement_s2} mm<sup>2 </strong></sup></span></p>

    </body>
    </html>
    `;


    newDoc.open();

    newDoc.write(html);
    newDoc.close();

    newWindow.onload = function () {

    newWindow.print();

    const tempWindow = window.open('', '_blank', 'width=1,height=1');
    tempWindow.blur(); // Perdre le focus de la fenêtre temporaire
    window.focus(); // Revenir à la fenêtre principale
    setTimeout(() => tempWindow.close(), 100); // Fermer la fenêtre temporaire

    }

} else if (cliqued_button===7) {

    


    const calibre_protection_label = (document.getElementById('courant-foudre-iimp-in').options[document.getElementById('courant-foudre-iimp-in').selectedIndex]).text;

    const classe_parafoudre_label = (document.getElementById('classe-parafoudre-calibre').options[document.getElementById('classe-parafoudre-calibre').selectedIndex]).text;

    const calibre_deconnecteur_parafoudre = document.getElementById('calibre-deconnecteur-parafoudre').value;

    const courant_foudre_label = document.getElementById('current-label').innerText;


    const newWindow = window.open('aaaaa', '_blank');

    const newDoc = newWindow.document;


    // Obtenir la date actuelle
    const currentDate = new Date();
    const formattedDate = currentDate.toLocaleDateString('fr-FR', {
    Année: 'numeric',
    Mois: 'long',
    Jour: 'numeric'
    });


    const versionlogicielle='ELP-DV-CDP-07-09-01A';
    const normeReference='NF EN 62305-1';


    const html = `
    <html>
    <head>
    <title>SECTION MINIMALE DES CONDUCTEURS DE RACCORDEMENT DES PARAFOUDRES ${''} </title>
        <style>
        @media print {
                @page {
                    margin-left: 1cm;
                    margin-right: 1cm;
                    margin-top: 2cm;
                    margin-bottom: 1cm;
                }
                body {
                    margin: 0;
                }
                .page-number:after {
                    content: counter(page);
                }
                .page-number {
                    position: fixed;
                    bottom: 0;
                    width: 100%;
                    text-align: center;
                }
            }

            
            /* Optional: Additional CSS styles for the output window */
        </style>
    </head>
    <body>

    <h3 style="text-decoration: underline; text-align: center;">DONNEES DE SORTIE LOGICIELLE</h3>
    <p style="text-align: center">Version logicielle: <span style="color: blue;">${versionlogicielle}</span></p>

    <p style="margin: 0;">--------------------------------------------------------------------------------------------------------------</p>
    <h4 style="margin: 0px 0;">DONNEES GENERALES</h4>  
    <p style="margin: 0;">--------------------------------------------------------------------------------------------------------------</p>
    <p>Date: <span style="color: blue;">${formattedDate}</span></p>
    <p>Norme de référence: <span style="color: blue;">${normeReference}</span></p>


    <p style="margin: 0;">--------------------------------------------------------------------------------------------------------------</p>
    <h4 style="margin: 0px 0;">DONNEES D'ENTREE SAISIS SAISIS</h4>  
    <p style="margin: 0;">--------------------------------------------------------------------------------------------------------------</p>

    <p>${courant_foudre_label} : <span style="color: blue;"> ${calibre_protection_label}</span></p>
    <p>Classe du parafoudre : <span style="color: blue;">${classe_parafoudre_label}</span></p>


    <p style="margin: 0;">--------------------------------------------------------------------------------------------------------------</p>
    <h4 style="margin: 0px 0;">RESULTATS DE SORTIE</h4>  
    <p style="margin: 0;">--------------------------------------------------------------------------------------------------------------</p>

    <p><strong>Calibre du déconnecteur "D" de type fusible du parafoudre [Norme IEC 61643-12] : </strong><span style="color: blue;"><strong>${calibre_deconnecteur_parafoudre} A gG </strong></sup></span></p>
 
    </body>
    </html>
    `;


    newDoc.open();

    newDoc.write(html);
    newDoc.close();

    newWindow.onload = function () {

    newWindow.print();

    const tempWindow = window.open('', '_blank', 'width=1,height=1');
    tempWindow.blur(); // Perdre le focus de la fenêtre temporaire
    window.focus(); // Revenir à la fenêtre principale
    setTimeout(() => tempWindow.close(), 100); // Fermer la fenêtre temporaire

    }

} else if (cliqued_button===8) {


    const niveau_protection_option = document.getElementById('niveau-protection-option').value;
    const courant_impulsionnel_angle_protection = document.getElementById('courant-impulsionnel-angle-protection').value;
    const surelevation_protection = document.getElementById('surelevation-protection').value;
    const rayon_sphere_fictive_angle_protection = document.getElementById('rayon-sphere-fictive-angle-protection').value;
    const angle_protection = document.getElementById('angle-protection').value;

    const rayon_protection_angle_protection = document.getElementById('rayon-protection-angle-protection').value;


    const newWindow = window.open('aaaaa', '_blank');

    const newDoc = newWindow.document;


    // Obtenir la date actuelle
    const currentDate = new Date();
    const formattedDate = currentDate.toLocaleDateString('fr-FR', {
    Année: 'numeric',
    Mois: 'long',
    Jour: 'numeric'
    });


    const versionlogicielle='ELP-DV-APC-07-09-01A';
    const normeReference='NF EN 62305-1';


    const html = `
    <html>
    <head>
    <title>SECTION MINIMALE DES CONDUCTEURS DE RACCORDEMENT DES PARAFOUDRES ${''} </title>
        <style>
        @media print {
                @page {
                    margin-left: 1cm;
                    margin-right: 1cm;
                    margin-top: 2cm;
                    margin-bottom: 1cm;
                }
                body {
                    margin: 0;
                }
                .page-number:after {
                    content: counter(page);
                }
                .page-number {
                    position: fixed;
                    bottom: 0;
                    width: 100%;
                    text-align: center;
                }
            }

            
            /* Optional: Additional CSS styles for the output window */
        </style>
    </head>
    <body>

    <h3 style="text-decoration: underline; text-align: center;">DONNEES DE SORTIE LOGICIELLE</h3>
    <p style="text-align: center">Version logicielle: <span style="color: blue;">${versionlogicielle}</span></p>

    <p style="margin: 0;">--------------------------------------------------------------------------------------------------------------</p>
    <h4 style="margin: 0px 0;">DONNEES GENERALES</h4>  
    <p style="margin: 0;">--------------------------------------------------------------------------------------------------------------</p>
    <p>Date: <span style="color: blue;">${formattedDate}</span></p>
    <p>Norme de référence: <span style="color: blue;">${normeReference}</span></p>


    <p style="margin: 0;">--------------------------------------------------------------------------------------------------------------</p>
    <h4 style="margin: 0px 0;">DONNEES D'ENTREE SAISIS SAISIS</h4>  
    <p style="margin: 0;">--------------------------------------------------------------------------------------------------------------</p>


    <p>Niveau de protection : <span style="color: blue;">${niveau_protection_option}</span></p>
    <p>Courant impulsionnel de foudre Iimp (10/350) : <span style="color: blue;">${courant_impulsionnel_angle_protection} kA </span></p>
    <p>Surélévation de la structure de protection &Delta;H : <span style="color: blue;">${surelevation_protection} m</span></p>
    <p>Rayon de la sphère fictive R : <span style="color: blue;">${rayon_sphere_fictive_angle_protection} m </span></p>
    <p>Angle de protection &alpha; : <span style="color: blue;">${angle_protection} ° </span></p>


    <p style="margin: 0;">--------------------------------------------------------------------------------------------------------------</p>
    <h4 style="margin: 0px 0;">RESULTATS DE SORTIE</h4>  
    <p style="margin: 0;">--------------------------------------------------------------------------------------------------------------</p>

    <p><strong>Rayon de protection Rp : </strong><span style="color: blue;"><strong>${rayon_protection_angle_protection} m </strong></sup></span></p>

    </body>
    </html>
    `;


    newDoc.open();

    newDoc.write(html);
    newDoc.close();

    newWindow.onload = function () {

    newWindow.print();

    const tempWindow = window.open('', '_blank', 'width=1,height=1');
    tempWindow.blur(); // Perdre le focus de la fenêtre temporaire
    window.focus(); // Revenir à la fenêtre principale
    setTimeout(() => tempWindow.close(), 100); // Fermer la fenêtre temporaire

    }

} else if (cliqued_button===9) {


    const niveau_protection_sphere_fictive = document.getElementById('niveau-protection-option-sf').value;
    const courant_impulsionnel_sphere_fictive = document.getElementById('courant-impulsionnel-sphere-fictive').value;
    const surelevation_protection = document.getElementById('surelevation-protection-sf').value;
    const rayon_sphere_fictive_sphere_fictive = document.getElementById('rayon-sphere-fictive-sphere-fictive').value;

    const rayon_protection_sphere_fictive = document.getElementById('rayon-protection-sphere-fictive').value;


    const newWindow = window.open('aaaaa', '_blank');

    const newDoc = newWindow.document;


    // Obtenir la date actuelle
    const currentDate = new Date();
    const formattedDate = currentDate.toLocaleDateString('fr-FR', {
    Année: 'numeric',
    Mois: 'long',
    Jour: 'numeric'
    });


    const versionlogicielle='ELP-DV-SFC-07-09-01A';
    const normeReference='NF EN 62305-1';


    const html = `
    <html>
    <head>
    <title>SECTION MINIMALE DES CONDUCTEURS DE RACCORDEMENT DES PARAFOUDRES ${''} </title>
        <style>
        @media print {
                @page {
                    margin-left: 1cm;
                    margin-right: 1cm;
                    margin-top: 2cm;
                    margin-bottom: 1cm;
                }
                body {
                    margin: 0;
                }
                .page-number:after {
                    content: counter(page);
                }
                .page-number {
                    position: fixed;
                    bottom: 0;
                    width: 100%;
                    text-align: center;
                }
            }

            
            /* Optional: Additional CSS styles for the output window */
        </style>
    </head>
    <body>

    <h3 style="text-decoration: underline; text-align: center;">DONNEES DE SORTIE LOGICIELLE</h3>
    <p style="text-align: center">Version logicielle: <span style="color: blue;">${versionlogicielle}</span></p>

    <p style="margin: 0;">--------------------------------------------------------------------------------------------------------------</p>
    <h4 style="margin: 0px 0;">DONNEES GENERALES</h4>  
    <p style="margin: 0;">--------------------------------------------------------------------------------------------------------------</p>
    <p>Date: <span style="color: blue;">${formattedDate}</span></p>
    <p>Norme de référence: <span style="color: blue;">${normeReference}</span></p>


    <p style="margin: 0;">--------------------------------------------------------------------------------------------------------------</p>
    <h4 style="margin: 0px 0;">DONNEES D'ENTREE SAISIS SAISIS</h4>  
    <p style="margin: 0;">--------------------------------------------------------------------------------------------------------------</p>


    <p>Niveau de protection : <span style="color: blue;">${niveau_protection_sphere_fictive}</span></p>
    <p>Courant impulsionnel de foudre Iimp (10/350) : <span style="color: blue;">${courant_impulsionnel_sphere_fictive} kA </span></p>
    <p>Surélévation de la structure de protection &Delta;H : <span style="color: blue;">${surelevation_protection} m</span></p>
    <p>Rayon de la sphère fictive R : <span style="color: blue;">${rayon_sphere_fictive_sphere_fictive} m </span></p>

    <p style="margin: 0;">--------------------------------------------------------------------------------------------------------------</p>
    <h4 style="margin: 0px 0;">RESULTATS DE SORTIE</h4>  
    <p style="margin: 0;">--------------------------------------------------------------------------------------------------------------</p>

    <p><strong>Rayon de protection Rp : </strong><span style="color: blue;"><strong>${rayon_protection_sphere_fictive} m </strong></sup></span></p>

    </body>
    </html>
    `;


    newDoc.open();

    newDoc.write(html);
    newDoc.close();

    newWindow.onload = function () {

    newWindow.print();

    const tempWindow = window.open('', '_blank', 'width=1,height=1');
    tempWindow.blur(); // Perdre le focus de la fenêtre temporaire
    window.focus(); // Revenir à la fenêtre principale
    setTimeout(() => tempWindow.close(), 100); // Fermer la fenêtre temporaire

    }

} else if (cliqued_button===10) {


    const niveau_protection_pda = document.getElementById('niveau-protection-option-pda').value;
    const icpe = (document.getElementById('icpe').options[document.getElementById('icpe').selectedIndex]).text;
    const surelevation_protection = document.getElementById('surelevation-protection-pda').value;
    const rayon_sphere_fictive_pda = document.getElementById('rayon-sphere-fictive-pda').value;
    const deltaT_pda = document.getElementById('deltaT-pda').value;

    const rayon_protection_pda = document.getElementById('rayon-protection-pda').value;


    const newWindow = window.open('aaaaa', '_blank');

    const newDoc = newWindow.document;


    // Obtenir la date actuelle
    const currentDate = new Date();
    const formattedDate = currentDate.toLocaleDateString('fr-FR', {
    Année: 'numeric',
    Mois: 'long',
    Jour: 'numeric'
    });


    const versionlogicielle='ELP-DV-PDA-07-09-01A';
    const normeReference='NF EN 62305-1';


    const html = `
    <html>
    <head>
    <title>SECTION MINIMALE DES CONDUCTEURS DE RACCORDEMENT DES PARAFOUDRES ${''} </title>
        <style>
        @media print {
                @page {
                    margin-left: 1cm;
                    margin-right: 1cm;
                    margin-top: 2cm;
                    margin-bottom: 1cm;
                }
                body {
                    margin: 0;
                }
                .page-number:after {
                    content: counter(page);
                }
                .page-number {
                    position: fixed;
                    bottom: 0;
                    width: 100%;
                    text-align: center;
                }
            }

            
            /* Optional: Additional CSS styles for the output window */
        </style>
    </head>
    <body>

    <h3 style="text-decoration: underline; text-align: center;">DONNEES DE SORTIE LOGICIELLE</h3>
    <p style="text-align: center">Version logicielle: <span style="color: blue;">${versionlogicielle}</span></p>

    <p style="margin: 0;">--------------------------------------------------------------------------------------------------------------</p>
    <h4 style="margin: 0px 0;">DONNEES GENERALES</h4>  
    <p style="margin: 0;">--------------------------------------------------------------------------------------------------------------</p>
    <p>Date: <span style="color: blue;">${formattedDate}</span></p>
    <p>Norme de référence: <span style="color: blue;">${normeReference}</span></p>


    <p style="margin: 0;">--------------------------------------------------------------------------------------------------------------</p>
    <h4 style="margin: 0px 0;">DONNEES D'ENTREE SAISIS SAISIS</h4>  
    <p style="margin: 0;">--------------------------------------------------------------------------------------------------------------</p>


    <p>Niveau de protection : <span style="color: blue;">${niveau_protection_pda}</span></p>
    <p>Installation ICPE (OUI/NON) : <span style="color: blue;">${icpe} </span></p>
    <p>Surélévation de la structure de protection &Delta;H : <span style="color: blue;">${surelevation_protection} m</span></p>
    <p>Rayon de la sphère fictive R : <span style="color: blue;">${rayon_sphere_fictive_pda} m</span></p>
    <p>Temps d'avance à l'amorçage du PDA &Delta;T : <span style="color: blue;">${deltaT_pda} &micro;s </span></p>

    <p style="margin: 0;">--------------------------------------------------------------------------------------------------------------</p>
    <h4 style="margin: 0px 0;">RESULTATS DE SORTIE</h4>  
    <p style="margin: 0;">--------------------------------------------------------------------------------------------------------------</p>

    <p><strong>Rayon de protection Rp : </strong><span style="color: blue;"><strong>${rayon_protection_pda} m </strong></sup></span></p>

    </body>
    </html>
    `;


    newDoc.open();

    newDoc.write(html);
    newDoc.close();

    newWindow.onload = function () {

    newWindow.print();

    const tempWindow = window.open('', '_blank', 'width=1,height=1');
    tempWindow.blur(); // Perdre le focus de la fenêtre temporaire
    window.focus(); // Revenir à la fenêtre principale
    setTimeout(() => tempWindow.close(), 100); // Fermer la fenêtre temporaire

    }

} else if (cliqued_button===11) {


    const niveau_protection_sphere_fictive = document.getElementById('niveau-protection-p').value;
    const courant_impulsionnel_p = document.getElementById('courant-impulsionnel-p').value;
    const surelevation_protection_1 = document.getElementById('surelevation-pointe-1').value;
    const surelevation_protection_2 = document.getElementById('surelevation-pointe-2').value;
    const distance_pointes_1_2 = document.getElementById('distance-pointes-1-2').value;
    const rayon_sphere_fictive_p = document.getElementById('rayon-sphere-fictive-p').value;

    const centre_x0_sphere = document.getElementById('centre-x0-sphere').value;
    const centre_y0_sphere = document.getElementById('centre-y0-sphere').value;
    const profondeur_penetration_petitepointe = document.getElementById('profondeur-penetration-petitepointe').value;


    const newWindow = window.open('aaaaa', '_blank');

    const newDoc = newWindow.document;


    // Obtenir la date actuelle
    const currentDate = new Date();
    const formattedDate = currentDate.toLocaleDateString('fr-FR', {
    Année: 'numeric',
    Mois: 'long',
    Jour: 'numeric'
    });


    const versionlogicielle='ELP-DV-PPS-07-09-01A';
    const normeReference='NF EN 62305-1';


    const html = `
    <html>
    <head>
    <title>PROFONDEUR DE PENETRATION DE LA SPHERE FICTIVE ${''} </title>
        <style>
        @media print {
                @page {
                    margin-left: 1cm;
                    margin-right: 1cm;
                    margin-top: 2cm;
                    margin-bottom: 1cm;
                }
                body {
                    margin: 0;
                }
                .page-number:after {
                    content: counter(page);
                }
                .page-number {
                    position: fixed;
                    bottom: 0;
                    width: 100%;
                    text-align: center;
                }
            }

            
            /* Optional: Additional CSS styles for the output window */
        </style>
    </head>
    <body>

    <h3 style="text-decoration: underline; text-align: center;">DONNEES DE SORTIE LOGICIELLE</h3>
    <p style="text-align: center">Version logicielle: <span style="color: blue;">${versionlogicielle}</span></p>

    <p style="margin: 0;">--------------------------------------------------------------------------------------------------------------</p>
    <h4 style="margin: 0px 0;">DONNEES GENERALES</h4>  
    <p style="margin: 0;">--------------------------------------------------------------------------------------------------------------</p>
    <p>Date: <span style="color: blue;">${formattedDate}</span></p>
    <p>Norme de référence: <span style="color: blue;">${normeReference}</span></p>


    <p style="margin: 0;">--------------------------------------------------------------------------------------------------------------</p>
    <h4 style="margin: 0px 0;">DONNEES D'ENTREE SAISIS SAISIS</h4>  
    <p style="margin: 0;">--------------------------------------------------------------------------------------------------------------</p>


    <p>Niveau de protection : <span style="color: blue;">${niveau_protection_sphere_fictive}</span></p>
    <p>Courant impulsionnel de foudre Iimp (10/350) : <span style="color: blue;">${courant_impulsionnel_p} kA </span></p>
    <p>Surélévation de la pointe 1 &Delta;H1 : <span style="color: blue;">${surelevation_protection_1} m</span></p>
    <p>Surélévation de la pointe 2 &Delta;H2 : <span style="color: blue;">${surelevation_protection_2} m</span></p>
    <p>Distance entre les pointes 1 et 2 D : <span style="color: blue;">${distance_pointes_1_2} m</span></p>
    <p>Rayon de la sphère fictive R : <span style="color: blue;">${rayon_sphere_fictive_p} m </span></p>

    <p style="margin: 0;">--------------------------------------------------------------------------------------------------------------</p>
    <h4 style="margin: 0px 0;">RESULTATS DE SORTIE</h4>  
    <p style="margin: 0;">--------------------------------------------------------------------------------------------------------------</p>

    <p><strong>Centre X0 de la sphère fictive : </strong><span style="color: blue;"><strong>${centre_x0_sphere} m </strong></sup></span></p>
    <p><strong>Centre Y0 de la sphère fictive : </strong><span style="color: blue;"><strong>${centre_y0_sphere} m </strong></sup></span></p>
    <p><strong>Profondeur de pénétration de la sphère fictive/petite pointe p : </strong><span style="color: blue;"><strong>${profondeur_penetration_petitepointe} m </strong></sup></span></p>

    </body>
    </html>
    `;


    newDoc.open();

    newDoc.write(html);
    newDoc.close();

    newWindow.onload = function () {


    newWindow.print();

    const tempWindow = window.open('', '_blank', 'width=1,height=1');
    tempWindow.blur(); // Perdre le focus de la fenêtre temporaire
    window.focus(); // Revenir à la fenêtre principale
    setTimeout(() => tempWindow.close(), 100); // Fermer la fenêtre temporaire

    }

} else if (cliqued_button===16) {


    const niveau_protection_force = document.getElementById('niveau-protection-force').value;
    const courant_impulsionnel_force = document.getElementById('courant-max-force').value;

    const newWindow = window.open('aaaaa', '_blank');

    const newDoc = newWindow.document;


    // Obtenir la date actuelle
    const currentDate = new Date();
    const formattedDate = currentDate.toLocaleDateString('fr-FR', {
    Année: 'numeric',
    Mois: 'long',
    Jour: 'numeric'
    });


    const versionlogicielle='ELP-DV-FEC-07-09-01A';
    const normeReference='NF EN 62305-1';


    const html = `
    <html>
    <head>
    <title>FORCES ELECTRODYNAMIQUES EXERCES SUR UN CONDUCTEUR DU SPF ${''} </title>
        <style>
        @media print {
                @page {
                    margin-left: 1cm;
                    margin-right: 1cm;
                    margin-top: 2cm;
                    margin-bottom: 1cm;
                }
                body {
                    margin: 0;
                }
                .page-number:after {
                    content: counter(page);
                }
                .page-number {
                    position: fixed;
                    bottom: 0;
                    width: 100%;
                    text-align: center;
                }
            }

            
            /* Optional: Additional CSS styles for the output window */
        </style>
    </head>
    <body>

    <h3 style="text-decoration: underline; text-align: center;">DONNEES DE SORTIE LOGICIELLE</h3>
    <p style="text-align: center">Version logicielle: <span style="color: blue;">${versionlogicielle}</span></p>

    <p style="margin: 0;">--------------------------------------------------------------------------------------------------------------</p>
    <h4 style="margin: 0px 0;">DONNEES GENERALES</h4>  
    <p style="margin: 0;">--------------------------------------------------------------------------------------------------------------</p>
    <p>Date: <span style="color: blue;">${formattedDate}</span></p>
    <p>Norme de référence: <span style="color: blue;">${normeReference}</span></p>


    <p style="margin: 0;">--------------------------------------------------------------------------------------------------------------</p>
    <h4 style="margin: 0px 0;">DONNEES D'ENTREE SAISIS SAISIS</h4>  
    <p style="margin: 0;">--------------------------------------------------------------------------------------------------------------</p>
    


    <p>Niveau de protection : <span style="color: blue;">${niveau_protection_force}</span></p>
    <p>Courant impulsionnel de foudre Iimp (10/350) : <span style="color: blue;">${courant_impulsionnel_force} kA </span></p>
    
    <div id="input-data-container"></div>


    <p style="margin: 0;">--------------------------------------------------------------------------------------------------------------</p>
    <h4 style="margin: 0px 0;">RESULTATS DE SORTIE</h4>  
    <p style="margin: 0;">--------------------------------------------------------------------------------------------------------------</p>

    <div id="output-data-container"></div>

    </body>
    </html>
    `;


    newDoc.open();

    newDoc.write(html);
    newDoc.close();

    newWindow.onload = function () {

        

        const options_conducteur = document.getElementById('dropdown-menu-force').options; 
        const inputdatacontainer = newDoc.getElementById('input-data-container');
        const outputdatacontainer = newDoc.getElementById('output-data-container');

        for (let i = 0; i < options_conducteur.length; i++) {


            const selectedConducteur = options_conducteur [i].text;

            const distance_fixations = ConducteurData[i]["distance_fixations"];
            const angle_inclinaison = ConducteurData[i]["angle_inclinaison"];
            const position_x0 = ConducteurData[i]["X0"];
            const position_Y0 = ConducteurData[i]["Y0"];
            const coefficient_repartition = ConducteurData[i]["coefficient_repartition"];
            const force_traction = ConducteurData[i]["forcelaplacetraction"];
            const force_cisaillement = ConducteurData[i]["forcelaplacecisaillement"];


            inputdatacontainer.innerHTML += `
            <h4 style="text-decoration: underline;">${selectedConducteur}</span></h4>
            <p>Distance entre fixations du conducteur sélectionné : <span style="color: blue;">${distance_fixations} m </span></p>
            <p>Position X0 du conducteur sélectionné : <span style="color: blue;">${position_x0} m </span></p>
            <p>Position Y0 du conducteur sélectionné : <span style="color: blue;">${position_Y0} m </span></p>
            <p>Angle d'inclinaison du mur support du conducteur sélectionné : <span style="color: blue;">${angle_inclinaison} ° </span></p>
            <p>Coefficient de répartition du courant de foudre au niveau du conducteur sélectionné : <span style="color: blue;">${coefficient_repartition} </span></p>

            </div>

                `;

            outputdatacontainer.innerHTML += `
            <h4 style="text-decoration: underline;">${selectedConducteur}</span></h4>
            <p><strong>Force de Laplace résultante exercée sur le conducteur sélectionné (Traction) : <span style="color: blue;">${force_traction} daN </strong></span></p>
            <p><strong>Force de Laplace résultante exercée sur le conducteur sélectionné (Cisaillement) : <span style="color: blue;">${force_cisaillement} daN </strong></span></p>

            </div>

                `;



        }

    newWindow.print();

    const tempWindow = window.open('', '_blank', 'width=1,height=1');
    tempWindow.blur(); // Perdre le focus de la fenêtre temporaire
    window.focus(); // Revenir à la fenêtre principale
    setTimeout(() => tempWindow.close(), 100); // Fermer la fenêtre temporaire

    }

} else if (cliqued_button===12) {


    const niveau_protection_cheminement = document.getElementById('niveau-protection-cheminement').value;
    const courant_impulsionnel_cheminement = document.getElementById('courant-total-cheminement').value;
    const impedance_prise_terre = document.getElementById('impedance-prise-terre').value;
    const courant_prise_terre = document.getElementById('courant-prise-terre').value;

    const newWindow = window.open('aaaaa', '_blank');

    const newDoc = newWindow.document;


    // Obtenir la date actuelle
    const currentDate = new Date();
    const formattedDate = currentDate.toLocaleDateString('fr-FR', {
    Année: 'numeric',
    Mois: 'long',
    Jour: 'numeric'
    });


    const versionlogicielle='ELP-DV-CRC-07-09-01A';
    const normeReference='NF EN 62305-1';


    const html = `
    <html>
    <head>
    <title>CALCUL DE REPARTITION DU COURANT DE FOUDRE ${''} </title>
        <style>
        @media print {
                @page {
                    margin-left: 1cm;
                    margin-right: 1cm;
                    margin-top: 2cm;
                    margin-bottom: 1cm;
                }
                body {
                    margin: 0;
                }
                .page-number:after {
                    content: counter(page);
                }
                .page-number {
                    position: fixed;
                    bottom: 0;
                    width: 100%;
                    text-align: center;
                }
            }

            
            /* Optional: Additional CSS styles for the output window */
        </style>
    </head>
    <body>

    <h3 style="text-decoration: underline; text-align: center;">DONNEES DE SORTIE LOGICIELLE</h3>
    <p style="text-align: center">Version logicielle: <span style="color: blue;">${versionlogicielle}</span></p>

    <p style="margin: 0;">--------------------------------------------------------------------------------------------------------------</p>
    <h4 style="margin: 0px 0;">DONNEES GENERALES</h4>  
    <p style="margin: 0;">--------------------------------------------------------------------------------------------------------------</p>
    <p>Date: <span style="color: blue;">${formattedDate}</span></p>
    <p>Norme de référence: <span style="color: blue;">${normeReference}</span></p>


    <p style="margin: 0;">--------------------------------------------------------------------------------------------------------------</p>
    <h4 style="margin: 0px 0;">DONNEES D'ENTREE SAISIS SAISIS</h4>  
    <p style="margin: 0;">--------------------------------------------------------------------------------------------------------------</p>

    <p>Niveau de protection : <span style="color: blue;">${niveau_protection_cheminement}</span></p>
    <p>Courant impulsionnel de foudre Iimp total (10/350) : <span style="color: blue;">${courant_impulsionnel_cheminement} kA </span></p>
    <p>Impédance de la prise de terre du SPF Z : <span style="color: blue;">${impedance_prise_terre} &ohm; </span></p>
    <p>Courant injecté dans la prise de terre du SPF I : <span style="color: blue;">${courant_prise_terre} kA </span></p>

    <div id="input-data-container"></div>


    <p style="margin: 0;">--------------------------------------------------------------------------------------------------------------</p>
    <h4 style="margin: 0px 0;">RESULTATS DE SORTIE</h4>  
    <p style="margin: 0;">--------------------------------------------------------------------------------------------------------------</p>

    <div id="output-data-container"></div>

    </body>
    </html>
    `;


    newDoc.open();

    newDoc.write(html);
    newDoc.close();

    newWindow.onload = function () {

        

        const options_cheminement = document.getElementById('dropdown-menu-cheminement').options; 
        const inputdatacontainer = newDoc.getElementById('input-data-container');
        const outputdatacontainer = newDoc.getElementById('output-data-container');

        for (let i = 0; i < options_cheminement.length; i++) {


            const selectedCheminement = options_cheminement [i].text;

            const impedance_cheminement = CheminementData[i]["Z"];
            const coefficient_repartition = CheminementData[i]["ke"];
            const nombre_conducteurs = CheminementData[i]["nc"];
            const courant_cheminement = CheminementData[i]["iimp"];

            inputdatacontainer.innerHTML += `
            <h4 style="text-decoration: underline;">${selectedCheminement}</span></h4>
            <p>Nombre de conducteurs du cheminement sélectionné n : <span style="color: blue;">${nombre_conducteurs} </span></p>
            <p>Impédance du cheminement sélectionné Zc : <span style="color: blue;">${impedance_cheminement} &ohm; </span></p>


            </div>

                `;

            outputdatacontainer.innerHTML += `
            <h4 style="text-decoration: underline;">${selectedCheminement}</span></h4>
            <p><strong>Coefficient de répartition du courant impulsionnel de foudre : <span style="color: blue;">${coefficient_repartition} </strong></span></p>
            <p><strong>Courant impulsionnel Iimp/conducteur du cheminement sélectionné : <span style="color: blue;">${courant_cheminement} kA </strong></span></p>

            </div>

                `;



        }

    newWindow.print();

    const tempWindow = window.open('', '_blank', 'width=1,height=1');
    tempWindow.blur(); // Perdre le focus de la fenêtre temporaire
    window.focus(); // Revenir à la fenêtre principale
    setTimeout(() => tempWindow.close(), 100); // Fermer la fenêtre temporaire

    }

} else if (cliqued_button===14) {


const niveau_protection_d_zpf1 = document.getElementById('niveau-protection-champ-direct-zpf1').value;
const type_choc_foudre = (document.getElementById('type-choc-champ-direct-zpf1').options[document.getElementById('type-choc-champ-direct-zpf1').selectedIndex]).text;
const distance_point_mur_direct_zpf1 = document.getElementById('distance-point-mur-direct-zpf1').value;
const distance_point_toit_direct_zpf1 = document.getElementById('distance-point-toit-direct-zpf1').value;
const courant_impulsionnel_foudre = document.getElementById('courant-max-champ-direct-zpf1').value;
const reseau_equipotentialite_direct = (document.getElementById('reseau-equipotentialite-direct').options[document.getElementById('reseau-equipotentialite-direct').selectedIndex]).text;

const newWindow = window.open('aaaaa', '_blank');

const newDoc = newWindow.document;


// Obtenir la date actuelle
const currentDate = new Date();
const formattedDate = currentDate.toLocaleDateString('fr-FR', {
Année: 'numeric',
Mois: 'long',
Jour: 'numeric'
});


const versionlogicielle='ELP-DV-CMD-07-09-01A';
const normeReference='NF EN 62305-1';


const html = `
<html>
<head>
<title>CALCUL DU CHAMP MAGNETIQUE DE FOUDRE - IMPACT SUR LE BATIMENT ${''} </title>
    <style>
    @media print {
            @page {
                margin-left: 1cm;
                margin-right: 1cm;
                margin-top: 2cm;
                margin-bottom: 1cm;
            }
            body {
                margin: 0;
            }
            .page-number:after {
                content: counter(page);
            }
            .page-number {
                position: fixed;
                bottom: 0;
                width: 100%;
                text-align: center;
            }
        }

        
        /* Optional: Additional CSS styles for the output window */
    </style>
</head>
<body>

<h3 style="text-decoration: underline; text-align: center;">DONNEES DE SORTIE LOGICIELLE</h3>
<p style="text-align: center">Version logicielle: <span style="color: blue;">${versionlogicielle}</span></p>

<p style="margin: 0;">--------------------------------------------------------------------------------------------------------------</p>
<h4 style="margin: 0px 0;">DONNEES GENERALES</h4>  
<p style="margin: 0;">--------------------------------------------------------------------------------------------------------------</p>
<p>Date: <span style="color: blue;">${formattedDate}</span></p>
<p>Norme de référence: <span style="color: blue;">${normeReference}</span></p>


<p style="margin: 0;">--------------------------------------------------------------------------------------------------------------</p>
<h4 style="margin: 0px 0;">DONNEES D'ENTREE SAISIS SAISIS</h4>  
<p style="margin: 0;">--------------------------------------------------------------------------------------------------------------</p>


<p>Niveau de protection : <span style="color: blue;">${niveau_protection_d_zpf1}</span></p>
<p>Type de choc de foudre : <span style="color: blue;">${type_choc_foudre}</span></p>
<p>Distance du point considéré du mur du bâtiment dw : <span style="color: blue;">${distance_point_mur_direct_zpf1} m</span></p>
<p>Distance du point considéré du toit du bâtiment dw : <span style="color: blue;">${distance_point_toit_direct_zpf1} m</span></p>
<p>Courant impulsionnel de foudre : <span style="color: blue;">${courant_impulsionnel_foudre} kA </span></p>
<p>Réseau d'équipotentialité conçu selon recommandations de la norme NF EN 62305-4 [§5.2] : <span style="color: blue;">${reseau_equipotentialite_direct} </span></p>


<div id="input-data-container"></div>


<p style="margin: 0;">--------------------------------------------------------------------------------------------------------------</p>
<h4 style="margin: 0px 0;">RESULTATS DE SORTIE</h4>  
<p style="margin: 0;">--------------------------------------------------------------------------------------------------------------</p>

<div id="output-data-container1"></div>
<div id="output-data-container2"></div>

</body>
</html>
`;


newDoc.open();

newDoc.write(html);
newDoc.close();

newWindow.onload = function () {

    

    const options_zones = document.getElementById('dropdown-menu-zpf-direct').options; 
    const options_materiau = document.getElementById('type-materiau-champ-indirect-zpf1').options; 
    const inputdatacontainer = newDoc.getElementById('input-data-container');
    const outputdatacontainer1 = newDoc.getElementById('output-data-container1');
    const outputdatacontainer2 = newDoc.getElementById('output-data-container2');
    const champ_magnetique_global = document.getElementById('champ-magnetrique-avec-ecran-direct-zpf1').value; 
    const facteur_attenuation_global = document.getElementById('facteur-global-ecran-direct-zpf1').value; 

    for (let i = 0; i < options_zones.length; i++) {


        const selectedZone = options_zones [i].text;

        const taille_mailles =ZPFDataDirect[i]["W"];
        const diametre_tiges =ZPFDataDirect[i]["D0"];

        

        const correspondingOption = Array.from(options_materiau).find(option => option.value == ZPFDataDirect[i]["Materiau"]);

        const type_materiau = correspondingOption.text;

        const sf = ZPFDataDirect[i]["sf"];
        const ds = ZPFDataDirect[i]["ds"];



        inputdatacontainer.innerHTML += `
        <h4 style="text-decoration: underline;">${selectedZone}</span></h4>
        <p>Taille des mailles de l'écran de la zone ZPF sélectionnée : <span style="color: blue;">${taille_mailles} m x ${taille_mailles} m </span></p>
        <p>Diamètre des conducteurs de l'écran de la zone ZPF sélectionnée : <span style="color: blue;">${diametre_tiges} mm </span></p>
        <p>Type de matériau des conducteurs de l'écran de la zone ZPF sélectionnée : <span style="color: blue;">${type_materiau} </span></p>

        </div>

            `;

        outputdatacontainer1.innerHTML += `
        <h4 style="text-decoration: underline;">${selectedZone}</span></h4>
        <p><strong>Facteur d'attenuation de l'écran de la zone ZPF sélectionnée : <span style="color: blue;">${sf} dB </strong></span></p>
        <p><strong>Distance de sécurité de l'écran de la zone sélectionnée : <span style="color: blue;">${ds} m </strong></span></p>

        </div>

            `;



    }

    outputdatacontainer2.innerHTML = `
        <h4 style="text-decoration: underline;">Résultats globaux</span></h4>
        <p><strong>Champ magnétique calculé en présence d'écran(s) : <span style="color: blue;">${champ_magnetique_global} A/m </strong></span></p>
        <p><strong>Facteur global d'attenuation de l'écran : <span style="color: blue;">${facteur_attenuation_global} dB </strong></span></p>

        </div>

            `;



newWindow.print();
const tempWindow = window.open('', '_blank', 'width=1,height=1');
    tempWindow.blur(); // Perdre le focus de la fenêtre temporaire
    window.focus(); // Revenir à la fenêtre principale
    setTimeout(() => tempWindow.close(), 100); // Fermer la fenêtre temporaire

}

} else if (cliqued_button===15) {


    const niveau_protection_i_zpf1 = document.getElementById('niveau-protection-champ-indirect-zpf1').value;
    const type_choc_foudre = (document.getElementById('type-choc-champ-indirect-zpf1').options[document.getElementById('type-choc-champ-direct-zpf1').selectedIndex]).text;
    const hauteur_batiment_i_zpf1 = document.getElementById('hauteur-batiment-champ-indirect-zpf1').value;
    const longueur_batiment_i_zpf1 = document.getElementById('longueur-batiment-champ-indirect-zpf1').value;
    const courant_impulsionnel_i_foudre = document.getElementById('courant-max-champ-indirect-zpf1').value;
    const distance_point_impact_i_zpf1 = document.getElementById('distance-indirect-zpf1').value;
    const rayon_sf_indirect_zpf1 = document.getElementById('rayon-sf-indirect-zpf1').value;
    const reseau_equipotentialite_indirect = (document.getElementById('reseau-equipotentialite-indirect').options[document.getElementById('reseau-equipotentialite-indirect').selectedIndex]).text;

    const newWindow = window.open('aaaaa', '_blank');

    const newDoc = newWindow.document;


    // Obtenir la date actuelle
    const currentDate = new Date();
    const formattedDate = currentDate.toLocaleDateString('fr-FR', {
    Année: 'numeric',
    Mois: 'long',
    Jour: 'numeric'
    });


    const versionlogicielle='ELP-DV-CMI-07-09-01A';
    const normeReference='NF EN 62305-1';


    const html = `
    <html>
    <head>
    <title>CALCUL DU CHAMP MAGNETIQUE DE FOUDRE - IMPACT A PROXIMITE DU BATIMENT ${''} </title>
        <style>
        @media print {
                @page {
                    margin-left: 1cm;
                    margin-right: 1cm;
                    margin-top: 2cm;
                    margin-bottom: 1cm;
                }
                body {
                    margin: 0;
                }
                .page-number:after {
                    content: counter(page);
                }
                .page-number {
                    position: fixed;
                    bottom: 0;
                    width: 100%;
                    text-align: center;
                }
            }

            
            /* Optional: Additional CSS styles for the output window */
        </style>
    </head>
    <body>

    <h3 style="text-decoration: underline; text-align: center;">DONNEES DE SORTIE LOGICIELLE</h3>
    <p style="text-align: center">Version logicielle: <span style="color: blue;">${versionlogicielle}</span></p>

    <p style="margin: 0;">--------------------------------------------------------------------------------------------------------------</p>
    <h4 style="margin: 0px 0;">DONNEES GENERALES</h4>  
    <p style="margin: 0;">--------------------------------------------------------------------------------------------------------------</p>
    <p>Date: <span style="color: blue;">${formattedDate}</span></p>
    <p>Norme de référence: <span style="color: blue;">${normeReference}</span></p>


    <p style="margin: 0;">--------------------------------------------------------------------------------------------------------------</p>
    <h4 style="margin: 0px 0;">DONNEES D'ENTREE SAISIS SAISIS</h4>  
    <p style="margin: 0;">--------------------------------------------------------------------------------------------------------------</p>


    <p>Niveau de protection : <span style="color: blue;">${niveau_protection_i_zpf1}</span></p>
    <p>Type de choc de foudre : <span style="color: blue;">${type_choc_foudre}</span></p>
    <p>Hauteur du bâtiment H : <span style="color: blue;">${hauteur_batiment_i_zpf1} m</span></p>
    <p>Taille du bâtiment W  : <span style="color: blue;">${longueur_batiment_i_zpf1} m</span></p>
    <p>Courant impulsionnel de foudre : <span style="color: blue;">${courant_impulsionnel_i_foudre} kA </span></p>
    <p>Distance de l'impact du point considéré Sa : <span style="color: blue;">${distance_point_impact_i_zpf1} m</span></p>
    <p>Rayon de la sphère fictive : <span style="color: blue;">${rayon_sf_indirect_zpf1} m</span></p>
    <p>Réseau d'équipotentialité conçu selon recommandations de la norme NF EN 62305-4 [§5.2] : <span style="color: blue;">${reseau_equipotentialite_indirect} </span></p>


    <div id="input-data-container"></div>


    <p style="margin: 0;">--------------------------------------------------------------------------------------------------------------</p>
    <h4 style="margin: 0px 0;">RESULTATS DE SORTIE</h4>  
    <p style="margin: 0;">--------------------------------------------------------------------------------------------------------------</p>

    <div id="output-data-container1"></div>
    <div id="output-data-container2"></div>

    </body>
    </html>
    `;


    newDoc.open();

    newDoc.write(html);
    newDoc.close();

    newWindow.onload = function () {

        

        const options_zones_i = document.getElementById('dropdown-menu-zpf').options; 
        const options_materiau_i = document.getElementById('type-materiau-champ-indirect-zpf1').options; 
        const inputdatacontainer = newDoc.getElementById('input-data-container');
        const outputdatacontainer1 = newDoc.getElementById('output-data-container1');
        const outputdatacontainer2 = newDoc.getElementById('output-data-container2');
        const champ_magnetique_global_s_i = document.getElementById('champ-magnetrique-sans-ecran-indirect-zpf1').value; 
        const champ_magnetique_global_a_i = document.getElementById('champ-magnetrique-avec-ecran-indirect-zpf1').value; 
        const facteur_attenuation_global_i = document.getElementById('facteur-global-ecran-indirect-zpf1').value; 

        for (let i = 0; i < options_zones_i.length; i++) {


            const selectedZone = options_zones_i [i].text; 

            const taille_mailles =ZPFData[i]["W"];
            const diametre_tiges =ZPFData[i]["D0"];

            

            const correspondingOption = Array.from(options_materiau_i).find(option => option.value == ZPFData[i]["Materiau"]);

            const type_materiau_i = correspondingOption.text;

            const sf_i = ZPFData[i]["sf"];
            const ds_i = ZPFData[i]["ds"];



            inputdatacontainer.innerHTML += `
            <h4 style="text-decoration: underline;">${selectedZone}</span></h4>
            <p>Taille des mailles de l'écran de la zone ZPF sélectionnée : <span style="color: blue;">${taille_mailles} m x ${taille_mailles} m </span></p>
            <p>Diamètre des conducteurs de l'écran de la zone ZPF sélectionnée : <span style="color: blue;">${diametre_tiges} mm </span></p>
            <p>Type de matériau des conducteurs de l'écran de la zone ZPF sélectionnée : <span style="color: blue;">${type_materiau_i} </span></p>

            </div>

                `;

            outputdatacontainer1.innerHTML += `
            <h4 style="text-decoration: underline;">${selectedZone}</span></h4>
            <p><strong>Facteur d'attenuation de l'écran de la zone ZPF sélectionnée : <span style="color: blue;">${sf_i} dB </strong></span></p>
            <p><strong>Distance de sécurité de l'écran de la zone sélectionnée : <span style="color: blue;">${ds_i} m </strong></span></p>

            </div>

                `;



        }

        outputdatacontainer2.innerHTML = `
            <h4 style="text-decoration: underline;">Résultats globaux</span></h4>
            <p><strong>Champ magnétique calculé en absence d'écran(s) : <span style="color: blue;">${champ_magnetique_global_s_i} A/m </strong></span></p>
            <p><strong>Champ magnétique calculé en présence d'écran(s) : <span style="color: blue;">${champ_magnetique_global_a_i} A/m </strong></span></p>
            <p><strong>Facteur global d'attenuation de l'écran : <span style="color: blue;">${facteur_attenuation_global_i} dB </strong></span></p>

            </div>

                `;



    newWindow.print();
    const tempWindow = window.open('', '_blank', 'width=1,height=1');
    tempWindow.blur(); // Perdre le focus de la fenêtre temporaire
    window.focus(); // Revenir à la fenêtre principale
    setTimeout(() => tempWindow.close(), 100); // Fermer la fenêtre temporaire

    }

} else if (cliqued_button===18) {


const niveau_protection_kta2206 = document.getElementById('niveau-protection-kta2206').value;
const type_choc_foudre_KTA2206 = (document.getElementById('type-choc-foudre-kta2206').options[document.getElementById('type-choc-foudre-kta2206').selectedIndex]).text;
const courant_impulsionnel_foudre_KTA2206 = document.getElementById('courant-max-kta2206').value;
const resistivite_sol_kta2206 = document.getElementById('resistivite-sol-kta2206').value;
const courant_prise_terre_kta2206 = document.getElementById('courant-prise-terre-kta2206').value;
const facteur_foudre_k_kta2206 = document.getElementById('facteur-foudre-k-kta2206').value;
const impedance_couplage_kta2206 = document.getElementById('impedance-couplage-kta2206').value;


const newWindow = window.open('aaaaa', '_blank');

const newDoc = newWindow.document;


// Obtenir la date actuelle
const currentDate = new Date();
const formattedDate = currentDate.toLocaleDateString('fr-FR', {
Année: 'numeric',
Mois: 'long',
Jour: 'numeric'
});


const versionlogicielle='ELP-DV-KTA-07-09-01A';
const normeReference='KTA 2206';


const html = `
<html>
<head>
<title>CALCUL DES SURTENSIONS INDUITES DANS LES GALERIES SELON LA NORME KTA2206 ${''} </title>
    <style>
    @media print {
            @page {
                margin-left: 1cm;
                margin-right: 1cm;
                margin-top: 2cm;
                margin-bottom: 1cm;
            }
            body {
                margin: 0;
            }
            .page-number:after {
                content: counter(page);
            }
            .page-number {
                position: fixed;
                bottom: 0;
                width: 100%;
                text-align: center;
            }
        }

        
        /* Optional: Additional CSS styles for the output window */
    </style>
</head>
<body>

<h3 style="text-decoration: underline; text-align: center;">DONNEES DE SORTIE LOGICIELLE</h3>
<p style="text-align: center">Version logicielle: <span style="color: blue;">${versionlogicielle}</span></p>

<p style="margin: 0;">--------------------------------------------------------------------------------------------------------------</p>
<h4 style="margin: 0px 0;">DONNEES GENERALES</h4>  
<p style="margin: 0;">--------------------------------------------------------------------------------------------------------------</p>
<p>Date: <span style="color: blue;">${formattedDate}</span></p>
<p>Norme de référence: <span style="color: blue;">${normeReference}</span></p>


<p style="margin: 0;">--------------------------------------------------------------------------------------------------------------</p>
<h4 style="margin: 0px 0;">DONNEES D'ENTREE SAISIS SAISIS</h4>  
<p style="margin: 0;">--------------------------------------------------------------------------------------------------------------</p>


<p>Niveau de protection : <span style="color: blue;">${niveau_protection_kta2206}</span></p>
<p>Type de choc de foudre : <span style="color: blue;">${type_choc_foudre_KTA2206}</span></p>
<p>Courant impulsionnel de foudre : <span style="color: blue;">${courant_impulsionnel_foudre_KTA2206} kA </span></p>
<p>Résistivité moyenne du sol : <span style="color: blue;">${resistivite_sol_kta2206} &ohm;.m </span></p>
<p>Part du courant écoulée à travers la prise de terre du bâtiment : <span style="color: blue;">${courant_prise_terre_kta2206} kA </span></p>
<p>Facteur de foudre K : <span style="color: blue;">${facteur_foudre_k_kta2206} &Omega;/m </span></p>
<p>Impédance de couplage dans les galeries Z'M : <span style="color: blue;">${impedance_couplage_kta2206} V/kA.m </span></p>


<div id="input-data-container"></div>


<p style="margin: 0;">--------------------------------------------------------------------------------------------------------------</p>
<h4 style="margin: 0px 0;">RESULTATS DE SORTIE</h4>  
<p style="margin: 0;">--------------------------------------------------------------------------------------------------------------</p>

<div id="output-data-container-hors-galeries"></div>
<div id="output-data-container-galeries"></div>


</body>
</html>
`;


newDoc.open();

newDoc.write(html);
newDoc.close();

newWindow.onload = function () {

    

    const options_conducteurs = document.getElementById('dropdown-menu-conducteur-kta2206').options; 
    const options_type_conducteurs = document.getElementById('type-cable-kta2206').options; 
    const options_buses = document.getElementById('dropdown-menu-buse-kta2206').options; 
    const options_type_buses = document.getElementById('type-buse-kta2206').options; 
 
    const inputdatacontainer = newDoc.getElementById('input-data-container');
    const output_data_container_hors_galeries = newDoc.getElementById('output-data-container-hors-galeries');
    const output_data_container_galeries = newDoc.getElementById('output-data-container-galeries');


    for (let i = 0; i < options_conducteurs.length; i++) {


        const selectedConducteur = options_conducteurs [i].text; 

        const correspondingOption = Array.from(options_type_conducteurs).find(option => option.value == ElementConducteurData[i]["TypeElementConducteur"]);
        const type_conducteur = correspondingOption.text;

        //const type_conducteur =ElementConducteurData[i]["TypeElementConducteur"];
        const coefficient_ponderation =ElementConducteurData[i]["CoefficientPonderation"];


        inputdatacontainer.innerHTML += `
        <h4 style="text-decoration: underline;">${selectedConducteur}</span></h4>
        <p>Type d'élément conducteur : <span style="color: blue;">${type_conducteur} </span></p>


        </div>

            `;

        output_data_container_hors_galeries.innerHTML += `
        <h4 style="text-decoration: underline;">${selectedConducteur}</span></h4>
        <p><strong>Coefficient de pondération pour le courant de foudre : <span style="color: blue;">${coefficient_ponderation} </strong></span></p>

        </div>

            `;



    }


    for (let i = 0; i < options_buses.length; i++) {


        const selectedBuse = options_buses [i].text; 


        const correspondingOption = Array.from(options_type_conducteurs).find(option => option.value == GalerieData[i]["TypeGalerie"]);

        
        
        const type_buse = correspondingOption.text;

        

        const longueur_galerie =GalerieData[i]["LongueurGalerie"];
        const nombre_jonctions =GalerieData[i]["NombreJonctionsparjd"];
        const nombre_jd =GalerieData[i]["NombreJD"];
        const uw =GalerieData[i]["TenueUw"];
        const coefficient_ponderation =GalerieData[i]["CoefficientPonderation"];
        const extension_fictive =GalerieData[i]["Extensionfictiveldf"];
        const courant_galerie =GalerieData[i]["CourantGalerie"];
        const tension_induite =GalerieData[i]["TensionAxialeInduite"];
 

        inputdatacontainer.innerHTML += `
        <h4 style="text-decoration: underline;">${selectedBuse}</span></h4>
        <p>Type de galerie : <span style="color: blue;">${type_buse} </span></p>
        <p>Longueur de la galerie : <span style="color: blue;">${longueur_galerie} m </span></p>
        <p>Nombre de jonctions/joint de dilatation : <span style="color: blue;">${nombre_jonctions} </span></p>
        <p>Tenue au choc de foudre des équipements internes : <span style="color: blue;">${uw} kV</span></p>



        </div>

            `;

        output_data_container_galeries.innerHTML += `
        <h4 style="text-decoration: underline;">${selectedBuse}</span></h4>
        <p><strong>Coefficient de pondération pour le courant de foudre : <span style="color: blue;">${coefficient_ponderation} </strong></span></p>
        <p><strong>Extension fictive LDF/joint de dilatation  : <span style="color: blue;">${extension_fictive} m </strong></span></p>
        <p><strong>Part du courant écoulée à travers la galerie : <span style="color: blue;">${courant_galerie} kA </strong></span></p>
        <p><strong>Tension axiale induite entre les 2 extrémités de la galerie UL : <span style="color: blue;">${tension_induite} V </strong></span></p>

        </div>

            `;



    }


    


newWindow.print();
const tempWindow = window.open('', '_blank', 'width=1,height=1');
    tempWindow.blur(); // Perdre le focus de la fenêtre temporaire
    window.focus(); // Revenir à la fenêtre principale
    setTimeout(() => tempWindow.close(), 100); // Fermer la fenêtre temporaire

}

} else if (cliqued_button===17) {

    const type_materiau = (document.getElementById('materiau-conducteur-blindage').options[document.getElementById('materiau-conducteur-blindage').selectedIndex]).text;
    const courant_impulsionnel_foudre_sb = document.getElementById('courant-impulsionnel-blindage').value;
    const resistivite_blindage_sb = document.getElementById('resistivite-blindage').value;
    const tenue_chocs_sb = document.getElementById('tenue-chocs-equipements-blindage').value;
    const diametre_moyen_ecran_sb = document.getElementById('diametre-moyen-ecran').value;
    const resistivite_sol_sb = document.getElementById('resistivite-sol-blindage').value;
    const etat_ecran_blindage_sb = (document.getElementById('etat-ecran-blindage').options[document.getElementById('etat-ecran-blindage').selectedIndex]).text;
    const Temperature_ambiante_sb = document.getElementById('temperature-ambiante-blindage').value;
    const temperature_admissible_isolant_sb = document.getElementById('temperature-maximale-isolant-cable-blindage').value;
    const section_ecran_sb = document.getElementById('section-ecran-blindage').value;
    const epaisseur_ecran_sb = document.getElementById('epaisseur-ecran-blindage').value;
    const longueur_blindage_sb = document.getElementById('longueur-cable-blindage').value;


    const newWindow = window.open('aaaaa', '_blank');

    const newDoc = newWindow.document;


    // Obtenir la date actuelle
    const currentDate = new Date();
    const formattedDate = currentDate.toLocaleDateString('fr-FR', {
    Année: 'numeric',
    Mois: 'long',
    Jour: 'numeric'
    });


    const versionlogicielle='ELP-DV-SBC-07-09-01A';
    const normeReference='NF EN 62305-1';

    const html = `
    <html>
    <head>
    <title>CALCUL DE LA SECTION MINIMALE REQUISE DES BLINDAGES DE CABLES ${''} </title>
        <style>
        @media print {
                @page {
                    margin-left: 1cm;
                    margin-right: 1cm;
                    margin-top: 2cm;
                    margin-bottom: 1cm;
                }
                body {
                    margin: 0;
                }
                .page-number:after {
                    content: counter(page);
                }
                .page-number {
                    position: fixed;
                    bottom: 0;
                    width: 100%;
                    text-align: center;
                }
            }

            
            /* Optional: Additional CSS styles for the output window */
        </style>
    </head>
    <body>

    <h3 style="text-decoration: underline; text-align: center;">DONNEES DE SORTIE LOGICIELLE</h3>
    <p style="text-align: center">Version logicielle: <span style="color: blue;">${versionlogicielle}</span></p>

    <p style="margin: 0;">--------------------------------------------------------------------------------------------------------------</p>
    <h4 style="margin: 0px 0;">DONNEES GENERALES</h4>  
    <p style="margin: 0;">--------------------------------------------------------------------------------------------------------------</p>
    <p>Date: <span style="color: blue;">${formattedDate}</span></p>
    <p>Norme de référence: <span style="color: blue;">${normeReference}</span></p>


    <p style="margin: 0;">--------------------------------------------------------------------------------------------------------------</p>
    <h4 style="margin: 0px 0;">DONNEES D'ENTREE SAISIS SAISIS</h4>  
    <p style="margin: 0;">--------------------------------------------------------------------------------------------------------------</p>

    <p>Type de matériau de l'écran : <span style="color: blue;">${type_materiau}</span></p>
    <p>Courant impulsionnel de foudre Iimp (10/350 &micro;s) s'écoulant dans l'écran : <span style="color: blue;">${courant_impulsionnel_foudre_sb} kA </span></p>
    <p>Résistivité de l'écran : <span style="color: blue;">${resistivite_blindage_sb} &ohm;.m</span></p>
    <p>Tenue aux chocs de foudre du réseau de puissance/communication alimenté par le câble : <span style="color: blue;">${tenue_chocs_sb} kV</span></p>
    <p>Diamètre moyen de l'écran &Oslash : <span style="color: blue;">${diametre_moyen_ecran_sb} mm </span></p>
    <p>Résistivité moyenne du sol : <span style="color: blue;">${resistivite_sol_sb} &ohm;.m </span></p>
    <p>Etat de l'écran du câble : <span style="color: blue;">${etat_ecran_blindage_sb} </span></p>
    <p>Longueur du câble entre le point de mise à la terre le plus proche et la structure : <span style="color: blue;">${longueur_blindage_sb} m </span></p>
    <p>Temperature ambiante : <span style="color: blue;">${Temperature_ambiante_sb} ° </span></p>
    <p>Temperature maximale admissible de l'isolant du câble : <span style="color: blue;">${temperature_admissible_isolant_sb} ° </span></p>


    <p style="margin: 0;">--------------------------------------------------------------------------------------------------------------</p>
    <h4 style="margin: 0px 0;">RESULTATS DE SORTIE</h4>  
    <p style="margin: 0;">--------------------------------------------------------------------------------------------------------------</p>

    <p><strong>Section minimale requise de l'écran s : <span style="color: blue;">${section_ecran_sb} mm<sup>2</sup></span></strong></p>
    <p><strong>Epaisseur minimale requise de l'écran : <span style="color: blue;">${epaisseur_ecran_sb} mm </span></strong></p>



    </body>
    </html>
    `;


    newDoc.open();

    newDoc.write(html);
    newDoc.close();

    newWindow.onload = function () {

    newWindow.print();

    const tempWindow = window.open('', '_blank', 'width=1,height=1');
    tempWindow.blur(); // Perdre le focus de la fenêtre temporaire
    window.focus(); // Revenir à la fenêtre principale
    setTimeout(() => tempWindow.close(), 100); // Fermer la fenêtre temporaire

    }

}















        
}


var buttons = document.querySelectorAll('.button');
    buttons.forEach(function(button) {
    button.addEventListener('click', function() {
    // Remove clicked class from all buttons
    buttons.forEach(function(btn) {
        btn.classList.remove('clicked');
    });

    // Add clicked class to the clicked button
    button.classList.add('clicked');
    });
});

var cliqued_button;

document.getElementById('elevation_temperature').addEventListener('click', function() {

    cliqued_button=1;

    var buttonContainer = document.getElementById('section-conducteurs-spf');
    buttonContainer.style.display = 'none';

    var buttonContainer = document.getElementById('section-electrodes-terre');
    buttonContainer.style.display = 'none';

    var buttonContainer = document.getElementById('section-conducteurs-liaisons');
    buttonContainer.style.display = 'none';

    var buttonContainer = document.getElementById('profondeur-fusion');
    buttonContainer.style.display = 'none';

    var buttonContainer = document.getElementById('section-conducteurs-raccordement');
    buttonContainer.style.display = 'none';

    var buttonContainer = document.getElementById('calibre-deconnecteur');
    buttonContainer.style.display = 'none';

    var buttonContainer = document.getElementById('rayon-angle-protection');
    buttonContainer.style.display = 'none';

    var buttonContainer = document.getElementById('rayon-sphere-fictive-sff');
    buttonContainer.style.display = 'none';

    var buttonContainer = document.getElementById('rayon-pda');
    buttonContainer.style.display = 'none';

    var buttonContainer = document.getElementById('profondeur-penetration');
    buttonContainer.style.display = 'none';

    var buttonContainer = document.getElementById('iimp-cheminement');
    buttonContainer.style.display = 'none';

    var buttonContainer = document.getElementById('transformee-fourrier');
    buttonContainer.style.display = 'none';

    var buttonContainer = document.getElementById('plot-container');
    buttonContainer.style.display = 'none';

    var buttonContainer = document.getElementById('champ-magnetique-container-direct-zpf1');
    buttonContainer.style.display = 'none';

    var buttonContainer = document.getElementById('champ-magnetique-container-indirect-zpf1');
    buttonContainer.style.display = 'none';

    var buttonContainer = document.getElementById('calculs-electrodynamiques-container');
    buttonContainer.style.display = 'none';

    var buttonContainer = document.getElementById('calcul-section-blindage-container');
    buttonContainer.style.display = 'none';

    var buttonContainer = document.getElementById('calcul-surtensions-KTA2206-container');
    buttonContainer.style.display = 'none';
    
    var buttonContainer = document.getElementById('elevation-temperature');

 
    if (buttonContainer.style.display === 'none' || buttonContainer.style.display === '') {
        buttonContainer.style.display = 'flex'; // Show the line container if hidden
    }

    document.getElementById('dynamic-image').style.display = 'block';
    document.getElementById('dynamic-image').src="photos/elevation_temperature.jpg";
    
});


document.getElementById('profondeur_fusion').addEventListener('click', function() {

    cliqued_button=2;

var buttonContainer = document.getElementById('section-conducteurs-spf');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('section-electrodes-terre');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('section-conducteurs-liaisons');
buttonContainer.style.display = 'none';


var buttonContainer = document.getElementById('elevation-temperature');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('section-conducteurs-raccordement');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('calibre-deconnecteur');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('rayon-angle-protection');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('rayon-sphere-fictive-sff');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('profondeur-penetration');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('rayon-pda');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('iimp-cheminement');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('transformee-fourrier');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('plot-container');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('champ-magnetique-container-direct-zpf1');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('champ-magnetique-container-indirect-zpf1');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('calculs-electrodynamiques-container');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('calcul-section-blindage-container');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('calcul-surtensions-KTA2206-container');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('profondeur-fusion');

if (buttonContainer.style.display === 'none' || buttonContainer.style.display === '') {
    buttonContainer.style.display = 'flex'; // Show the line container if hidden
}

document.getElementById('dynamic-image').style.display = 'block';
document.getElementById('dynamic-image').src="photos/profondeur_fusion.jpg";

});

document.getElementById('section_conducteurs').addEventListener('click', function() {

    cliqued_button=3;

var buttonContainer = document.getElementById('elevation-temperature');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('section-electrodes-terre');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('section-conducteurs-liaisons');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('profondeur-fusion');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('section-conducteurs-raccordement');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('calibre-deconnecteur');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('rayon-angle-protection');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('rayon-sphere-fictive-sff');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('profondeur-penetration');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('rayon-pda');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('iimp-cheminement');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('transformee-fourrier');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('plot-container');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('champ-magnetique-container-direct-zpf1');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('champ-magnetique-container-indirect-zpf1');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('calculs-electrodynamiques-container');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('calcul-section-blindage-container');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('calcul-surtensions-KTA2206-container');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('section-conducteurs-spf');

if (buttonContainer.style.display === 'none' || buttonContainer.style.display === '') {
    buttonContainer.style.display = 'flex'; // Show the line container if hidden
}

document.getElementById('dynamic-image').style.display = 'block';
document.getElementById('dynamic-image').src="photos/section_conducteurs.jpg";

});



document.getElementById('section_electrodes_terre').addEventListener('click', function() {

    cliqued_button=4;

var buttonContainer = document.getElementById('elevation-temperature');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('section-conducteurs-spf');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('section-conducteurs-liaisons');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('profondeur-fusion');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('section-conducteurs-raccordement');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('calibre-deconnecteur');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('rayon-angle-protection');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('rayon-sphere-fictive-sff');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('rayon-pda');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('profondeur-penetration');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('iimp-cheminement');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('transformee-fourrier');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('plot-container');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('champ-magnetique-container-direct-zpf1');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('champ-magnetique-container-indirect-zpf1');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('calculs-electrodynamiques-container');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('calcul-section-blindage-container');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('calcul-surtensions-KTA2206-container');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('section-electrodes-terre');

if (buttonContainer.style.display === 'none' || buttonContainer.style.display === '') {
    buttonContainer.style.display = 'flex'; // Show the line container if hidden
}

document.getElementById('dynamic-image').style.display = 'block';
document.getElementById('dynamic-image').src="photos/section_electrodes_terre.jpg";

});


document.getElementById('section_cables_parafoudres').addEventListener('click', function() {

cliqued_button=5;

var buttonContainer = document.getElementById('elevation-temperature');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('section-conducteurs-spf');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('section-conducteurs-liaisons');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('profondeur-fusion');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('section-electrodes-terre');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('calibre-deconnecteur');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('rayon-angle-protection');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('rayon-sphere-fictive-sff');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('rayon-pda');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('profondeur-penetration');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('iimp-cheminement');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('transformee-fourrier');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('plot-container');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('champ-magnetique-container-direct-zpf1');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('champ-magnetique-container-indirect-zpf1');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('calculs-electrodynamiques-container');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('calcul-section-blindage-container');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('calcul-surtensions-KTA2206-container');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('section-conducteurs-raccordement');

if (buttonContainer.style.display === 'none' || buttonContainer.style.display === '') {
    buttonContainer.style.display = 'flex'; // Show the line container if hidden
}

document.getElementById('dynamic-image').style.display = 'block';
document.getElementById('dynamic-image').src="photos/raccordement_parafoudres.jpg";

});


document.getElementById('section_liaisons_terre').addEventListener('click', function() {

cliqued_button=6;

var buttonContainer = document.getElementById('elevation-temperature');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('section-electrodes-terre');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('section-conducteurs-spf');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('profondeur-fusion');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('section-conducteurs-raccordement');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('calibre-deconnecteur');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('rayon-angle-protection');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('rayon-sphere-fictive-sff');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('rayon-pda');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('profondeur-penetration');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('iimp-cheminement');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('transformee-fourrier');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('plot-container');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('champ-magnetique-container-direct-zpf1');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('champ-magnetique-container-indirect-zpf1');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('calculs-electrodynamiques-container');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('calcul-section-blindage-container');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('calcul-surtensions-KTA2206-container');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('section-conducteurs-liaisons');

if (buttonContainer.style.display === 'none' || buttonContainer.style.display === '') {
    buttonContainer.style.display = 'flex'; // Show the line container if hidden
}

document.getElementById('dynamic-image').style.display = 'block';
document.getElementById('dynamic-image').src="photos/section_conducteurs_liaisons.jpg";

});


document.getElementById('calibre_deconnecteurs').addEventListener('click', function() {

cliqued_button=7;

var buttonContainer = document.getElementById('elevation-temperature');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('section-electrodes-terre');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('section-conducteurs-spf');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('profondeur-fusion');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('section-conducteurs-raccordement');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('section-conducteurs-liaisons');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('rayon-angle-protection');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('rayon-sphere-fictive-sff');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('rayon-pda');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('profondeur-penetration');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('iimp-cheminement');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('transformee-fourrier');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('plot-container');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('champ-magnetique-container-direct-zpf1');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('champ-magnetique-container-indirect-zpf1');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('calculs-electrodynamiques-container');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('calcul-section-blindage-container');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('calcul-surtensions-KTA2206-container');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('calibre-deconnecteur');

if (buttonContainer.style.display === 'none' || buttonContainer.style.display === '') {
    buttonContainer.style.display = 'flex'; // Show the line container if hidden
}

document.getElementById('dynamic-image').style.display = 'block';
document.getElementById('dynamic-image').src="photos/calibre_deconnecteur.jpg";

});

document.getElementById('angle_protection').addEventListener('click', function() {

cliqued_button=8;

var buttonContainer = document.getElementById('elevation-temperature');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('section-electrodes-terre');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('section-conducteurs-spf');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('profondeur-fusion');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('section-conducteurs-raccordement');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('section-conducteurs-liaisons');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('calibre-deconnecteur');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('rayon-sphere-fictive-sff');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('rayon-pda');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('profondeur-penetration');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('iimp-cheminement');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('transformee-fourrier');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('plot-container');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('champ-magnetique-container-direct-zpf1');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('champ-magnetique-container-indirect-zpf1');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('calculs-electrodynamiques-container');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('calcul-section-blindage-container');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('calcul-surtensions-KTA2206-container');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('rayon-angle-protection');

if (buttonContainer.style.display === 'none' || buttonContainer.style.display === '') {
    buttonContainer.style.display = 'flex'; // Show the line container if hidden
}

document.getElementById('dynamic-image').style.display = 'block';
document.getElementById('dynamic-image').src="photos/angle_protection.jpg";

});



document.getElementById('rayon_protection_sf').addEventListener('click', function() {

cliqued_button=9;


var buttonContainer = document.getElementById('elevation-temperature');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('section-electrodes-terre');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('section-conducteurs-spf');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('profondeur-fusion');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('section-conducteurs-raccordement');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('section-conducteurs-liaisons');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('calibre-deconnecteur');
buttonContainer.style.display = 'none';


var buttonContainer = document.getElementById('rayon-angle-protection');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('rayon-pda');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('profondeur-penetration');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('iimp-cheminement');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('transformee-fourrier');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('plot-container');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('champ-magnetique-container-direct-zpf1');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('champ-magnetique-container-indirect-zpf1');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('calculs-electrodynamiques-container');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('calcul-section-blindage-container');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('calcul-surtensions-KTA2206-container');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('rayon-sphere-fictive-sff');

if (buttonContainer.style.display === 'none' || buttonContainer.style.display === '') {
    buttonContainer.style.display = 'flex'; // Show the line container if hidden
}

document.getElementById('dynamic-image').style.display = 'block';
document.getElementById('dynamic-image').src="photos/rayon_sphere_fictive.jpg";

});


document.getElementById('rayon_protection_PDA').addEventListener('click', function() {

cliqued_button=10;


var buttonContainer = document.getElementById('elevation-temperature');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('section-electrodes-terre');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('section-conducteurs-spf');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('profondeur-fusion');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('section-conducteurs-raccordement');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('section-conducteurs-liaisons');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('calibre-deconnecteur');
buttonContainer.style.display = 'none';


var buttonContainer = document.getElementById('rayon-angle-protection');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('rayon-sphere-fictive-sff');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('profondeur-penetration');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('iimp-cheminement');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('transformee-fourrier');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('plot-container');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('champ-magnetique-container-direct-zpf1');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('champ-magnetique-container-indirect-zpf1');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('calculs-electrodynamiques-container');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('calcul-section-blindage-container');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('calcul-surtensions-KTA2206-container');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('rayon-pda');

if (buttonContainer.style.display === 'none' || buttonContainer.style.display === '') {
    buttonContainer.style.display = 'flex'; // Show the line container if hidden
}

document.getElementById('dynamic-image').style.display = 'block';
document.getElementById('dynamic-image').src="photos/rayon_protection_pda.jpg";

});


document.getElementById('profondeur_sf').addEventListener('click', function() {

cliqued_button=11;


var buttonContainer = document.getElementById('elevation-temperature');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('section-electrodes-terre');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('section-conducteurs-spf');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('profondeur-fusion');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('section-conducteurs-raccordement');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('section-conducteurs-liaisons');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('calibre-deconnecteur');
buttonContainer.style.display = 'none';


var buttonContainer = document.getElementById('rayon-angle-protection');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('rayon-sphere-fictive-sff');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('rayon-pda');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('iimp-cheminement');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('transformee-fourrier');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('plot-container');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('champ-magnetique-container-direct-zpf1');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('champ-magnetique-container-indirect-zpf1');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('calculs-electrodynamiques-container');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('calcul-section-blindage-container');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('calcul-surtensions-KTA2206-container');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('profondeur-penetration');

if (buttonContainer.style.display === 'none' || buttonContainer.style.display === '') {
    buttonContainer.style.display = 'flex'; // Show the line container if hidden
}

document.getElementById('dynamic-image').style.display = 'block';
document.getElementById('dynamic-image').src="photos/profondeur_penetration.jpg";

});

document.getElementById('courant_iimp_par_module').addEventListener('click', function() {

cliqued_button=12;

var buttonContainer = document.getElementById('elevation-temperature');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('section-electrodes-terre');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('section-conducteurs-spf');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('profondeur-fusion');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('section-conducteurs-raccordement');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('section-conducteurs-liaisons');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('calibre-deconnecteur');
buttonContainer.style.display = 'none';


var buttonContainer = document.getElementById('rayon-angle-protection');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('rayon-sphere-fictive-sff');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('rayon-pda');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('profondeur-penetration');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('transformee-fourrier');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('plot-container');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('champ-magnetique-container-direct-zpf1');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('champ-magnetique-container-indirect-zpf1');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('calculs-electrodynamiques-container');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('calcul-section-blindage-container');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('calcul-surtensions-KTA2206-container');
buttonContainer.style.display = 'none';


var buttonContainer = document.getElementById('iimp-cheminement');

if (buttonContainer.style.display === 'none' || buttonContainer.style.display === '') {
    buttonContainer.style.display = 'flex'; // Show the line container if hidden
}

document.getElementById('dynamic-image').style.display = 'block';
document.getElementById('dynamic-image').src="photos/repartition_foudre.jpg";

});

document.getElementById('spectre_frequentiel').addEventListener('click', function() {

cliqued_button=13;


var buttonContainer = document.getElementById('elevation-temperature');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('section-electrodes-terre');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('section-conducteurs-spf');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('profondeur-fusion');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('section-conducteurs-raccordement');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('section-conducteurs-liaisons');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('calibre-deconnecteur');
buttonContainer.style.display = 'none';


var buttonContainer = document.getElementById('rayon-angle-protection');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('rayon-sphere-fictive-sff');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('rayon-pda');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('profondeur-penetration');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('iimp-cheminement');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('champ-magnetique-container-direct-zpf1');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('champ-magnetique-container-indirect-zpf1');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('calculs-electrodynamiques-container');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('calcul-section-blindage-container');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('calcul-surtensions-KTA2206-container');
buttonContainer.style.display = 'none';


var buttonContainer = document.getElementById('plot-container');

if (buttonContainer.style.display === 'none' || buttonContainer.style.display === '') {
    buttonContainer.style.display = 'flex'; // Show the line container if hidden
}

var buttonContainer = document.getElementById('transformee-fourrier');

if (buttonContainer.style.display === 'none' || buttonContainer.style.display === '') {
    buttonContainer.style.display = 'flex'; // Show the line container if hidden
}

const imageElement = document.getElementById('dynamic-image');

if (imageElement) {
    imageElement.style.display = 'none';
}

computeFFT();

});


document.getElementById('calcul_champ_magnetique_direct_zpf1').addEventListener('click', function() {

cliqued_button=14;

var buttonContainer = document.getElementById('elevation-temperature');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('section-electrodes-terre');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('section-conducteurs-spf');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('profondeur-fusion');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('section-conducteurs-raccordement');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('section-conducteurs-liaisons');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('calibre-deconnecteur');
buttonContainer.style.display = 'none';


var buttonContainer = document.getElementById('rayon-angle-protection');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('rayon-sphere-fictive-sff');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('rayon-pda');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('profondeur-penetration');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('iimp-cheminement');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('plot-container');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('transformee-fourrier');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('champ-magnetique-container-indirect-zpf1');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('calculs-electrodynamiques-container');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('calcul-section-blindage-container');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('calcul-surtensions-KTA2206-container');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('champ-magnetique-container-direct-zpf1');

if (buttonContainer.style.display === 'none' || buttonContainer.style.display === '') {
    buttonContainer.style.display = 'flex'; // Show the line container if hidden
}

document.getElementById('dynamic-image').style.display = 'block';
document.getElementById('dynamic-image').src="photos/calcul_champ_direct2.jpg";

calculchampmagnetiquedirectzpf1();

});

document.getElementById('calcul_champ_magnetique_indirect_zpf1').addEventListener('click', function() {

cliqued_button=15;

var buttonContainer = document.getElementById('elevation-temperature');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('section-electrodes-terre');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('section-conducteurs-spf');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('profondeur-fusion');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('section-conducteurs-raccordement');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('section-conducteurs-liaisons');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('calibre-deconnecteur');
buttonContainer.style.display = 'none';


var buttonContainer = document.getElementById('rayon-angle-protection');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('rayon-sphere-fictive-sff');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('rayon-pda');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('profondeur-penetration');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('iimp-cheminement');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('plot-container');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('transformee-fourrier');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('champ-magnetique-container-direct-zpf1');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('calculs-electrodynamiques-container');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('calcul-section-blindage-container');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('calcul-surtensions-KTA2206-container');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('champ-magnetique-container-indirect-zpf1');

if (buttonContainer.style.display === 'none' || buttonContainer.style.display === '') {
    buttonContainer.style.display = 'flex'; // Show the line container if hidden
}

document.getElementById('dynamic-image').style.display = 'block';
document.getElementById('dynamic-image').src="photos/calcul_champ_indirect2.jpg";

calculchampmagnetiqueindirectzpf1();

});


document.getElementById('forces electrodynamiques').addEventListener('click', function() {

cliqued_button=16;

var buttonContainer = document.getElementById('elevation-temperature');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('section-electrodes-terre');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('section-conducteurs-spf');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('profondeur-fusion');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('section-conducteurs-raccordement');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('section-conducteurs-liaisons');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('calibre-deconnecteur');
buttonContainer.style.display = 'none';


var buttonContainer = document.getElementById('rayon-angle-protection');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('rayon-sphere-fictive-sff');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('rayon-pda');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('profondeur-penetration');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('iimp-cheminement');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('plot-container');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('transformee-fourrier');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('champ-magnetique-container-direct-zpf1');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('champ-magnetique-container-indirect-zpf1');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('calcul-section-blindage-container');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('calcul-surtensions-KTA2206-container');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('calculs-electrodynamiques-container');

if (buttonContainer.style.display === 'none' || buttonContainer.style.display === '') {
    buttonContainer.style.display = 'flex'; // Show the line container if hidden
}

document.getElementById('dynamic-image').style.display = 'block';
document.getElementById('dynamic-image').src="photos/forces_electrodynamiques.jpg";

calculchampmagnetiquedirectzpf1();

});


document.getElementById('calcul_section_blindage').addEventListener('click', function() {

cliqued_button=17;

var buttonContainer = document.getElementById('elevation-temperature');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('section-electrodes-terre');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('section-conducteurs-spf');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('profondeur-fusion');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('section-conducteurs-raccordement');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('section-conducteurs-liaisons');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('calibre-deconnecteur');
buttonContainer.style.display = 'none';


var buttonContainer = document.getElementById('rayon-angle-protection');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('rayon-sphere-fictive-sff');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('rayon-pda');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('profondeur-penetration');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('iimp-cheminement');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('plot-container');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('transformee-fourrier');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('champ-magnetique-container-direct-zpf1');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('champ-magnetique-container-indirect-zpf1');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('calculs-electrodynamiques-container');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('calcul-surtensions-KTA2206-container');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('calcul-section-blindage-container');

if (buttonContainer.style.display === 'none' || buttonContainer.style.display === '') {
    buttonContainer.style.display = 'flex'; // Show the line container if hidden
}

document.getElementById('dynamic-image').style.display = 'block';
document.getElementById('dynamic-image').src="photos/section_ecran_cable.jpg";

calculsectionecran();

});

document.getElementById('calcul_surtensions_KTA2206').addEventListener('click', function() {

cliqued_button=18;

var buttonContainer = document.getElementById('elevation-temperature');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('section-electrodes-terre');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('section-conducteurs-spf');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('profondeur-fusion');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('section-conducteurs-raccordement');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('section-conducteurs-liaisons');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('calibre-deconnecteur');
buttonContainer.style.display = 'none';


var buttonContainer = document.getElementById('rayon-angle-protection');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('rayon-sphere-fictive-sff');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('rayon-pda');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('profondeur-penetration');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('iimp-cheminement');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('plot-container');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('transformee-fourrier');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('champ-magnetique-container-direct-zpf1');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('champ-magnetique-container-indirect-zpf1');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('calculs-electrodynamiques-container');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('calcul-section-blindage-container');
buttonContainer.style.display = 'none';

var buttonContainer = document.getElementById('calcul-surtensions-KTA2206-container');

if (buttonContainer.style.display === 'none' || buttonContainer.style.display === '') {
    buttonContainer.style.display = 'flex'; // Show the line container if hidden
}

document.getElementById('dynamic-image').style.display = 'block';
document.getElementById('dynamic-image').src="photos/galerie.jpg";

//calculsectionecran();

});





document.getElementById('formule-onde-foudre').src = "photos/formule_onde_foudre.jpg";
document.getElementById('formule-onde-foudre').style.width = "400px"; // Set width
document.getElementById('formule-onde-foudre').style.height = "100px"; // Set height



 
const section_conducteurs_pf_1 = {
            1: {

            s1: "10",
            s2: "16",
  
        },

                2: {

            s1: "10",
            s2: "16",
  
        },

                3: {

            s1: "10",
            s2: "16",
  
        },

                4: {

            s1: "10",
            s2: "16",
  
        },

                5: {

            s1: "10",
            s2: "16",
  
        },

                6: {

            s1: "10",
            s2: "16",
  
        },

                7: {

            s1: "10",
            s2: "16",
  
        },

                8: {

            s1: "10",
            s2: "16",
  
        },

                9: {

            s1: "10",
            s2: "16",
  
        },

                10: {

            s1: "10",
            s2: "16",
  
        },

                11: {

            s1: "10",
            s2: "16",
  
        },

                12: {

            s1: "10",
            s2: "16",
  
        },

                13: {

            s1: "16",
            s2: "16",
  
        },

                14: {

            s1: "16",
            s2: "16",
  
        },

                15: {

            s1: "25",
            s2: "25",
  
        },

                16: {

            s1: "35",
            s2: "35",
  
        },

                17: {

            s1: "35",
            s2: "35",
  
        },

                18: {

            s1: "50",
            s2: "50",
  
        },

                19: {

            s1: "70",
            s2: "70",
  
        },

                20: {

            s1: "95",
            s2: "95",
  
        },

                21: {

            s1: "120",
            s2: "120",
  
        },
                22: {

            s1: "150",
            s2: "150",
  
        },
                23: {

            s1: "185",
            s2: "185",
  
        },
                24: {

            s1: "300",
            s2: "300",
  
        },

   

    }


    const section_conducteurs_pf_2 = {
            1: {

            s1: "2.5",
            s2: "6",
  
        },

                2: {

            s1: "2.5",
            s2: "6",
  
        },

                3: {

            s1: "2.5",
            s2: "6",
  
        },

                4: {

            s1: "2.5",
            s2: "6",
  
        },

                5: {

            s1: "2.5",
            s2: "6",
  
        },

                6: {

            s1: "2.5",
            s2: "6",
  
        },

                7: {

            s1: "2.5",
            s2: "6",
  
        },

                8: {

            s1: "4",
            s2: "6",
  
        },

                9: {

            s1: "4",
            s2: "6",
  
        },

                10: {

            s1: "6",
            s2: "6",
  
        },

                11: {

            s1: "6",
            s2: "6",
  
        },

                12: {

            s1: "10",
            s2: "10",
  
        },

                13: {

            s1: "16",
            s2: "16",
  
        },

                14: {

            s1: "16",
            s2: "16",
  
        },

                15: {

            s1: "25",
            s2: "25",
  
        },

                16: {

            s1: "35",
            s2: "35",
  
        },

                17: {

            s1: "35",
            s2: "35",
  
        },

                18: {

            s1: "50",
            s2: "50",
  
        },

                19: {

            s1: "70",
            s2: "70",
  
        },

                20: {

            s1: "95",
            s2: "95",
  
        },

                21: {

            s1: "120",
            s2: "120",
  
        },
                22: {

            s1: "150",
            s2: "150",
  
        },
                23: {

            s1: "185",
            s2: "185",
  
        },
                24: {

            s1: "300",
            s2: "300",
  
        },

   

    }



    const section_conducteurs_pf_3 = {
            1: {

            s1: "1.5",
            s2: "1.5",
  
        },

                2: {

            s1: "1.5",
            s2: "1.5",
  
        },

                3: {

            s1: "1.5",
            s2: "1.5",
  
        },

                4: {

            s1: "1.5",
            s2: "1.5",
  
        },

                5: {

            s1: "1.5",
            s2: "1.5",
  
        },

                6: {

            s1: "2.5",
            s2: "2.5",
  
        },

                7: {

            s1: "2.5",
            s2: "2.5",
  
        },

                8: {

            s1: "4",
            s2: "4",
  
        },

                9: {

            s1: "4",
            s2: "4",
  
        },

                10: {

            s1: "6",
            s2: "6",
  
        },

                11: {

            s1: "6",
            s2: "6",
  
        },

                12: {

            s1: "10",
            s2: "10",
  
        },

                13: {

            s1: "16",
            s2: "16",
  
        },

                14: {

            s1: "16",
            s2: "16",
  
        },

                15: {

            s1: "25",
            s2: "25",
  
        },

                16: {

            s1: "35",
            s2: "35",
  
        },

                17: {

            s1: "35",
            s2: "35",
  
        },

                18: {

            s1: "50",
            s2: "50",
  
        },

                19: {

            s1: "70",
            s2: "70",
  
        },

                20: {

            s1: "95",
            s2: "95",
  
        },

                21: {

            s1: "120",
            s2: "120",
  
        },
                22: {

            s1: "150",
            s2: "150",
  
        },
                23: {

            s1: "185",
            s2: "185",
  
        },
                24: {

            s1: "300",
            s2: "300",
  
        },

   

    }


    const calibre_deconnecteur = {

            1: {

            d: "8",
  
        },

                2: {

            d: "10",

  
        },

                3: {

            d: "12",

  
        },

                4: {

            d: "16",

  
        },

                5: {

            d: "20",
  
        },

                6: {

            d: "25",

  
        },

                7: {

            d: "32",

  
        },

                8: {

            d: "40",

  
        },

                9: {

            d: "50",
  
        },

                10: {

            d: "63",

  
        },

                11: {

            d: "80",
  
        },

                12: {

            d: "100",

  
        },

                13: {

            d: "125",

  
        },

                14: {

            d: "160",

  
        },

                15: {

            d: "200",

  
        },

                16: {

            d: "224",
  
        },

                17: {

            d: "250",
  
        },

                18: {

            d: "315",

  
        },

                19: {

            d: "400",

  
        },

                20: {

            d: "500",

  
        },

                21: {

            d: "630",
  
        }

}












</script>




</body>
</html>
